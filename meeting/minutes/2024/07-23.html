<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 087 Minutes 2024-07-23</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 087 Minutes 2024-07-23</h1>
<p>
<a href="../">Meeting index</a> / <a href="https://qt4cg.org">QT4CG.org</a> / <a href="https://qt4cg.org/dashboard">Dashboard</a> / <a href="https://github.com/qt4cg/qtspecs/issues">GH Issues</a> / <a href="https://github.com/qt4cg/qtspecs/pulls">GH Pull Requests</a>
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Draft Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/4]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[11/12]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a>
<ul>
<li><a href="#so-far">1.2.1. Status so far…</a></li>
</ul>
</li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[0/3]</code></a></li>
<li><a href="#open-pull-requests">1.6. Review of open pull requests and issues</a>
<ul>
<li><a href="#blocked">1.6.1. Blocked</a></li>
<li><a href="#merge-without-discussion">1.6.2. Merge without discussion</a></li>
<li><a href="#substantive">1.6.3. Substantive PRs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#pr-1263">2.1. PR #1263: 1224 Add xsl:accumulator-rule/@priority attribute</a></li>
<li><a href="#pr-1331">2.2. PR #1331: 1324 Introduce markup for executable specs</a></li>
<li><a href="#pr-1327">2.3. PR #1327: 1309 bare brace ambiguities</a></li>
<li><a href="#pr-1333">2.4. PR #1333: 1329 Add content option to load-xquery-module</a></li>
<li><a href="#pr-1228">2.5. PR #1228: – Adding the BLAKE3 hashing algorithm to fn:hash</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business</a></li>
<li><a href="#adjourned">4. Adjourned</a></li>
</ul>
</div>
</div>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Draft Minutes</h2>
<div class="outline-text-2" id="text-minutes">
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/4]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-080-05: NW to add absolute property to the parse-uri output</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-080-07: NW to update the build instructions in the README</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-082-02: DN to work with MK to come to agreement on the fn:ranks proposal</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-087-01: DN to update PR #1228 to reflect MK’s compromise and update the vulnerabilities</li>
</ul>
</div>
</div>


<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[11/12]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<p>
Regrets: JLO
</p>

<ul class="org-ul">
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="on"><code>[X]</code> Joel Kalvesmaki (JK)</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="off"><code>[&#xa0;]</code> Juri Leino (JLO)</li>
<li class="on"><code>[X]</code> John Lumley (JWL)</li>
<li class="on"><code>[X]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Wendell Piez (WP)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="on"><code>[X]</code> C. M. Sperberg-McQueen (MSM)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2024/07-23.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>

<div id="outline-container-so-far" class="outline-4">
<h4 id="so-far"><span class="section-number-4">1.2.1.</span> Status so far…</h4>
<div class="outline-text-4" id="text-so-far">
<p>
These charts have been adjusted so they reflect the preceding six months of work.
</p>


<div id="org4da052b" class="figure">
<p><img src="./issues-open-2024-07-23.png" alt="issues-open-2024-07-23.png" />
</p>
<p><span class="figure-number">Figure 1: </span>“Burn down” chart on open issues</p>
</div>


<div id="orga6a6875" class="figure">
<p><img src="./issues-by-spec-2024-07-23.png" alt="issues-by-spec-2024-07-23.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Open issues by specification</p>
</div>


<div id="org3207614" class="figure">
<p><img src="./issues-by-type-2024-07-23.png" alt="issues-by-type-2024-07-23.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Open issues by type</p>
</div>
</div>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2024/07-16.html">the minutes of the previous meeting</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
This next meeting is planned for <b>3 September 2024</b>. We’re on recess until then.
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[0/3]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<p>
(Items marked [X] are believed to have been closed via email before
this agenda was posted.)
</p>

<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-080-05: NW to add absolute property to the parse-uri output</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-080-07: NW to update the build instructions in the README</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-082-02: DN to work with MK to come to agreement on the fn:ranks proposal</li>
</ul>
</div>
</div>

<div id="outline-container-open-pull-requests" class="outline-3">
<h3 id="open-pull-requests"><span class="section-number-3">1.6.</span> Review of open pull requests and issues</h3>
<div class="outline-text-3" id="text-open-pull-requests">
</div>

<div id="outline-container-blocked" class="outline-4">
<h4 id="blocked"><span class="section-number-4">1.6.1.</span> Blocked</h4>
<div class="outline-text-4" id="text-blocked">
<p>
The following PRs are open but have merge conflicts or comments which
suggest they aren’t ready for action.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1231">#1231</a>: 1193 Parsing Functions: Empty input</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1227">#1227</a>: 150 PR resubmission for fn ranks</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1062">#1062</a>: 150bis - revised proposal for fn:ranks</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-529">#529</a>: 528 fn:elements-to-maps</li>
</ul>
</div>
</div>

<div id="outline-container-merge-without-discussion" class="outline-4">
<h4 id="merge-without-discussion"><span class="section-number-4">1.6.2.</span> Merge without discussion</h4>
<div class="outline-text-4" id="text-merge-without-discussion">
<p>
The following PRs are editorial, small, or otherwise appeared to be
uncontroversial when the agenda was prepared. The chairs propose that
these can be merged without discussion. If you think discussion is
necessary, please say so.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1332">#1332</a>: 1317 Fix the record subtyping rules</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1328">#1328</a>: 1326 wording improvements for concat and string-join</li>
</ul>

<p>
Proposal: merge without discussion.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-substantive" class="outline-4">
<h4 id="substantive"><span class="section-number-4">1.6.3.</span> Substantive PRs</h4>
<div class="outline-text-4" id="text-substantive">
<p>
The following substantive PRs were open when this agenda was prepared.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1333">#1333</a>: 1329 Add content option to load-xquery-module</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1331">#1331</a>: 1324 Introduce markup for executable specs</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1327">#1327</a>: 1309 bare brace ambiguities</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1296">#1296</a>: 982 Rewrite of scan-left and scan-right</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1283">#1283</a>: 77b: Update expressions</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1263">#1263</a>: 1224 Add xsl:accumulator-rule/@priority attribute</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1228">#1228</a>: – Adding the BLAKE3 hashing algorithm to fn:hash</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1209">#1209</a>: 1183 Add transient mode and the transient{} expression</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1185">#1185</a>: 1179 array:values, map:values → array:get, map:get</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-832">#832</a>: 77 Lookup returning path selection</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
</div>

<div id="outline-container-pr-1263" class="outline-3">
<h3 id="pr-1263"><span class="section-number-3">2.1.</span> PR #1263: 1224 Add xsl:accumulator-rule/@priority attribute</h3>
<div class="outline-text-3" id="text-pr-1263">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1263">#1263</a>
</p>

<p>
Please review the technical discussion <a href="https://qt4cg.org/meeting/minutes/2024/07-16.html#pr-1263">from last week</a>. Several members requested
a week to consider the proposal.
</p>

<ul class="org-ul">
<li>JWL: I’m not sure priority is needed.</li>
<li>WP: I agree.</li>
<li>MK: Fine by me. I’ve needed it.</li>
<li>RD: My understanding of the feature is that it only applies to the rules
within a section under the accumulator element. Those are evaluated in
document order, so you can just order them. You can use your editor to see the
order.</li>
</ul>

<p>
Proposal: there isn’t consensus for this change. Close the PR without merging it.
</p>

<p>
Accepted.
</p>

<ul class="org-ul">
<li>JWL: It might be useful to add a note that explains how you can already do
this.</li>
</ul>
</div>
</div>

<div id="outline-container-pr-1331" class="outline-3">
<h3 id="pr-1331"><span class="section-number-3">2.2.</span> PR #1331: 1324 Introduce markup for executable specs</h3>
<div class="outline-text-3" id="text-pr-1331">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1331">#1331</a>.
</p>

<ul class="org-ul">
<li>MK: I was inspired by DN’s remarks last week that we have examples that don’t
compile.
<ul class="org-ul">
<li>… We can go beyond that, we can execute the examples and see that they
produce the correct results.</li>
</ul></li>
<li>MK: The visible effect is that if there is an executable equivalent (for
example, <code>fn:for-each</code>), we get a “formal specification” section that includes
an equivalent formulation of what the function does.
<ul class="org-ul">
<li>… I’ve tried to keep those minimal in their syntax so that we have a core
language that everything else can be built on top of.
<ul class="org-ul">
<li>… For maps and arrays, I’ve added a set of primitives for maps and arrays
to support this approach.</li>
</ul></li>
</ul></li>
</ul>

<p>
MK switches to the Data Model
</p>

<ul class="org-ul">
<li>MK: For sequences, maps, and arrays, there are a set of primitive operations
in the Data Model. Everything else can be built on top of those primitives.
For maps and arrays, everything really is built on top of those.
<ul class="org-ul">
<li>… That all works quite nicely.</li>
<li>… Of course, we could debate what the primitives <i>should be</i> but I’ve tried
to keep the set small.</li>
</ul></li>
</ul>

<p>
MK switches back to Functions and Operators
</p>

<ul class="org-ul">
<li>MK: The introduction has been edited and the description of the formal
specification has been added.
<ul class="org-ul">
<li>… We’ll never get formal specs for things like format-number, they’re just
too complicated.</li>
</ul></li>
<li>MK: All the map and array functions have formal specifications, and the
operators on sequences do.</li>
</ul>

<p>
Things in the “formal specification” sections are checked for syntax errors and
in some cases semantics as well.
</p>

<ul class="org-ul">
<li>DN: Thank you, MK. This is a huge step forward. I was expecting to see an
attribute or something.</li>
<li>MK: Yes, let’s try to switch over to the markup.</li>
</ul>

<p>
MK shows some of the markup.
</p>

<ul class="org-ul">
<li>MK: The new section is <code>fos:equivalent</code>. The <code>style</code> attribute indicates how
it’s mapped: primitive, XPath expression, etc.
<ul class="org-ul">
<li>… There’s a stylesheet <code>generate-equivalence-tests.xsl</code> that generates an
XQuery test file that checks the syntax and possibly semantics of the
equivalent expressions.</li>
<li>(MK walks through some more of the XQuery)</li>
</ul></li>
<li>DN: It’s good to have formal definitions. I was expecting to see the phrase
“executable specification” somewhere. It would be good to have it in the text
of the spec as well as the markup.</li>
<li>MK: The presence of the formal specification section indicates that it’s
executable, otherwise it’s absent.</li>
<li>JWL: MK, this is building an interpreter.</li>
<li>MK: Yes.</li>
<li>JWL: I’ll see if I can carry on with my iXML grammars in this vein.</li>
<li>MK: It would be really nice to do something about the language constructs as
well, but that’s work for another day.</li>
<li>MSM: Since MK expressed some hesitence about the name “formal specification”
some of us have been wondering (in the Zoom chat) if “executable description”
or “equivalent expression” would be better.
<ul class="org-ul">
<li>… I like RD’s suggestion of “reference implementation”</li>
</ul></li>
<li>MK: I like that too.</li>
<li>RD: Could these be extracted separately as well as in the XQuery implementation?
<ul class="org-ul">
<li>… So that implementors can take them and use them if they want to?</li>
</ul></li>
<li>MK: I’m sure it could be done!</li>
<li>DN: Everything that we can specify this way we should do so. When we have an
exectuable specification, it’s a test oracle. We should mention this in the
description of the “formal specification” session.
<ul class="org-ul">
<li>… I think that would simplify the life of implementors and users who want to
understand their own examples.</li>
</ul></li>
<li>JWL: I’m not sure it goes as far as an oracle, because we have to consider the
error cases. The reference implementation doesn’t say what it’s errors are.</li>
<li>MK: Yes. I’ve tagged the reference implementations with an attribute to
indicate whether or not it covers error behavior.</li>
<li>JWL: Can the errors be in the implementation sections as well?</li>
<li>MK: Yes, but many are pretty primitive and don’t have a lot of errors.</li>
<li>WP: I like that direction, the other stress point becomes the testing. I’d
like to echo what DN said, I think this is great work.</li>
</ul>

<p>
Proposal: merge this PR.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-1327" class="outline-3">
<h3 id="pr-1327"><span class="section-number-3">2.3.</span> PR #1327: 1309 bare brace ambiguities</h3>
<div class="outline-text-3" id="text-pr-1327">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1327">#1327</a>.
</p>

<p>
MK introduces the PR.
</p>

<ul class="org-ul">
<li>MK: We hit a number of issues that could be traced back to the introduction of
bare brace syntax for map constructors.
<ul class="org-ul">
<li>… I decided to experiment with restricting the place where you can use a
bare brace map constructor.</li>
</ul></li>
</ul>

<p>
MK reviews the grammar changes.
</p>

<ul class="org-ul">
<li>MK: The result of this change is that you can only use them at a fairly high
level. They aren’t available in <code>ExprSingle</code> any more.
<ul class="org-ul">
<li>… You can use them in an argument to a function, in a sequence
concatenation, in a let binding after <code>:=</code>, on the right hand side of a <code>:</code>
in map value expression, in a square array constructor. Basically, the
JSON-style syntax for constructing maps and arrays.</li>
<li>… But after the <code>return</code> keyword, for example, you have to use <code>map { }</code>.</li>
<li>… So you can use it in the “important” contexts but not everywhere.</li>
<li>… The rule of thumb is the word <code>map</code> is needed if it follows a keyword.</li>
</ul></li>
<li>MSM: Where have we not replaced <code>ExprSingle</code> with <code>StandaloneExpression</code>?</li>
<li>MK: After “then” and “else”, after “satisfies”, after “in”, after “return”.
<ul class="org-ul">
<li>… That’s the one that’ll get people most often, after “return”</li>
</ul></li>
<li>MSM: It looks like the rule of thumb holds pretty well. If what precedes it is
an alphabetic keyword, you need the word “map”.</li>
<li>MK: After some operators as well, like “+” but you wouldn’t want it there.</li>
<li>RD: This seems like a reasonable, pragmatic compromise.</li>
<li>CG: I think you can always use additional parenthesis instead of the map keyword.</li>
<li>MK: Yes.</li>
</ul>

<p>
Proposal: accept this PR.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-1333" class="outline-3">
<h3 id="pr-1333"><span class="section-number-3">2.4.</span> PR #1333: 1329 Add content option to load-xquery-module</h3>
<div class="outline-text-3" id="text-pr-1333">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1333">#1333</a>.
</p>

<p>
MK introduces the PR.
</p>

<ul class="org-ul">
<li>MK: This basically lets you load an XQuery module from a string.
<ul class="org-ul">
<li>… it extends the options available to <code>load-xquery-module</code> so you can use a string.</li>
</ul></li>
</ul>

<p>
Proposal: accept this PR.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-pr-1228" class="outline-3">
<h3 id="pr-1228"><span class="section-number-3">2.5.</span> PR #1228: – Adding the BLAKE3 hashing algorithm to fn:hash</h3>
<div class="outline-text-3" id="text-pr-1228">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-1228">#1228</a>.
</p>

<ul class="org-ul">
<li>MK describes his compromise proposal.</li>
<li>DN: I fully support this. I think this supports the goal of the PR.
<ul class="org-ul">
<li>… I have another remark in the current specification. It warns about
vulnerabilities in only two of the four algorithms. I’d like that corrected.</li>
</ul></li>
</ul>

<p>
ACTION QT4CG-087-01: DN to update PR #1228 to reflect MK’s compromise and update the vulnerabilities
</p>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business</h2>
<div class="outline-text-2" id="text-any-other-business">
<ul class="org-ul">
<li>JWL: When we come back, should we have a review of where we are?</li>
<li>NW: Yep.</li>
</ul>
</div>
</div>

<div id="outline-container-adjourned" class="outline-2">
<h2 id="adjourned"><span class="section-number-2">4.</span> Adjourned</h2>
<div class="outline-text-2" id="text-adjourned">
</div>
</div>
</div>
</body>
</html>
