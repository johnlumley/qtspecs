<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>QT4 CG Meeting 084 Minutes 2024-07-02</title>
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="/meeting/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="../../../css/style.css"/>
<link rel="shortcut icon" href="/img/QT4-64.png" />
<link rel="apple-touch-icon" sizes="64x64" href="/img/QT4-64.png" type="image/png" />
<link rel="apple-touch-icon" sizes="76x76" href="/img/QT4-76.png" type="image/png" />
<link rel="apple-touch-icon" sizes="120x120" href="/img/QT4-120.png" type="image/png" />
<link rel="apple-touch-icon" sizes="152x152" href="/img/QT4-152.png" type="image/png" />
</head>
<body>
<div id="content" class="content">
<h1 class="title">QT4 CG Meeting 084 Minutes 2024-07-02</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#minutes">Draft Minutes</a></li>
<li><a href="#new-actions">Summary of new and continuing actions <code>[0/3]</code></a></li>
<li><a href="#administrivia">1. Administrivia</a>
<ul>
<li><a href="#roll-call">1.1. Roll call <code>[12/12]</code></a></li>
<li><a href="#agenda">1.2. Accept the agenda</a>
<ul>
<li><a href="#so-far">1.2.1. Status so far…</a></li>
</ul>
</li>
<li><a href="#approve-minutes">1.3. Approve minutes of the previous meeting</a></li>
<li><a href="#next-meeting">1.4. Next meeting</a></li>
<li><a href="#open-actions">1.5. Review of open action items <code>[2/5]</code></a></li>
<li><a href="#open-pull-requests">1.6. Review of open pull requests and issues</a>
<ul>
<li><a href="#blocked">1.6.1. Blocked</a></li>
<li><a href="#merge-without-discussion">1.6.2. Merge without discussion</a></li>
<li><a href="#substantive">1.6.3. Substantive PRs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#technical-agenda">2. Technical Agenda</a>
<ul>
<li><a href="#pr-832">2.1. PR #832: 77 Lookup returning path selection</a></li>
<li><a href="#qt4cg-079-01-review">2.2. Review of QT4CG-079-01: expert advice on hashing functions</a></li>
</ul>
</li>
<li><a href="#any-other-business">3. Any other business</a></li>
<li><a href="#adjourned">4. Adjourned</a></li>
</ul>
</div>
</div>
<p>
<a href="../">Meeting index</a> / <a href="https://qt4cg.org">QT4CG.org</a> / <a href="https://qt4cg.org/dashboard">Dashboard</a> / <a href="https://github.com/qt4cg/qtspecs/issues">GH Issues</a> / <a href="https://github.com/qt4cg/qtspecs/pulls">GH Pull Requests</a>
</p>

<div id="outline-container-minutes" class="outline-2">
<h2 id="minutes">Draft Minutes</h2>
<div class="outline-text-2" id="text-minutes">
</div>
</div>

<div id="outline-container-new-actions" class="outline-2">
<h2 id="new-actions">Summary of new and continuing actions <code>[0/3]</code></h2>
<div class="outline-text-2" id="text-new-actions">
<ul class="org-ul">
<li class="off"><code>[&#xa0;]</code> QT4CG-080-05: NW to add absolute property to the parse-uri output</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-080-07: NW to update the build instructions in the README</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-082-02: DN to work with MK to come to agreement on the fn:ranks proposal</li>
</ul>
</div>
</div>

<div id="outline-container-administrivia" class="outline-2">
<h2 id="administrivia"><span class="section-number-2">1.</span> Administrivia</h2>
<div class="outline-text-2" id="text-administrivia">
</div>

<div id="outline-container-roll-call" class="outline-3">
<h3 id="roll-call"><span class="section-number-3">1.1.</span> Roll call <code>[12/12]</code></h3>
<div class="outline-text-3" id="text-roll-call">
<ul class="org-ul">
<li class="on"><code>[X]</code> Reece Dunn (RD)</li>
<li class="on"><code>[X]</code> Sasha Firsov (SF)</li>
<li class="on"><code>[X]</code> Christian Grün (CG)</li>
<li class="on"><code>[X]</code> Joel Kalvesmaki (JK) [:05-]</li>
<li class="on"><code>[X]</code> Michael Kay (MK)</li>
<li class="on"><code>[X]</code> Juri Leino (JLO)</li>
<li class="on"><code>[X]</code> John Lumley (JLY)</li>
<li class="on"><code>[X]</code> Dimitre Novatchev (DN)</li>
<li class="on"><code>[X]</code> Wendell Piez (WP)</li>
<li class="on"><code>[X]</code> Ed Porter (EP)</li>
<li class="on"><code>[X]</code> C. M. Sperberg-McQueen (MSM)</li>
<li class="on"><code>[X]</code> Norm Tovey-Walsh (NW). <i>Scribe</i>. <i>Chair</i>.</li>
</ul>
</div>
</div>

<div id="outline-container-agenda" class="outline-3">
<h3 id="agenda"><span class="section-number-3">1.2.</span> Accept the agenda</h3>
<div class="outline-text-3" id="text-agenda">
<p>
Proposal: Accept <a href="../../agenda/2024/07-02.html">the agenda</a>.
</p>

<p>
Accepted.
</p>
</div>

<div id="outline-container-so-far" class="outline-4">
<h4 id="so-far"><span class="section-number-4">1.2.1.</span> Status so far…</h4>
<div class="outline-text-4" id="text-so-far">

<div id="org8c9462e" class="figure">
<p><img src="./issues-open-2024-07-02.png" alt="issues-open-2024-07-02.png" />
</p>
<p><span class="figure-number">Figure 1: </span>“Burn down” chart on open issues</p>
</div>


<div id="org827b155" class="figure">
<p><img src="./issues-by-spec-2024-07-02.png" alt="issues-by-spec-2024-07-02.png" />
</p>
<p><span class="figure-number">Figure 2: </span>Open issues by specification</p>
</div>


<div id="orgf5aaf46" class="figure">
<p><img src="./issues-by-type-2024-07-02.png" alt="issues-by-type-2024-07-02.png" />
</p>
<p><span class="figure-number">Figure 3: </span>Open issues by type</p>
</div>
</div>
</div>
</div>

<div id="outline-container-approve-minutes" class="outline-3">
<h3 id="approve-minutes"><span class="section-number-3">1.3.</span> Approve minutes of the previous meeting</h3>
<div class="outline-text-3" id="text-approve-minutes">
<p>
Proposal: Accept <a href="../../minutes/2024/06-25.html">the minutes of the previous meeting</a>.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-next-meeting" class="outline-3">
<h3 id="next-meeting"><span class="section-number-3">1.4.</span> Next meeting</h3>
<div class="outline-text-3" id="text-next-meeting">
<p>
This next meeting is planned for 9 July.
</p>

<p>
Any regrets? None heard.
</p>

<p>
Are we going to take a summer holiday this year?
</p>

<p>
No meetings 30 July through 27 August.
</p>
</div>
</div>

<div id="outline-container-open-actions" class="outline-3">
<h3 id="open-actions"><span class="section-number-3">1.5.</span> Review of open action items <code>[2/5]</code></h3>
<div class="outline-text-3" id="text-open-actions">
<ul class="org-ul">
<li class="on"><code>[X]</code> QT4CG-079-01: WP to seek expert advice on hashing functions.
<ul class="org-ul">
<li><a href="#qt4cg-079-01-review">Withdrawn</a></li>
</ul></li>
<li class="off"><code>[&#xa0;]</code> QT4CG-080-05: NW to add absolute property to the parse-uri output</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-080-07: NW to update the build instructions in the README</li>
<li class="off"><code>[&#xa0;]</code> QT4CG-082-02: DN to work with MK to come to agreement on the fn:ranks proposal</li>
<li class="on"><code>[X]</code> QT4CG-083-01 MK to revise fn:collation-available to address multiple usages</li>
</ul>
</div>
</div>

<div id="outline-container-open-pull-requests" class="outline-3">
<h3 id="open-pull-requests"><span class="section-number-3">1.6.</span> Review of open pull requests and issues</h3>
<div class="outline-text-3" id="text-open-pull-requests">
</div>

<div id="outline-container-blocked" class="outline-4">
<h4 id="blocked"><span class="section-number-4">1.6.1.</span> Blocked</h4>
<div class="outline-text-4" id="text-blocked">
<p>
The following PRs are open but have merge conflicts or comments which
suggest they aren’t ready for action.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1231">#1231</a>: 1193 Parsing Functions: Empty input</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1227">#1227</a>: 150 PR resubmission for fn ranks</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1062">#1062</a>: 150bis - revised proposal for fn:ranks</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-529">#529</a>: 528 fn:elements-to-maps</li>
</ul>
</div>
</div>

<div id="outline-container-merge-without-discussion" class="outline-4">
<h4 id="merge-without-discussion"><span class="section-number-4">1.6.2.</span> Merge without discussion</h4>
<div class="outline-text-4" id="text-merge-without-discussion">
<p>
The following PRs are editorial, small, or otherwise appeared to be
uncontroversial when the agenda was prepared. The chairs propose that
these can be merged without discussion. If you think discussion is
necessary, please say so.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1293">#1293</a>: 1289 Delete XQuery Appendix J</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1265">#1265</a>: 1161 Further revision of document-uri constraints</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1254">#1254</a>: 729 Add rules for use of xsi:schemaLocation during validation</li>
</ul>

<p>
Proposal: merge without discussion.
</p>

<p>
Accepted.
</p>
</div>
</div>

<div id="outline-container-substantive" class="outline-4">
<h4 id="substantive"><span class="section-number-4">1.6.3.</span> Substantive PRs</h4>
<div class="outline-text-4" id="text-substantive">
<p>
The following substantive PRs were open when this agenda was prepared.
</p>

<ul class="org-ul">
<li>PR <a href="https://qt4cg.org/dashboard/#pr-832">#832</a>: 77 Lookup returning path selection</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1306">#1306</a>: 46 Add @as attribute to xsl:sequence</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1296">#1296</a>: 982 Rewrite of scan-left and scan-right</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1283">#1283</a>: 77b: Update expressions</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1266">#1266</a>: 1158 Add array mapping operator</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1263">#1263</a>: 1224 Add xsl:accumulator-rule/@priority attribute</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1262">#1262</a>: 1160 Add collation-available() function</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1244">#1244</a>: 566-partial Rewrite parse-uri</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1228">#1228</a>: – Adding the BLAKE3 hashing algorithm to fn:hash</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1209">#1209</a>: 1183 Add transient mode and the transient{} expression</li>
<li>PR <a href="https://qt4cg.org/dashboard/#pr-1185">#1185</a>: 1179 array:values, map:values → array:get, map:get</li>
</ul>
</div>
</div>
</div>
</div>

<div id="outline-container-technical-agenda" class="outline-2">
<h2 id="technical-agenda"><span class="section-number-2">2.</span> Technical Agenda</h2>
<div class="outline-text-2" id="text-technical-agenda">
</div>

<div id="outline-container-pr-832" class="outline-3">
<h3 id="pr-832"><span class="section-number-3">2.1.</span> PR #832: 77 Lookup returning path selection</h3>
<div class="outline-text-3" id="text-pr-832">
<p>
See PR <a href="https://qt4cg.org/dashboard/#pr-832">#832</a>
</p>

<p>
MK introduces the change, reviewing the XPath specification.
</p>

<ul class="org-ul">
<li>MK: Modifiers used have changed. One side-effect of the proposal is that
lookup on arrays no longer fails if the index is out-of-range. Maps and arrays
are more symmetric.
<ul class="org-ul">
<li>… Modifiers are now singular. The “content” modifier is a bit problematic,
but we can live with it.</li>
<li>… Type qualifier is extended to allow an abbreviated syntax for record and
array tests.</li>
</ul></li>
</ul>

<p>
MK walks through the semantics in the specification.
</p>

<ul class="org-ul">
<li>MK: There’s no duplicates elimination as with “//” if you use the “??” operator.
<ul class="org-ul">
<li>… 4.13.3.4 Selection Paths is new.</li>
<li>… Lookups return not only the selected values but also a path to the values.</li>
<li>… The properties for getting additional values are functions so that we
don’t get cycles.</li>
</ul></li>

<li>DN: I have a few comments and questions. First, I want to say this is very
complicated and is a very big change. I have a procedural proposal for the
group. How are we expected to vote?</li>
<li>NW: With my chair’s hat on, I must observe that the agenda explicitly called
out that this was a large item and we were going to review it today.</li>
<li>DN: If we have an array of size 10, but we’ll get no error if we request item 20?</li>
<li>MK: With the lookup operator, that’s correct.</li>
<li>DN: But array[20] would still raise an error?</li>
<li>MK: That’s correct.</li>
<li>JLY: I discovered an ambiguity about type qualifier yesterday. I suspect that
even record would do the same thing.</li>
<li>MK: I’m slightly surprised because a function call isn’t something that can act as a key specifier.</li>
<li>JLY: It comes from higher up. The bracketed part becomes the argument list and that causes
ambiguity.</li>
<li>CG: The record test and array tests were added as a shortcut. Why not map test?</li>
<li>MK: I added the ones that were used most frequently. Others could be added, but those two seemed
the most useful.</li>
<li>CG: Maybe maps as well.</li>
<li>CG: I think most people will use the default and the default is now called
“content”. If we use the term content we could possibly use it in more places.
It seems fairly central to 3.1 lookup semantics.</li>
<li>RD: I’d prefer if we didn’t use custom syntax in the XQuery even if it is for
documentation purposes. We could end up in a situation like we have in
fn:concat where we introduce some syntax in the spec that isn’t actually syntax.</li>
<li>MK: Yep.</li>
<li>RD: So maybe something like an <code>op:add-label(s)</code> or something…</li>
<li>MK: Okay. I take that point, we can try different ways of doing it. Perhaps
<code>op:with-label</code> might work.</li>
<li>JLO: This was a lot to take in, I wonder where the <code>selection-keys</code> function comes from.</li>
<li>RD: Isn’t it in functions and operators?</li>
<li>JLO: Could these fields (parent, ancestors, root, etc) be overwritten?</li>
<li>MK: No, these are in the map returned by the entries function. What you get
otherwise are properties in the label.
<ul class="org-ul">
<li>… This is a lot easier to understand if you have an implementation to
experiment with. The next stage would be to update the implementations and
then try some usability testing.</li>
</ul></li>
<li>JK: Just wanted to express my gratitude for this proposal. It really
satisifies a use case I’ve had. A question that shouldn’t concern me, but if
you have a map with millions of entries, is that a performance concern?</li>
<li>MK: There certainly is extra data to be maintained. That data should be
transient. If you’re implementing the lookup function with lazy evaluation, in
many use cases, you’ll only have one instance of the result at any one time.
<ul class="org-ul">
<li>… There is some implementation complexity. And it gets worse when you
consider update. But that will be a separate proposal.</li>
</ul></li>
<li>JK: If someone iterates over a map of millions of items could be problematic?</li>
<li>MK: The iteration has to keep track of the stack for how you reached the item.
<ul class="org-ul">
<li>… Initially, I said you had to pin the map, but from prototyping, I came to
the decision that it was better to put the burden on the implementor to work
out the extra work.</li>
</ul></li>
<li>JK: I appreciate that.</li>
<li>JLY: There are two punctuation errors in the example “on that page”.</li>
<li>MSM: This looks like a lot of work. My understanding may be poor. I have a
naive question. If I understand correctly, I can do a lookup and ask for the
paths to get to those items. Is the thing returned by the selection path
function that there is some function I can pass that to get the items back.</li>
<li>MK: I think that’s covered in Functions and Operators, let’s go look there.</li>
</ul>

<p>
MK moves on to look at the changes in Functions and Operators.
</p>

<p>
(Some kerfuffle about what version of the spec to review; the diff version is
very complicated because a function is being replaced.)
</p>

<p>
MK reviews the <code>fn:selection-path</code> function.
</p>

<ul class="org-ul">
<li>MK: You get access at each level to what the container is, what the key is,
and if the value is a sequence, then the position of the item in the sequence.
<ul class="org-ul">
<li>… The example in the spec describes a recursive data structure.</li>
</ul></li>
<li>MSM: I think the bottom line answer to my question is ‘no’. I can get a
sequence of things, but I don’t know of a function to which I can pass that
sequence and get back “the thing I looked up”.</li>
<li>MK: I think you could write such a function, but it’s not clear.</li>
<li>MSM: FWIW, I’m thinking of some missed opportunities in the history of XML and
of pointing in XML. It’s easy to construct a fully qualified generic
identifier, but there was never a function that went the other way.
<ul class="org-ul">
<li>… It would be nice if we didn’t miss the same opportunity here.</li>
</ul></li>
<li>CG: Maybe it would be helpful to have an example that shows a full result
without additional paths.</li>
<li>MK: Additional examples that explain it incrementally.</li>
<li>CG: I think it would be good to reverse the first item first. The <code>fn:path</code>
function starts with the root.</li>
<li>MK: Yes, I’m sure there are use cases for both. The outermost-first path does
seem more natural.</li>
<li>WP: I’m with MSM, I think there’s a huge potential here but maybe we need a
little more work to do to see how we could leverage these things.
<ul class="org-ul">
<li>… Based on what MSM and RD said, I think there’s a huge potential here for something useful.</li>
<li>… But it cries out for more examples.</li>
</ul></li>
<li>RD: As I noted in chat, I can see a use for this in logging/test output:
here’s the location of the element that differs rather than “these two big
maps” are different.</li>
<li>MK: Certainly options to be explored there. I think JSON-Path has the same
issue; they return a location which is essentially the same as a selection
path and then under-exploit that idea.</li>
<li>JLY: Following on from MSM’s question of “can I take the result and go find
something”. Is there something we could put in the XML tree lookup that would
be rather similar?</li>
<li>MK: An xsl:evaluate restricted to simple paths, for example. Maybe.</li>
<li>JLO: JLY, did I understand correctly that you were interested in having this
on top of XML as well?</li>
<li>JLY nods.</li>
<li>JLY: Yes, I’ve wanted that too! The function <code>fn:selection-path</code> has an input.
If that input gives me an empty item back then I know my item wasn’t labeled.</li>
<li>MK: Yes, or your input was empty.</li>
<li>JLY: Would an “is-labeled” function be useful, so I can test it?</li>
<li>MK: I’m still exploring whether labels should be exposed directly.</li>
</ul>

<p>
Some discussion of revealing all labels or only the selected labels. It has
implementation consequences.
</p>

<ul class="org-ul">
<li>JLY: I’d like to know if there is a selection path before I attempt the lookup.</li>
</ul>
</div>
</div>

<div id="outline-container-qt4cg-079-01-review" class="outline-3">
<h3 id="qt4cg-079-01-review"><span class="section-number-3">2.2.</span> Review of QT4CG-079-01: expert advice on hashing functions</h3>
<div class="outline-text-3" id="text-qt4cg-079-01-review">
<p>
It appears that expert advice is not forthcoming. We’ll close WP’s action and
review alternative plans when next we discuss <code>fn:hash</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-any-other-business" class="outline-2">
<h2 id="any-other-business"><span class="section-number-2">3.</span> Any other business</h2>
<div class="outline-text-2" id="text-any-other-business">
<p>
None heard.
</p>
</div>
</div>

<div id="outline-container-adjourned" class="outline-2">
<h2 id="adjourned"><span class="section-number-2">4.</span> Adjourned</h2>
<div class="outline-text-2" id="text-adjourned">
</div>
</div>
</div>
</body>
</html>
