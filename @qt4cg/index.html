<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="created-1411"><h2>Issue #1411 created<span class="toot-id"> #created-1411</span></h2><div class="pubdate">31 Aug at 11:05:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1411">https://github.com/qt4cg/qtspecs/issues/1411</a></div><details><summary>uri-structure-record gives type of path-segments property as xs:string?, not xs:string*</summary><div class="markup"><p>The current spec <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#uri-structure-record">defines <code>uri-structure-record</code></a> as having a</p>
<pre><code>path-segments? 	as xs:string?
</code></pre>
<p>property, which doesn't make sense and also contradicts the example given later:</p>
<blockquote>
<p>The unescaped form is easily accessible from path-segments:</p>
<pre><code>("", "path", "to", "a/b")
</code></pre>
</blockquote>
<p>It should be <code>xs:string*</code>.</p>
</div></details></div>
<div class="toot" id="closed-1410"><h2>Issue #1410 closed<span class="toot-id"> #closed-1410</span></h2><div class="pubdate">30 Aug at 16:53:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1410">https://github.com/qt4cg/qtspecs/pull/1410</a></div><p>Ignore this PR</p></div>
<div class="toot" id="created-1410"><h2>Pull request #1410 created<span class="toot-id"> #created-1410</span></h2><div class="pubdate">30 Aug at 09:58:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1410">https://github.com/qt4cg/qtspecs/pull/1410</a></div><details><summary>Ignore this PR</summary><div class="markup"><p>Just testing</p>
</div></details></div>
<div class="toot" id="created-1409"><h2>Pull request #1409 created<span class="toot-id"> #created-1409</span></h2><div class="pubdate">29 Aug at 11:32:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1409">https://github.com/qt4cg/qtspecs/pull/1409</a></div><details><summary>1401 Rewrite of F+O section 20, Casting</summary><div class="markup"><p>Fix #1401</p>
<p>The main changes are:</p>
<ul>
<li>The three derived types xs:integer, xs:dayTimeDuration, and xs:yearMonthDuration are no longer treated as primitive for the purpose of this section. They are now treated as derived types, but given special status where necessary as "quasi-primitive".</li>
<li>In places where the F+O rules give the same result as the canonical representation in XSD 1.1, we now defer to XSD 1.1 rather than replicating the rules. Many of the rules originate with XPath 2.0, which was published before XSD 1.1, but which anticipated some of the changes in XSD 1.1, for example the use of a seven-component model for dates/times, and a two-component model for durations. XPath 3.0/3.1 failed to take advantage of the resulting opportunity for rationalisation.</li>
<li>Generally the language is a bit less terse, with more notes and examples</li>
<li>The rules have more to say about the type annotation of the result. In some places the spec appeared to imply that the type annotation on the result must be the target type; in others it appeared to imply that the type annotation must be unchanged from the source (for example 19.1.1 "If ST is xs:string or a type derived from xs:string, TV is SV. [presumably with unchanged type annotation]). The spec is now hopefully clearer that the result TV MUST be an instance of TT and MAY be an instance of some other type derived from TT, especially in the case where the value is unchanged.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1408"><h2>Issue #1408 created<span class="toot-id"> #created-1408</span></h2><div class="pubdate">29 Aug at 11:11:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1408">https://github.com/qt4cg/qtspecs/issues/1408</a></div><details><summary>The description of XPTY0117 still refers to the "function conversion rules"</summary><div class="markup"><p>The description of XPTY0117 still refers to the "function conversion rules" rather than the "coercion rules".</p>
</div></details></div>
<div class="toot" id="created-1407"><h2>Issue #1407 created<span class="toot-id"> #created-1407</span></h2><div class="pubdate">29 Aug at 09:58:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1407">https://github.com/qt4cg/qtspecs/issues/1407</a></div><details><summary>Improve the spec prose and table of content layout for types</summary><div class="markup"><p>This has been discussed on Slack. The key points are:</p>
<ol>
<li>The terminology in the table of content is mixed (Union Types vs Function Tests), focused on the grammar not the organisation.</li>
<li>The test sections (Function Test, etc.) lack definitions and overviews of the item types like is done with the other types, such as choice item types.</li>
</ol>
<p>I also think the other sections like the <strong>Subtype Relationships</strong> are largely fine as they are as they are dealing with specific rules around subtypes, coercion, etc.</p>
<p>So I propose:</p>
<ol>
<li>Adding an overview of what the function types/tests, etc. are like is done with the union types, etc.</li>
<li>Adding a note to the maps overview similar to "A map is a function of the form <code>function (xs:string) as item()*</code> that can be passed a key name and returns the value of that key entry."</li>
<li>Adding a note to the arrays overview similar to "An array is a function of the form <code>function (xs:integer) as item()*</code> that returns the items of the array at the specified index, or raises a FO.... error if the index is out of bounds."</li>
</ol>
<p>I also propose renaming and reorganizing parts of the table of contents as follows (omitting unaffected sections):</p>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-types">3 Types</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-sequencetype-syntax">3.1 Sequence Types</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-sequence-type-examples">3.1.1 Examples of Sequence Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-sequencetype-matching">3.1.2 Sequence Type Matching</a></li>
</ul>
</li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-matching-item">3.2 Item Types</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#general-item-types">3.2.1 General item types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-atomic-types">3.2.2 Atomic Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-union-types">3.2.3 Union Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-namespace-sensitive">3.2.4 Namespace-sensitive Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-choice-item-types">3.2.5 Δ Choice Item Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-enumeration-types">3.2.6 Δ Enumeration Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#node-types">3.2.7 Δ Node Types</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-simple-node-tests">3.2.7.1 Simple Nodes</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-element-test">3.2.7.2 Δ Elements</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-schema-element-test">3.2.7.2.1 Schema Elements</a></li>
</ul>
</li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-attribute-test">3.2.7.3 Δ Attributes</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-schema-attribute-test">3.2.7.3.1 Schema Attributes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-function-test">3.2.8 Δ Function Types</a> ~ NOTE: Covers the current 3.2.8.1 Δ Function Test section.</li>
<li>3.2.9 Maps and Records
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-map-test">3.2.9.1 Map Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-record-test">3.2.9.2 Δ Record Types</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-recursive-record-tests">3.2.9.2.1 Recursive Record Tests</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-array-test">3.2.10 Array Types</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p>And to make the heading names in the subtype section consistent:</p>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-sequencetype-subtype">3.3 Δ Subtype Relationships</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-seqtype-subtype">3.3.1 Subtypes of Sequence Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-itemtype-subtype">3.3.2 Subtypes of Item Types</a>
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-general">3.3.2.1 General Rules</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-choice">3.3.2.2 Choice Item Types</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-atomic">3.3.2.3 Atomic and Union Types</a></li>
<li>3.3.2.4 Nodes
<ul>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-nodes">3.3.2.4.1 General Rules</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-elements">3.3.2.4.1 Elements</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-attributes">3.3.2.4.1 Attributes</a></li>
</ul>
</li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-functions">3.3.2.5 Functions</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-maps">3.3.2.6 Maps</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-arrays">3.3.2.7 Arrays</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-item-subtype-records">3.3.2.8 Records</a></li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-itemtype-subtype-aliases">3.3.2.9 Named Items</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div></details></div>
<div class="toot" id="created-1406"><h2>Pull request #1406 created<span class="toot-id"> #created-1406</span></h2><div class="pubdate">28 Aug at 13:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1406">https://github.com/qt4cg/qtspecs/pull/1406</a></div><details><summary>Fix 1399 - clarify fixed-namespaces spec</summary><div class="markup"><p>Fix #1399.</p>
<p>The only change is to remove a sentence from <code>&lt;note&gt;...&lt;/note&gt;</code> markup.</p>
</div></details></div>
<div class="toot" id="created-1405"><h2>Pull request #1405 created<span class="toot-id"> #created-1405</span></h2><div class="pubdate">28 Aug at 06:24:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1405">https://github.com/qt4cg/qtspecs/pull/1405</a></div><p>Fix #1404 by changing fn:invisible-xml grammar parameter to xs:string?</p></div>
<div class="toot" id="created-1404"><h2>Issue #1404 created<span class="toot-id"> #created-1404</span></h2><div class="pubdate">27 Aug at 21:12:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1404">https://github.com/qt4cg/qtspecs/issues/1404</a></div><details><summary>Invisible-xml function: why is $grammar of type item()?</summary><div class="markup"><p>In the <code>invisible-xml</code> function, the $grammar argument has type <code>item()?</code>. There's no evident reason why it isn't <code>xs:string?</code>; there's no clue in the specification or example what it might mean to supply something that isn't a string (or an empty sequence).</p>
<p>Note that declaring it as <code>item()</code> rather than <code>xs:string?</code> suppresses atomization of the supplied value.</p>
</div></details></div>
<div class="toot" id="created-1403"><h2>Issue #1403 created<span class="toot-id"> #created-1403</span></h2><div class="pubdate">27 Aug at 15:51:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1403">https://github.com/qt4cg/qtspecs/issues/1403</a></div><details><summary>Align AnyMapTest, AnyArrayTest and with ElementTest</summary><div class="markup"><p>I always wondered why ElementTests for <em>any element</em> can be written as <code>element()</code> which is equivalent to <code>element(*)</code> but <code>as map()</code> and <code>as array()</code> are not permitted and always have to include the asterisk (<code>map(*)</code>) .</p>
<p>This is still the case even in XPath4 and I think we should have a look, if this can be omitted.
It does not add any value IMHO, but maybe I am overlooking something important.</p>
<p>https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-ElementTest
https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-ArrayTest
https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-MapTest</p>
<p>The "fix" would be as simple as</p>
<pre><code>[255]   AnyMapTest   ::=  "map" "(" "*"? ")"
</code></pre>
<pre><code>[265]   AnyArrayTest ::=  "array" "(" "*"? ")"
</code></pre>
<p>-- update after comment from @michaelhkay --</p>
<p>The same does <em>not apply</em> to FunctionTest as <code>as function()</code> specifies a zero-arity function wheras <code>as function(*)</code> matches functions of any arity.</p>
</div></details></div>
<div class="toot" id="created-1402"><h2>Pull request #1402 created<span class="toot-id"> #created-1402</span></h2><div class="pubdate">25 Aug at 11:18:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1402">https://github.com/qt4cg/qtspecs/pull/1402</a></div><details><summary>Update schema for XSLT 4.0 to include agreed syntax changes</summary><div class="markup"><p>Updates the schema for XSLT 4.0 stylesheets to accommodate changes recently agreed:</p>
<ul>
<li>Support for xsl:function/@variadic</li>
<li>Support for extensions to decimal-format properties, for example <code>percent="%:pc"</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1401"><h2>Issue #1401 created<span class="toot-id"> #created-1401</span></h2><div class="pubdate">23 Aug at 10:18:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1401">https://github.com/qt4cg/qtspecs/issues/1401</a></div><details><summary>Casting from duration to string</summary><div class="markup"><p>We've just been examining the rules for casting from duration / dayTimeDuration / yearMonthDuration to string (F+O section 20.1.1) and they are fairly impenetrable: I think we could do better.</p>
<ul>
<li>We use the phrase "canonical representation as defined in XSD 1.1 part 2"; a more specific reference would be helpful. Mentioning the function <code>·durationCanonicalMap·</code> would take readers straight to the right place.</li>
<li>The actual XSD spec has one or two typos, and uses some notations that might not be immediately obvious to every reader, for example <code>|m|</code> to mean <code>abs(m)</code>.</li>
</ul>
<p>I think the best answer to this is to add non-normative examples, which are badly missing from this whole section.</p>
<p>This would probably require splitting of 20.1.1 into subsections. Alternatively, we could add examples to the string() function, which would have the benefit that we have validation machinery to check that the examples under a specific function are correct; we could point to these examples from 20.1.1.</p>
</div></details></div>
<div class="toot" id="closed-1366"><h2>Issue #1366 closed<span class="toot-id"> #closed-1366</span></h2><div class="pubdate">22 Aug at 20:36:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1366">https://github.com/qt4cg/qtspecs/issues/1366</a></div><p>In the EBNF, use explicit separator syntax</p></div>
<div class="toot" id="created-1400"><h2>Pull request #1400 created<span class="toot-id"> #created-1400</span></h2><div class="pubdate">22 Aug at 18:49:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1400">https://github.com/qt4cg/qtspecs/pull/1400</a></div><details><summary>1395 Revise rules for subtyping of choice item types</summary><div class="markup"><p>Corrects/clarifies the rules for determining whether A is a subtype of B when either or both is a choice item type.</p>
<p>Fix #1395</p>
</div></details></div>
<div class="toot" id="created-1399"><h2>Issue #1399 created<span class="toot-id"> #created-1399</span></h2><div class="pubdate">22 Aug at 14:41:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1399">https://github.com/qt4cg/qtspecs/issues/1399</a></div><details><summary>XSLT fixed-namespaces - contradictory statements</summary><div class="markup"><p>We say:</p>
<blockquote>
<p>Any one of the strings xsl, xml, xs, xsi, fn, math, map, array, err. This has the effect of binding that particular namespace prefix to the [reserved namespace] with which it is conventionally associated, whether or not the [native namespace bindings] contain a binding for this prefix.</p>
</blockquote>
<blockquote>
<p>Note: ...</p>
</blockquote>
<blockquote>
<p>If the namespace prefix is explicitly bound to a different namespace, for example xmlns:math="java:java.util.Math", then that binding takes precedence.</p>
</blockquote>
<p>Given</p>
<p><code>&lt;xsl:stylsheet fixed-namespaces="math" xmlns:math="java:java.util.Math"&gt;</code></p>
<p>The normative statement implies that "java" is bound to <code>http://www.w3.org/2005/xpath-functions/math</code>, while the note implies it is bound to <code>"java:java.util.Math"</code> -- which surely makes more sense. I suspect the intended reading of the normative sentence is "whether or not the [native namespace bindings] contain this binding; but it needs clarifying/correcting.</p>
</div></details></div>
<div class="toot" id="created-1398"><h2>Pull request #1398 created<span class="toot-id"> #created-1398</span></h2><div class="pubdate">22 Aug at 08:59:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1398">https://github.com/qt4cg/qtspecs/pull/1398</a></div><details><summary>1397 Add missing change log entry for constructor functions</summary><div class="markup"><p>Fix #1397</p>
</div></details></div>
<div class="toot" id="created-1397"><h2>Issue #1397 created<span class="toot-id"> #created-1397</span></h2><div class="pubdate">22 Aug at 08:18:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1397">https://github.com/qt4cg/qtspecs/issues/1397</a></div><details><summary>Missing change log entry for zero-arity constructor functions</summary><div class="markup"><p>We've changed constructor functions to allow arity zero, but there is no change log entry for this.</p>
<p>Issue #658, PR #662</p>
</div></details></div>
<div class="toot" id="created-1396"><h2>Issue #1396 created<span class="toot-id"> #created-1396</span></h2><div class="pubdate">21 Aug at 23:45:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1396">https://github.com/qt4cg/qtspecs/issues/1396</a></div><details><summary>Rendition of EBNF syntax scraps</summary><div class="markup"><p>In the EBNF syntax tabulation, the column width available for the RHS of productions is rather limited, leading to excessive line wrapping, especially where the entire syntax is displayed in Appendix A.</p>
<p>I haven't been entirely successful in sorting this out, but record my experiments here.</p>
<p>(a) In the CSS stylesheet qtspecs.css line 169, change the padding from 30px to 10px</p>
<p>(b) remove all the non-breaking spaces that are inserted after the production number and around the <code>::=</code> operator. (Search for <code>::=</code> in xmlspec-2016.xsl</p>
<p>(c) get rid of the tbody element that surrounds each tr by putting the productions in a prodgroup, achieved by adding a prodgroup element around the line <code>&lt;prodrecap id="BNF-Grammar-prods" ref="BNF-Grammar-prods"/&gt;</code> (line 43 of ebnf.xml)</p>
<p>Unfortunately this doesn't seem to allocate extra width to the columns, it merely creates extra whitespace to the right of the table. I can't work out why that is happening.</p>
<p>Another step would be to remove the final right-hand column containing comments, instead moving the comments to be under the RHS of the production. But the logic here is complex...</p>
<p>Finally, a pragmatic move would be to reduce the length of the longest production names, such as <code>FunctionSignatureWithDefaults</code>, which bloat the width of the LH column.</p>
</div></details></div>
<div class="toot" id="closed-1315"><h2>Issue #1315 closed<span class="toot-id"> #closed-1315</span></h2><div class="pubdate">21 Aug at 22:19:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1315">https://github.com/qt4cg/qtspecs/issues/1315</a></div><p>12 div-3</p></div>
<div class="toot" id="created-1395"><h2>Issue #1395 created<span class="toot-id"> #created-1395</span></h2><div class="pubdate">21 Aug at 16:57:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1395">https://github.com/qt4cg/qtspecs/issues/1395</a></div><details><summary>Choice item types: subtyping</summary><div class="markup"><p>We say: [with the example changed for clarity]</p>
<blockquote>
<p>3.3.2.2 Choice Item Types</p>
<p>[1] If B is a [choice item type], then A ⊆ B is true if A ⊆ M is true for some item type M among the alternatives of B.</p>
<p>[2] If A is a [choice item type], then A ⊆ B is true if M ⊆ B is true for every item type M among the alternatives of A.</p>
<p>Note:</p>
<p>Because an [enumeration type] is defined as a choice type of singleton enumerations, these rules have the consequence, for example, that enum("P", "Q") is a subtype of enum("P", "Q", "R").</p>
</blockquote>
<p>Now, the first condition [1] doesn't hold: <code>enum("P", "Q")</code> is not a subtype of <code>enum("P")</code>, nor of <code>enum("Q")</code>, nor of <code>enum("R")</code>.</p>
<p>But the second condition [2] does hold: <code>enum("P")</code> and <code>enum("Q")</code> are both subtypes of <code>enum("P", "Q", "R")</code>, under rule [1].</p>
<p>So the rules are far from clear when both A and B are choice item types.</p>
<p>I think it probably needs a combined rule.</p>
<p>(i) if both A and B are choice item types, then A ⊆ B is true if every item type a among the alternatives of A satisfies a ⊆ b for some item type b among the alternatives of B.</p>
<p>The existing two rules are really just special cases of that for singleton choices.</p>
</div></details></div>
<div class="toot" id="created-1394"><h2>Issue #1394 created<span class="toot-id"> #created-1394</span></h2><div class="pubdate">20 Aug at 16:26:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1394">https://github.com/qt4cg/qtspecs/issues/1394</a></div><details><summary>XSLT Default priority for `element(p:*)` etc</summary><div class="markup"><p>There are new possibilities for node tests used as XSLT patterns, for example <code>element(p:*)</code>, <code>element(*:local)</code>, <code>element(p:*, T)</code>, <code>element(*:local, T)</code>. These need to have default priorities assigned.</p>
</div></details></div>
<div class="toot" id="created-1393"><h2>Pull request #1393 created<span class="toot-id"> #created-1393</span></h2><div class="pubdate">19 Aug at 10:48:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1393">https://github.com/qt4cg/qtspecs/pull/1393</a></div><details><summary>1391 Change function-annotations to return a sequence</summary><div class="markup"><p>Fix #1391</p>
<ul>
<li>Changes the data model to clarify exactly what the annotations of a function item are</li>
<li>Clarifies the XQuery description of what effect annotations in the query prolog have</li>
<li>Changes the fn:function-annotations function to return a sequence of key value pairs in which there can be duplicate keys.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1392"><h2>Issue #1392 created<span class="toot-id"> #created-1392</span></h2><div class="pubdate">18 Aug at 20:57:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1392">https://github.com/qt4cg/qtspecs/issues/1392</a></div><details><summary>`element(a|b)` vs `(element(a)|element(b))`</summary><div class="markup"><p>We have introduced two syntax extensions which achieve the same effect:</p>
<p><code>element(a|b)</code> vs <code>(element(a)|element(b))</code></p>
<p>Do we actually want both?</p>
<p>If we do, I would suggest that we define <code>element(a|b)</code> as a shorthand for <code>(element(a)|element(b))</code>.</p>
<p>Are they actually equivalent? I think it's fairly clear that they match the same items. It's less clear what the subtyping rules have to say. I think each is a subtype of the other, which means they are substitutable for each other in a function signature, but it needs a lot of digging in the spec to demonstrate this. Are they equivalent from the point of view of coercion rules? I think they probably are, because no coercion actually takes place when the required type is a node type.</p>
<p>So I think there's no technical bug here just a lack of clarity. It would be easier (assuming we want to retain the syntax at all) if we defined <code>element(a|b)</code> as a shorthand for <code>(element(a)|element(b))</code>.</p>
<p>Minor editorial issues:</p>
<ul>
<li>In 3.2.7.2 example 5 is incorrect -- <code>element(xhtml:*|svg:*|mathml|*)</code> - the last <code>|</code> should be <code>:</code>.</li>
<li>In the changes section of 3.2.7.2, the <code>element(A|B)</code> syntax is not mentioned.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1391"><h2>Issue #1391 created<span class="toot-id"> #created-1391</span></h2><div class="pubdate">16 Aug at 19:54:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1391">https://github.com/qt4cg/qtspecs/issues/1391</a></div><details><summary>Annotations: duplicate names</summary><div class="markup"><p>The function <code>fn:function-annotations</code> returns a map from QNames to values, which rather assumes that a function cannot have two annotations with the same name. But there is nothing in either the data model or the XQuery language spec that imposes this restriction.</p>
</div></details></div>
<div class="toot" id="created-1390"><h2>Pull request #1390 created<span class="toot-id"> #created-1390</span></h2><div class="pubdate">16 Aug at 17:18:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1390">https://github.com/qt4cg/qtspecs/pull/1390</a></div><details><summary>1368 built in keywords improvements</summary><div class="markup"><p>Rewrite of stylesheet for generating keyword tests</p>
</div></details></div>
<div class="toot" id="created-1389"><h2>Issue #1389 created<span class="toot-id"> #created-1389</span></h2><div class="pubdate">15 Aug at 09:02:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1389">https://github.com/qt4cg/qtspecs/issues/1389</a></div><details><summary>fn:while-do: Optional error: will not terminate</summary><div class="markup"><p>In many cases, a compiler may detect that a <code>fn:while-do</code> or <code>fn:do-until</code> function call will not terminate. Trivial examples:</p>
<pre><code class="language-xquery">while-do((), true#0, identity#1)
while-do((), exists#1, fn($c) { $c, $c }
</code></pre>
<p>We should add a fixed error code that an implementation sʜᴏᴜʟᴅ (or ᴍᴀʏ?) raise when it encounters such a case. The error can be raised statically (e.g., as the result of type checks) or dynamically (when the input is not known at compile time). We could reuse <code>XQDY0054</code>.</p>
<p>In principle, the error code could also be used to reject non-terminating recursive functions:</p>
<pre><code class="language-xquery">declare function local:rec() { local:rec() };
local:rec()

declare function local:duplicate($input) {
  if(exists($input)) then $input else local:duplicate(($input, $input))
};
local:duplicate(())

let $oh := fn($my) { $my($my) }
return $oh($oh)

(: if we legalize this, see #1379 :)
declare variable $rec := fn() { $rec };
$rec()
</code></pre>
</div></details></div>
<div class="toot" id="created-1388"><h2>Pull request #1388 created<span class="toot-id"> #created-1388</span></h2><div class="pubdate">14 Aug at 10:26:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1388">https://github.com/qt4cg/qtspecs/pull/1388</a></div><details><summary>Attempt to resolve #1387 by clarifying the encoding rules</summary><div class="markup"><p>I decided to put this in a separte PR so that it can be reviewed in isolation. I don't expect it to be controversial, exactly, but it may require adjustment.</p>
</div></details></div>
<div class="toot" id="created-1387"><h2>Issue #1387 created<span class="toot-id"> #created-1387</span></h2><div class="pubdate">13 Aug at 15:55:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1387">https://github.com/qt4cg/qtspecs/issues/1387</a></div><details><summary>fn:build-uri: Observations</summary><div class="markup"><p>@ndw I’ll again start with a single test case, <a href="https://github.com/qt4cg/qt4tests/blob/b5c9431b6e5c7e24729a4de19aac1754b0b34c4a/fn/build-uri.xml#L296-L314">fn-build-uri-from-parse-020</a>:</p>
<pre><code class="language-xml">&lt;test-case name="fn-build-uri-from-parse-020"&gt;
    &lt;description&gt;Builds an example from the specification&lt;/description&gt;
    &lt;created by="Norm Tovey-Walsh" on="2023-03-10"/&gt;
    &lt;test&gt;fn:build-uri(map {
  "uri": "ldap://[2001:db8::7]/c=GB?objectClass?one",
  "scheme": "ldap",
  "authority": "[2001:db8::7]",
  "host": "[2001:db8::7]",
  "path": "/c=GB",
  "query": "objectClass?one",
  "query-parameters": map {
    "": "objectClass?one"
  },
  "path-segments": ("", "c=GB")
})&lt;/test&gt;
    &lt;result&gt;
      &lt;assert-eq&gt;"ldap://[2001:db8::7]/c=GB?objectClass?one"&lt;/assert-eq&gt;
    &lt;/result&gt;
  &lt;/test-case&gt;
</code></pre>
<p>I would expect <code>ldap://[2001:db8::7]/c=GB?=objectClass%3Fone</code> as result, as the spec says…</p>
<blockquote>
<p>If the <code>query-parameters</code> key exists in the map, its value must be a map. A sequence of strings is constructed from the values in the map. For each key and each <em>value</em> associated with that <em>key</em> in turn:</p>
<ul>
<li>If the <em>key</em> is the empty string, the string constructed is the <em>value</em> encoded with <code>encode-for-uri</code>.</li>
</ul>
</blockquote>
<p>…and <code>encode-for-uri('?')</code> gives us <code>%3F</code>. How do you handle that in your code?</p>
</div></details></div>
<div class="toot" id="created-1386"><h2>Pull request #1386 created<span class="toot-id"> #created-1386</span></h2><div class="pubdate">13 Aug at 10:43:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1386">https://github.com/qt4cg/qtspecs/pull/1386</a></div><details><summary>1382 add error code XTSE4040</summary><div class="markup"><p>Fix #1382</p>
</div></details></div>
<div class="toot" id="created-1385"><h2>Issue #1385 created<span class="toot-id"> #created-1385</span></h2><div class="pubdate">13 Aug at 09:04:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1385">https://github.com/qt4cg/qtspecs/issues/1385</a></div><details><summary>Quantifier expressions: optional positional argument</summary><div class="markup"><p>This has been requested multiple times before (albeit not in this repository): What about adding a positional argument to quantifier expressions? It it simple to implement, and it would allow us to do things like…</p>
<pre><code class="language-xquery">every $item at $pos in $input satisfies $item = $pos * 2
</code></pre>
<p>…which would be equivalent to…</p>
<pre><code class="language-xquery">every($input, fn($item, $pos) { $item = $pos * 2 })
</code></pre>
<p>…and much better to read than e.g.…</p>
<pre><code class="language-xquery">not((for $item at $pos in $input return $item = $pos * 2) = false())
</code></pre>
</div></details></div></div><p>See 2739
            more statuses in yearly archives.</p></article></main></body></html>