<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="agenda-06-04"><h2>QT4 CG meeting 080 draft agenda<span class="toot-id"> #agenda-06-04</span></h2><div class="pubdate">31 May at 11:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/06-04">https://qt4cg.org/meeting/agenda/2024/06-04</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1246"><h2>Issue #1246 created<span class="toot-id"> #created-1246</span></h2><div class="pubdate">29 May at 13:18:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1246">https://github.com/qt4cg/qtspecs/issues/1246</a></div><details><summary>fn:json-to-xml: `number-parser` option</summary><div class="markup"><p>With #973, the <code>number-parser</code> option was added to <code>fn:json-to-xml</code>. It has been reported back to us that the current definition introduces a backward incompatibility:</p>
<pre><code class="language-xquery">json-to-xml('1234567')
</code></pre>
<p>â€¦now returns:</p>
<pre><code class="language-xquery">&lt;number xmlns="http://www.w3.org/2005/xpath-functions"&gt;1.234567E6&lt;/number&gt;
</code></pre>
<p>Before, we got:</p>
<pre><code class="language-xquery">&lt;number xmlns="http://www.w3.org/2005/xpath-functions"&gt;1234567&lt;/number&gt;
</code></pre>
<p>Iâ€™m convinced that the <code>number-parser</code> option is am important addition for <code>fn:json-to-xml</code> â€“ Iâ€™ve already seen its application in practice â€“ but I think weâ€™ll need to change the default, which currently <code>xs:double#1</code>.</p>
<p>It seems sufficient to me to change <code>xs:double#1</code> to <code>identity#1</code>.</p>
<p>As a side note, <a href="https://www.w3.org/TR/xpath-functions-31/#json-to-xml-mapping">17.4.2 XML Representation of JSON</a> still states that:</p>
<blockquote>
<p>The <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-json-to-xml">fn:json-to-xml</a> function creates an element whose string value is lexically the same as the JSON representation of the number.</p>
</blockquote>
<p>â€¦which means that the semantics of <code>number-parser</code> have not been incorporated in this section yet (my fault).</p>
</div></details></div>
<div class="toot" id="minutes-05-28"><h2>QT4 CG meeting 079 draft minutes<span class="toot-id"> #minutes-05-28</span></h2><div class="pubdate">28 May at 17:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/05-28">https://qt4cg.org/meeting/minutes/2024/05-28</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-1245"><h2>Issue #1245 created<span class="toot-id"> #created-1245</span></h2><div class="pubdate">28 May at 16:02:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1245">https://github.com/qt4cg/qtspecs/issues/1245</a></div><details><summary>fn:format-dateTime: Properties</summary><div class="markup"><p>The <strong>Properties</strong> of <code>fn:format-dateTime</code> say:</p>
<blockquote>
<p>The two-argument form of this function is Â·deterministicÂ·, Â·context-dependentÂ·, and Â·focus-independentÂ·. It depends on default calendar, and default language, and default place, and implicit timezone.
The five-argument form of this function is Â·deterministicÂ·, Â·context-dependentÂ·, and Â·focus-independentÂ·. It depends on implicit timezone, and namespaces.</p>
</blockquote>
<p>They fail to mention the new three- and four-argument form.</p>
<p>The same applies to <code>fn:format-date</code> and <code>fn:format-time</code>.</p>
</div></details></div>
<div class="toot" id="closed-1108"><h2>Issue #1108 closed<span class="toot-id"> #closed-1108</span></h2><div class="pubdate">28 May at 15:56:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1108">https://github.com/qt4cg/qtspecs/pull/1108</a></div><p>566-partial Describe a less aggressive %-encoding for fn:build-uri</p></div>
<div class="toot" id="closed-1232"><h2>Issue #1232 closed<span class="toot-id"> #closed-1232</span></h2><div class="pubdate">28 May at 15:56:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1232">https://github.com/qt4cg/qtspecs/issues/1232</a></div><p>Rendition of RFC2119 terms</p></div>
<div class="toot" id="closed-1237"><h2>Issue #1237 closed<span class="toot-id"> #closed-1237</span></h2><div class="pubdate">28 May at 15:56:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1237">https://github.com/qt4cg/qtspecs/pull/1237</a></div><p>1232 consistent rendition of rfc2119 terms</p></div>
<div class="toot" id="closed-894"><h2>Issue #894 closed<span class="toot-id"> #closed-894</span></h2><div class="pubdate">28 May at 15:55:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/894">https://github.com/qt4cg/qtspecs/issues/894</a></div><p>Errors in forming function items</p></div>
<div class="toot" id="closed-908"><h2>Issue #908 closed<span class="toot-id"> #closed-908</span></h2><div class="pubdate">28 May at 15:55:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/908">https://github.com/qt4cg/qtspecs/issues/908</a></div><p>Function identity: documentation, nondeterminism</p></div>
<div class="toot" id="closed-1000"><h2>Issue #1000 closed<span class="toot-id"> #closed-1000</span></h2><div class="pubdate">28 May at 15:55:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1000">https://github.com/qt4cg/qtspecs/issues/1000</a></div><p>XQFO Code in the Rules sections</p></div>
<div class="toot" id="closed-1242"><h2>Issue #1242 closed<span class="toot-id"> #closed-1242</span></h2><div class="pubdate">28 May at 15:54:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1242">https://github.com/qt4cg/qtspecs/issues/1242</a></div><p>XSLT: system-property('xsl:xpath-version')</p></div>
<div class="toot" id="closed-1243"><h2>Issue #1243 closed<span class="toot-id"> #closed-1243</span></h2><div class="pubdate">28 May at 15:54:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1243">https://github.com/qt4cg/qtspecs/pull/1243</a></div><p>Change required result of system-property(...version)</p></div>
<div class="toot" id="closed-1098"><h2>Issue #1098 closed<span class="toot-id"> #closed-1098</span></h2><div class="pubdate">28 May at 14:44:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1098">https://github.com/qt4cg/qtspecs/pull/1098</a></div><p>566-partial Editorial improvements for parse-uri</p></div>
<div class="toot" id="created-1244"><h2>Pull request #1244 created<span class="toot-id"> #created-1244</span></h2><div class="pubdate">28 May at 14:44:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1244">https://github.com/qt4cg/qtspecs/pull/1244</a></div><details><summary>566-partial Rewrite parse-uri</summary><div class="markup"><p>What happened was, I discovered I'd messed with the code in two different branches.</p>
<p>In the course of trying to straighten that out, I came to the conclusion that the <em>real</em> difficulty in parsing URIs is what to do about all the special cases around <code>file:</code>. And that the approach I'd taken in the previous draft was unnecessarily complicated.</p>
<p>I think this is better.</p>
</div></details></div>
<div class="toot" id="agenda-05-28"><h2>QT4 CG meeting 079 draft agenda<span class="toot-id"> #agenda-05-28</span></h2><div class="pubdate">27 May at 11:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/05-28">https://qt4cg.org/meeting/agenda/2024/05-28</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1243"><h2>Pull request #1243 created<span class="toot-id"> #created-1243</span></h2><div class="pubdate">26 May at 14:53:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1243">https://github.com/qt4cg/qtspecs/pull/1243</a></div><details><summary>Change required result of system-property(...version)</summary><div class="markup"><p>Fix #1242</p>
</div></details></div>
<div class="toot" id="created-1242"><h2>Issue #1242 created<span class="toot-id"> #created-1242</span></h2><div class="pubdate">26 May at 13:35:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1242">https://github.com/qt4cg/qtspecs/issues/1242</a></div><details><summary>XSLT: system-property('xsl:xpath-version')</summary><div class="markup"><p>In XSLT 4.0 it should be required that <code>system-property('xsl:xpath-version')</code> returns 4.0</p>
</div></details></div>
<div class="toot" id="created-1241"><h2>Issue #1241 created<span class="toot-id"> #created-1241</span></h2><div class="pubdate">26 May at 08:05:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1241">https://github.com/qt4cg/qtspecs/issues/1241</a></div><details><summary>Node constructor vs. otherwise/map constructor</summary><div class="markup"><p>I wonder whether we should care that the following expression could be interpreted in two ways:</p>
<pre><code class="language-xquery">&lt;ðŸ¤”/&gt; ! (element otherwise {})
</code></pre>
<p>The result could either be <code>&lt;otherwise/&gt;</code> or an empty map.</p>
<p>If we say itâ€™s an edge case that we can ignore, it would be fine for me.</p>
<p>Before <code>otherwise</code> was introduced, we used <code>?:</code> in our implementation, analogous to Kotlinâ€™s <a href="https://kotlinlang.org/docs/null-safety.html#elvis-operator">Elvis operator</a>. JavaScript now has <code>??</code> (which is no option for us).</p>
</div></details></div>
<div class="toot" id="created-1240"><h2>Issue #1240 created<span class="toot-id"> #created-1240</span></h2><div class="pubdate">23 May at 16:34:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1240">https://github.com/qt4cg/qtspecs/issues/1240</a></div><details><summary>$sequence-of-maps ? info()</summary><div class="markup"><p>We're increasingly using the design pattern where maps contain entries that are function items. If <code>$map</code> is a map and it has an entry <code>info</code> that is a zero-arity function, then <code>$map ? info()</code> invokes the function. This looks appealingly as if it's a method application applying the method <code>info()</code> on the object <code>$map</code>, but that's not actually what's really going on underneath. What is really happening is that we evaluate <code>($map ? info)</code> which yields a function item, and then we dynamically call this function.</p>
<p>Now what if <code>$maps</code> is a sequence of maps each of which has an <code>info</code> field? This parses as <code>($maps ? info)()</code>. <code>$maps ? info</code> returns a sequence of function items, and a dynamic function call can't be applied to a sequence of functions items. Instead you have to write <code>($maps ? info)!.()</code> which feels fairly bizarre.</p>
<p>Should we allow the LHS of a dynamic function call to be a sequence? On the whole, I don't tend to like operations to do implicit mapping over one of the arguments, but I feel like this might warrant an exception. The justification is that a dynamic function call is a postfix expression, and all the other postfix expressions accept a sequence on the LHS. Thoughts please.</p>
</div></details></div>
<div class="toot" id="created-1239"><h2>Issue #1239 created<span class="toot-id"> #created-1239</span></h2><div class="pubdate">23 May at 06:56:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1239">https://github.com/qt4cg/qtspecs/issues/1239</a></div><details><summary>XSLT xsl:next-match with select attribute</summary><div class="markup"><p>The ability of <code>xsl:next-match</code> to apply a sequence of template rules to the same item is limited by the fact that the item in question cannot be changed in any way. For example, if I want a template rule that matches an array to sort the array and then continue processing using the next rule for arrays, it's not possible; applying templates to the new array will sort it again, ad infinitum, while doing next-match is only possible on the original array, not the new sorted version.</p>
<p>I propose that xsl:next-match should have a select attribute. The effect is to process the selected items using the current mode, considering only the template rules that are lower in ranking order than the current template rule.</p>
<p>Alternatively or in addition, we could drop the rule that instructions that change the context item also clear the current mode. This would enable, for example, xsl:next-match to be used within xsl:for-each. However, it's possible that the results here could be confusing: we need to look at use cases.</p>
</div></details></div>
<div class="toot" id="created-1238"><h2>Issue #1238 created<span class="toot-id"> #created-1238</span></h2><div class="pubdate">23 May at 06:30:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1238">https://github.com/qt4cg/qtspecs/issues/1238</a></div><details><summary>XSLT on-no-match="shallow-copy-all" - revised rules</summary><div class="markup"><p>The work on deep lookup with modifiers enables an improved set of rules for processing trees of maps and arrays using a mode with <code>on-no-match="shallow-copy-all"</code>.</p>
<p>Recall that the intent is that if the user writes no template rules at all in such a mode, the effect is to recursively copy the entire structure without change. But it should be as easy as possible for the user to add template rules to override this processing for a selected part of the structure.</p>
<p>With this in mind, the proposed built-in rules are as follows:</p>
<p>For an array with no additional information available, we split it up into array members in a way that makes it possible to override
the processing for a specific array member:</p>
<pre><code>&lt;xsl:template match="array(*)"&gt;
  &lt;xsl:array use="?member"&gt;
     &lt;xsl:apply-templates select="for member $m at $pos in . 
                  return {"array-member":true(), "index": $pos, "member": $m}"
                                          mode="#current"/&gt;
  &lt;/xsl:array&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>The field 'array-member' here is a dummy, provided simply to make it easier to match these records at the next level of processing.</p>
<p>For the array members, when represented in this way, the items in the array member are processed one-by-one to produce
a new array member:</p>
<pre><code>&lt;xsl:template match="record(array-member as xs:boolean, index as xs:integer, member as item()*)"&gt;
     &lt;xsl:map:entry key="'member'"&gt;
        &lt;xsl:apply-templates select="for $item at $pos in ?member
                                                          return {"array-member-item":true(), 
                                                                       "index": ?index, 
                                                                       "member": ?member, 
                                                                       "item": $item,
                                                                       "position": $pos }"
                                            mode="#current"/&gt;
    &lt;/xsl:map:entry&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>The new array members are delivered as singleton maps, in the form expected by the match="array(*)" template given above.</p>
<p>For the individual items within each array member, the default is simply to apply-templates to the item:</p>
<pre><code>&lt;xsl:template match="record(array-member-item as ..., index as ..., member as ..., item as item(), position as ...)"&gt;
   &lt;xsl:apply-templates select="?item" mode="#current"/&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>Similarly for a map with no additional information, we reconstruct the map by applying templates to its individual entries:</p>
<pre><code>&lt;xsl:template match="map(*)"&gt;
  &lt;xsl:map on-duplicates="op(',')"&gt;
     &lt;xsl:apply-templates select="for entry ($k, $v) in . 
                                                        return {"map-entry":true(), "key": $k, "value": $v}"
                                          mode="#current"/&gt;
  &lt;/xsl:array&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>The built in processing for a map entry represented in this way is to reconstruct the map entry by applying templates to its individual items:</p>
<pre><code>&lt;xsl:template match="record(map-entry as xs:boolean, key as xs:anyAtomicType, value as item()*)"&gt;
     &lt;xsl:map:entry key="$key"&gt;
        &lt;xsl:apply-templates select="for $item at $pos in ?value
                                                          return {"map-entry-item":true(), 
                                                                       "key": ?key, 
                                                                       "value": ?value, 
                                                                       "item": $item,
                                                                       "position": $pos }"
                                            mode="#current"/&gt;
    &lt;/xsl:map:entry&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>For the individual items within each map entry, the default is simply to apply-templates to the item:</p>
<pre><code>&lt;xsl:template match="record(map-entry-item as ..., key as ..., value as ..., item as item(), position as ...)"&gt;
   &lt;xsl:apply-templates select="?item" mode="#current"/&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>And of course the fallback processing for items not in the above list is to return them unchanged:</p>
<pre><code>&lt;xsl:template match="item()"&gt;
   &lt;xsl:sequence select="."/&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>This allows user-written template rules to intervene at any of these levels, and to have access to contextual information about the item they are processing. For example to rename map entries with key "comment" to have key "note" instead, use:</p>
<pre><code>&lt;xsl:template match="record(map-entry, *)[?key = 'comment']"&gt;
   &lt;xsl:map-entry key="'note'" select="?value"/&gt;
&lt;/xsl:template&gt;
</code></pre>
<p>There's one more refinement I would like, which is to provide access to the selection path for each map and array entry. I think this can be done by ensuring that within the template, items are labeled so that the function call selection-path(?value) or selection-path(?item) delivers the required result.</p>
</div></details></div>
<div class="toot" id="closed-1146"><h2>Issue #1146 closed<span class="toot-id"> #closed-1146</span></h2><div class="pubdate">22 May at 19:21:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1146">https://github.com/qt4cg/qtspecs/issues/1146</a></div><p>Identifying 4.0 Changes</p></div>
<div class="toot" id="created-1237"><h2>Pull request #1237 created<span class="toot-id"> #created-1237</span></h2><div class="pubdate">22 May at 18:57:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1237">https://github.com/qt4cg/qtspecs/pull/1237</a></div><details><summary>1232 consistent rendition of rfc2119 terms</summary><div class="markup"><p>Fix #1232</p>
</div></details></div>
<div class="toot" id="created-1236"><h2>Issue #1236 created<span class="toot-id"> #created-1236</span></h2><div class="pubdate">22 May at 12:52:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1236">https://github.com/qt4cg/qtspecs/issues/1236</a></div><details><summary>QT4CG-078-01 fn:unparsed-text-lines, normalize newlines</summary><div class="markup"><p>I think we should offer <code>normalize-newlines</code> only for <code>fn:unparsed-text</code>:</p>
<ul>
<li>It should never affect the result of <code>fn:unparsed-text-available</code>.</li>
<li>I doubt (after further consideration) that itâ€™s really helpful for <code>fn:unparsed-text-lines</code>. The default should work just fine for nearly all users. If someone really needs to do more sophisticated string processing, itâ€™s still possible to use <code>fn:unparsed-text</code> and modify the result.</li>
</ul>
<p>I have commited some test that (more or less) reflect the status quo: https://github.com/qt4cg/qt4tests/commit/68d40455f2404c379fdccddc1d524648ae4c8803</p>
</div></details></div>
<div class="toot" id="closed-1189"><h2>Issue #1189 closed<span class="toot-id"> #closed-1189</span></h2><div class="pubdate">22 May at 10:06:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1189">https://github.com/qt4cg/qtspecs/issues/1189</a></div><p>Function: distinct document order</p></div>
<div class="toot" id="closed-1180"><h2>Issue #1180 closed<span class="toot-id"> #closed-1180</span></h2><div class="pubdate">22 May at 10:05:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1180">https://github.com/qt4cg/qtspecs/issues/1180</a></div><p>fn:unparsed-text: `cache` option</p></div>
<div class="toot" id="closed-1172"><h2>Issue #1172 closed<span class="toot-id"> #closed-1172</span></h2><div class="pubdate">22 May at 10:01:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1172">https://github.com/qt4cg/qtspecs/issues/1172</a></div><p>Iterating maps: Positional access</p></div>
<div class="toot" id="closed-1214"><h2>Issue #1214 closed<span class="toot-id"> #closed-1214</span></h2><div class="pubdate">22 May at 09:46:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1214">https://github.com/qt4cg/qtspecs/issues/1214</a></div><p>fn:hash, CRC-32: Describe output</p></div>
<div class="toot" id="created-1235"><h2>Issue #1235 created<span class="toot-id"> #created-1235</span></h2><div class="pubdate">22 May at 08:56:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1235">https://github.com/qt4cg/qtspecs/issues/1235</a></div><details><summary>Function Identity: Treating function items with identical bodies</summary><div class="markup"><p>(One) requirement resulting from #908 (in particular, https://github.com/qt4cg/qtspecs/issues/908#issuecomment-1891524815):</p>
<p>The following examples reflect the status quo:</p>
<p># | Function | Result
-- | -- | --
1 | <code>deep-equal(&lt;a/&gt;, &lt;a/&gt;)</code> | <code>true</code>
2 | <code>let $f := fn { &lt;a/&gt; } return deep-equal($f, $f)</code> | <code>true</code>
3 | <code>deep-equal(fn { 1 }, fn { 1 })</code> | <code>true</code> or <code>false</code>
4 | <code>deep-equal(fn { &lt;a/&gt; }, fn { &lt;a/&gt; })</code> | <code>false</code></p>
<h4>Notes</h4>
<ol>
<li>The result is <code>true</code> (regardless of the identity of the compared nodes).</li>
<li>The result is <code>true</code> (regardless of the identity of the nodes that result from evaluating the functions)</li>
<li>The result is allowed to be <code>true</code> or <code>false</code>, depending on the optimization strategies of a processor.</li>
<li>Only in this case, the result must currently be <code>false</code>.</li>
</ol>
<p>We should allow <code>deep-equal</code> to return <code>true</code> for function items that have the same arguments and bodies. An implementation should be allowed to use the same internal representation for multiple occurrences of such functions.</p>
</div></details></div>
<div class="toot" id="closed-812"><h2>Issue #812 closed<span class="toot-id"> #closed-812</span></h2><div class="pubdate">22 May at 08:34:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/812">https://github.com/qt4cg/qtspecs/issues/812</a></div><p>Coercion Rules: Unifications</p></div></div><p>See 2455
            more statuses in yearly archives.</p></article></main></body></html>