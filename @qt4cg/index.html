<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses</title></head><body><main><article><h1>@qt4cg statuses</h1><p>This page displays recent status
            updates
            about the QT4CG project.</p><p>The are also captured in <a href="status.rss">an RSS feed</a>.</p><p>By year: <a href="2024/">2024</a>, <a href="2023/">2023</a>, <a href="2022/">2022</a>, <a href="2021/">2021</a>, <a href="2020/">2020</a></p><div class="toots">
<div class="toot" id="created-1320"><h2>Issue #1320 created<span class="toot-id"> #created-1320</span></h2><div class="pubdate">11 Jul at 11:30:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1320">https://github.com/qt4cg/qtspecs/issues/1320</a></div><details><summary>fn:parse-uri: Observations</summary><div class="markup"><p>@ndw I decided to only give feedback on the first test that fails; maybe it makes things easier. Next, I chose this repository (instead of <code>qt4tests</code>), as you are the better person to judge if bugs are to be fixed in the tests or the spec.</p>
<p>The test case <a href="https://github.com/qt4cg/qt4tests/blob/5b0750b035d336040b4944dba6225e50bd004839/fn/parse-uri.xml#L239-L253">fn-parse-uri-012</a> uses <code>fn:parse-uri("file:///c:/path/to/file")</code> and returns:</p>
<pre><code class="language-xquery">{
  "uri": "file:///c:/path/to/file",
  "scheme": "file",
  "hierarchical": true(),
  "path": "/c:/path/to/file",
  "filepath": "c:/path/to/file",
  "path-segments": ("", "c:", "path", "to", "file")
}
</code></pre>
<p>Following the current rules, I would have expected <code>filepath</code> to be <code>/c:/path/to/file</code>:</p>
<pre><code>If URI matches `^([a-zA-Z][A-Za-z0-9\+\-\.]*):(.*)$`:
• SCHEME: file
• STRING: ///c:/path/to/file

If the scheme is known to be file and the string matches "^/*(/[a-zA-Z][:|].*)$":
• STRING: /c:/path/to/file

If the scheme is file or the empty sequence, and filepath is the empty sequence, filepath is also the whole string:
• FILEPATH: /c:/path/to/file
</code></pre>
<p>Would you propose to revise the test or the specification?</p>
</div></details></div>
<div class="toot" id="minutes-07-09"><h2>QT4 CG meeting 085 draft minutes<span class="toot-id"> #minutes-07-09</span></h2><div class="pubdate">09 Jul at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/07-09">https://qt4cg.org/meeting/minutes/2024/07-09</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1158"><h2>Issue #1158 closed<span class="toot-id"> #closed-1158</span></h2><div class="pubdate">09 Jul at 16:26:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1158">https://github.com/qt4cg/qtspecs/issues/1158</a></div><p>Simple mapping operator for arrays</p></div>
<div class="toot" id="created-1319"><h2>Issue #1319 created<span class="toot-id"> #created-1319</span></h2><div class="pubdate">09 Jul at 16:20:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1319">https://github.com/qt4cg/qtspecs/issues/1319</a></div><details><summary>Specification Documents: Editors and Contributors</summary><div class="markup"><p>I have noticed that the headers of the specification documents of previous versions of the languages contain more than one editor. In some EXPath documents, both editors and contributors are listed (with editors doing the majority of the work).</p>
<p>As various people have now been contributing to the new specifications and the documents for the last months and years already, would it make sense (and would it match with the current W3 conventions) to name more than one person in the header? In either case, it should certainly made clear that Michael Kay has contributed the very vast majority of the contents.</p>
</div></details></div>
<div class="toot" id="closed-1306"><h2>Issue #1306 closed<span class="toot-id"> #closed-1306</span></h2><div class="pubdate">09 Jul at 16:15:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1306">https://github.com/qt4cg/qtspecs/pull/1306</a></div><p>46 Add @as attribute to xsl:sequence</p></div>
<div class="toot" id="closed-1262"><h2>Issue #1262 closed<span class="toot-id"> #closed-1262</span></h2><div class="pubdate">09 Jul at 16:12:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1262">https://github.com/qt4cg/qtspecs/pull/1262</a></div><p>1160 Add collation-available() function</p></div>
<div class="toot" id="closed-1311"><h2>Issue #1311 closed<span class="toot-id"> #closed-1311</span></h2><div class="pubdate">09 Jul at 16:08:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1311">https://github.com/qt4cg/qtspecs/issues/1311</a></div><p>Tokenization and element constructors</p></div>
<div class="toot" id="closed-1313"><h2>Issue #1313 closed<span class="toot-id"> #closed-1313</span></h2><div class="pubdate">09 Jul at 16:08:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1313">https://github.com/qt4cg/qtspecs/pull/1313</a></div><p>1311 Tokenizing after &lt;</p></div>
<div class="toot" id="closed-566"><h2>Issue #566 closed<span class="toot-id"> #closed-566</span></h2><div class="pubdate">09 Jul at 15:03:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/566">https://github.com/qt4cg/qtspecs/issues/566</a></div><p>fn:parse-uri, fn:build-uri: Feedback</p></div>
<div class="toot" id="created-1318"><h2>Issue #1318 created<span class="toot-id"> #created-1318</span></h2><div class="pubdate">09 Jul at 08:30:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1318">https://github.com/qt4cg/qtspecs/issues/1318</a></div><details><summary>Function Coercion: Drop Record Tests?</summary><div class="markup"><p>I like to question the coercion rule that encompasses record tests:</p>
<blockquote>
<ol start="6">
<li>If <em>R</em> is a <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#doc-xquery40-RecordTest">RecordTest</a> and <em>J</em> is a map, then J is converted to a new map as follows:</li>
</ol>
</blockquote>
<blockquote>
<ul>
<li>The keys in the supplied map are unchanged.</li>
</ul>
</blockquote>
<blockquote>
<ul>
<li>In any map entry whose key is an <code>xs:string</code> equal to the name of one of the field declarations in R, the corresponding value is converted to the required type defined by that field declaration, by applying the coercion rules recursively (but with XPath 1.0 compatibility mode treated as false).</li>
</ul>
</blockquote>
<p>I would like us to drop this rule. I believe that both the instance checks and the conversions of large maps can get very expensive. In addition, it may even require recursive rebuilds of map structures if a supplied record test includes nested record tests.</p>
<p>I think it’s completely fair to expect users to deliver maps in a way that matches record definitions, and it could even be counterintuitive if map updates take place as a consequence of a simple function call.</p>
<p>If we want to stick to that coercion rule, we should also define coercion rules for maps and arrays.</p>
</div></details></div>
<div class="toot" id="created-1317"><h2>Issue #1317 created<span class="toot-id"> #created-1317</span></h2><div class="pubdate">08 Jul at 11:18:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1317">https://github.com/qt4cg/qtspecs/issues/1317</a></div><details><summary>Record Test Subtype Relationship</summary><div class="markup"><p>For a subtype relationship between record tests, <code>A ⊆ B</code>, I am trying to understand the impact of the extensibility of <code>A</code>, where <code>B</code> is extensible, but I can't spot any.</p>
<p>The cases of extensible and non-extensible <code>A</code> are distinguished in <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#id-item-subtype-records">3.3.2.10 Record Tests</a>, points 5 and 6. The only difference between those, apart from <code>A</code>'s extensibility, is the first one saying</p>
<blockquote>
<p>For every field that is declared in B but not in A, the declared type in B is item()*.</p>
</blockquote>
<p>while the second one has</p>
<blockquote>
<p>Every field that is declared in B with a type other than item()* is also declared in A.</p>
</blockquote>
<p>So the first one asks for a type of <code>item(*)</code> when a declaration is missing, and the second one allows a missing declaration only for a type of <code>item(*)</code>. How can that not be the same?</p>
</div></details></div>
<div class="toot" id="agenda-07-09"><h2>QT4 CG meeting 085 draft agenda<span class="toot-id"> #agenda-07-09</span></h2><div class="pubdate">08 Jul at 10:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/07-09">https://qt4cg.org/meeting/agenda/2024/07-09</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1316"><h2>Issue #1316 created<span class="toot-id"> #created-1316</span></h2><div class="pubdate">06 Jul at 14:49:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1316">https://github.com/qt4cg/qtspecs/issues/1316</a></div><details><summary>XPath: type declarations in quantified expressions</summary><div class="markup"><p>We have added type declarations to XPath "for" and "let" expressions, but not to "some" and "every", where they remain XQuery-only. This seems a needless inconsistency.</p>
</div></details></div>
<div class="toot" id="created-1315"><h2>Issue #1315 created<span class="toot-id"> #created-1315</span></h2><div class="pubdate">04 Jul at 13:29:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1315">https://github.com/qt4cg/qtspecs/issues/1315</a></div><details><summary>12 div-3</summary><div class="markup"><p>Revisiting an old issue here: should <code>12 div-3</code> parse?</p>
<p>Under the new 4.0 tokenization rules, it certainly doesn't.</p>
<p>But under Michael Dyck's interpretation of the 3.1 rules, it does parse; and accordingly we made it parse in Saxon: see https://saxonica.plan.io/issues/2715 .</p>
<p>Michael D's reasoning is at</p>
<p>https://lists.w3.org/Archives/Public/public-xsl-query/2016Mar/0037.html</p>
<p>He argued that the the longest token "consistent with the EBNF" is <code>div</code> (because <code>div-3</code> is not consistent with the EBNF), and that the rule requiring a space between an NCName and a hyphen does not apply because <code>div</code> in this context is a keyword, not an NCName.</p>
<p>Specifically, in existing XPath processors, does it parse?</p>
<p>I'm going to defend the new rules in 4.0 here, in which tokenization is independent of syntactic context. I think that's a much clearer definition. But in the interests of full disclosure, the CG might like to note that this may be incompatible with the way some people have interpreted the 3.1 rules</p>
<p>Incidentally, removing the tweak that makes Saxon able to parse <code>12 div-3</code> doesn't break any test cases.</p>
</div></details></div>
<div class="toot" id="minutes-07-02"><h2>QT4 CG meeting 084 draft minutes<span class="toot-id"> #minutes-07-02</span></h2><div class="pubdate">02 Jul at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/07-02">https://qt4cg.org/meeting/minutes/2024/07-02</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-729"><h2>Issue #729 closed<span class="toot-id"> #closed-729</span></h2><div class="pubdate">02 Jul at 16:09:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/729">https://github.com/qt4cg/qtspecs/issues/729</a></div><p>xsi:schemaLocation</p></div>
<div class="toot" id="closed-1254"><h2>Issue #1254 closed<span class="toot-id"> #closed-1254</span></h2><div class="pubdate">02 Jul at 16:09:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1254">https://github.com/qt4cg/qtspecs/pull/1254</a></div><p>729 Add rules for use of xsi:schemaLocation during validation</p></div>
<div class="toot" id="closed-1161"><h2>Issue #1161 closed<span class="toot-id"> #closed-1161</span></h2><div class="pubdate">02 Jul at 16:07:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1161">https://github.com/qt4cg/qtspecs/issues/1161</a></div><p>More changes to drop the requirement for document-uri() uniqueness</p></div>
<div class="toot" id="closed-1265"><h2>Issue #1265 closed<span class="toot-id"> #closed-1265</span></h2><div class="pubdate">02 Jul at 16:07:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1265">https://github.com/qt4cg/qtspecs/pull/1265</a></div><p>1161 Further revision of document-uri constraints</p></div>
<div class="toot" id="closed-1289"><h2>Issue #1289 closed<span class="toot-id"> #closed-1289</span></h2><div class="pubdate">02 Jul at 16:05:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1289">https://github.com/qt4cg/qtspecs/issues/1289</a></div><p>Delete XQuery Appendix J</p></div>
<div class="toot" id="closed-1293"><h2>Issue #1293 closed<span class="toot-id"> #closed-1293</span></h2><div class="pubdate">02 Jul at 16:05:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1293">https://github.com/qt4cg/qtspecs/pull/1293</a></div><p>1289 Delete XQuery Appendix J</p></div>
<div class="toot" id="created-1314"><h2>Issue #1314 created<span class="toot-id"> #created-1314</span></h2><div class="pubdate">01 Jul at 16:39:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1314">https://github.com/qt4cg/qtspecs/issues/1314</a></div><details><summary>Ambiguity in XPath EBNF - Lookup with TypeQualifier vs DynamicFunctionCall</summary><div class="markup"><p>Additional to https://github.com/qt4cg/qtspecs/issues/1050
An additional ambiguity occurs in one of the deep lookup examples:</p>
<pre><code>$tree ??$from ??type(record(to, distance))[?to=$to] ?distance
</code></pre>
<p>which can be simplified to</p>
<pre><code>$tree ??type(foo)
</code></pre>
<p>where there is ambiguity between a <code>LookupExpr</code> with <code>TypeQualifier</code> and a <code>DynamicFunctionCall</code> on a function named <code>type</code>. That is, <code>type</code> should perhaps be one of the restrictions on function name to avoid this ambiguity.</p>
<p>Whether something more fundamental is needed on the productions around [74],[75] and [84]-[88] I'm not sure, but certainly <code>type</code> can appear either as a keyword for <code>TypeQualifier</code> (consuming the bracketed type) or a value of an <code>NCName</code> (with the bracketed section being a higher-level <code>PositionalArgumentList</code>), both being part of a<code> KeySpecifier</code>.</p>
</div></details></div>
<div class="toot" id="created-1313"><h2>Pull request #1313 created<span class="toot-id"> #created-1313</span></h2><div class="pubdate">01 Jul at 15:59:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1313">https://github.com/qt4cg/qtspecs/pull/1313</a></div><details><summary>1311 Tokenizing after &lt;</summary><div class="markup"><p>Fix #1311</p>
<p>Defines precise rules for tokenization in the presence of direct element and PI constructors.</p>
<p>I chose to make the rules independent of the syntactic context.</p>
</div></details></div>
<div class="toot" id="created-1312"><h2>Issue #1312 created<span class="toot-id"> #created-1312</span></h2><div class="pubdate">01 Jul at 07:24:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1312">https://github.com/qt4cg/qtspecs/issues/1312</a></div><details><summary>Productions missing ws:explicit</summary><div class="markup"><p>Some lexical productions including</p>
<p>Digits, DecDigit, HexDigits,  HexDigit, BinaryDigits, BinaryDigit</p>
<p>are missing the ws:explicit annotation</p>
</div></details></div>
<div class="toot" id="created-1311"><h2>Issue #1311 created<span class="toot-id"> #created-1311</span></h2><div class="pubdate">30 Jun at 22:02:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1311">https://github.com/qt4cg/qtspecs/issues/1311</a></div><details><summary>Tokenization and element constructors</summary><div class="markup"><p>The new rules in Appendix A.3 on tokenization are, I believe, a great improvement on what went before. But I think there is one thing missing: they claim that the rules allow you to identify boundaries between tokens unambiguously independently of the syntactic context, but in the case of a token starting with <code>&lt;</code>, this isn't true: to distinguish whether <code>&lt;</code> represents a less-than-operator (or <code>&lt;=</code> operator) or whether it is the start of an element constructor, you need some context information.</p>
<p>Saxon's tokenization is still based on the principles outlined in the XPath 1.0 spec where tokens are disambiguated based on the immediately preceding and following tokens; this is becoming increasingly unviable. Most cases can be handled instead by moving the disambiguation into the parser rather than the tokenizer, but this relies on being able to find token boundaries without knowledge of context (as described in the 4.0 spec), which appears to be possible in all cases except <code>&lt;</code>.</p>
<p>Essentially we need to add an exception to the rule: <em>"If the current position is not the end of the input, then return the longest [literal terminal]( or [variable terminal] that can be matched starting at the current position..."</em></p>
<p>I think the exception might be formulated as follows:</p>
<p><em>In XQuery, when the next character is <code>&lt;</code> and this is immediately followed by an NCNameStart character (for example <code>X</code>) the next token could be either a less than operator, or a DirElemConstructor. The "longest terminal" rule cannot reliably distinguish these cases. Instead, the decision must take into account the syntactic context. A DirElemConstructor can only appear where the parser is expecting to read an expression, while the less-than operator can never appear where the parser is expecting an expression. This aspect of the syntactic context therefore needs to be communicated from the parser to the tokenizer.</em></p>
<p>Alternatively, the two cases might be distinguished by backtracking. The tokenizer could attempt to interpret the text following the <code>&lt;</code> character as a DirElemConstructor, and revert to the alternative interpretation if this fails.</p>
<p>Note: this was not explained clearly in 3.1. Perhaps it was covered by the quixotic phrase "the longest token consistent with the EBNF".</p>
</div></details></div>
<div class="toot" id="created-1310"><h2>Issue #1310 created<span class="toot-id"> #created-1310</span></h2><div class="pubdate">30 Jun at 02:38:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1310">https://github.com/qt4cg/qtspecs/issues/1310</a></div><p>add fn:match-groups() function</p></div>
<div class="toot" id="created-1309"><h2>Issue #1309 created<span class="toot-id"> #created-1309</span></h2><div class="pubdate">27 Jun at 19:53:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1309">https://github.com/qt4cg/qtspecs/issues/1309</a></div><details><summary>Dangling else syntax ambiguity</summary><div class="markup"><p>I think this is ambiguous, or at any rate, involves arbitrary lookahead:</p>
<p><code>if (a = b) then if (c = d) {23} else {}</code></p>
<p>You only get a successful parse if you associate the "else" with the first "if", but you can't do that until you know that there isn't going to be a second "else".</p>
<p>Again, it's the fact that an expression can now begin with a left curly brace that's the culprit.</p>
</div></details></div>
<div class="toot" id="created-1308"><h2>Issue #1308 created<span class="toot-id"> #created-1308</span></h2><div class="pubdate">27 Jun at 16:41:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1308">https://github.com/qt4cg/qtspecs/issues/1308</a></div><details><summary>fn:apply argument names</summary><div class="markup"><p>The narrative of fn:apply repeatedly refers to <code>$array</code> where <code>$arguments</code> is intended.</p>
</div></details></div>
<div class="toot" id="closed-1303"><h2>Issue #1303 closed<span class="toot-id"> #closed-1303</span></h2><div class="pubdate">27 Jun at 13:54:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1303">https://github.com/qt4cg/qtspecs/pull/1303</a></div><p>Recognize 'fn' as well as 'function' in signatures</p></div>
<div class="toot" id="created-1307"><h2>Issue #1307 created<span class="toot-id"> #created-1307</span></h2><div class="pubdate">27 Jun at 07:54:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1307">https://github.com/qt4cg/qtspecs/issues/1307</a></div><details><summary>For symmetry, add functions array:scan-left and array:scan-right</summary><div class="markup"><p>The fold-left and fold-right functions are defined both for sequences and arrays; symmetry demands that the same should apply to scan-left and scan-right.</p>
</div></details></div></div><p>See 2619
            more statuses in yearly archives.</p></article></main></body></html>