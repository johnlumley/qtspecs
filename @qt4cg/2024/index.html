<!DOCTYPE HTML><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta charset="UTF-8"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1"><link rel="stylesheet" href="/css/status.css"><title>@qt4cg statuses in 2024</title></head><body><main><article><h1>@qt4cg statuses in 2024</h1><p>This page displays status
              updates
              about the QT4 CG project from 2024.</p><p>See also <a href="../">recent statuses</a>.</p><div class="toots">
<div class="toot" id="minutes-05-21"><h2>QT4 CG meeting 078 draft minutes<span class="toot-id"> #minutes-05-21</span></h2><div class="pubdate">21 May at 18:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/05-21">https://qt4cg.org/meeting/minutes/2024/05-21</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1229"><h2>Issue #1229 closed<span class="toot-id"> #closed-1229</span></h2><div class="pubdate">21 May at 16:57:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1229">https://github.com/qt4cg/qtspecs/pull/1229</a></div><p>Rework record descriptions per ACTION QT4CG-070-01</p></div>
<div class="toot" id="closed-1211"><h2>Issue #1211 closed<span class="toot-id"> #closed-1211</span></h2><div class="pubdate">21 May at 16:36:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1211">https://github.com/qt4cg/qtspecs/pull/1211</a></div><p>QT4CG-076-01 Add examples of coercions</p></div>
<div class="toot" id="closed-1208"><h2>Issue #1208 closed<span class="toot-id"> #closed-1208</span></h2><div class="pubdate">21 May at 16:33:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1208">https://github.com/qt4cg/qtspecs/issues/1208</a></div><p>Reserved Function Names: item, empty-sequence</p></div>
<div class="toot" id="closed-1212"><h2>Issue #1212 closed<span class="toot-id"> #closed-1212</span></h2><div class="pubdate">21 May at 16:33:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1212">https://github.com/qt4cg/qtspecs/pull/1212</a></div><p>1208 correct details of formerly-reserved function names</p></div>
<div class="toot" id="closed-1213"><h2>Issue #1213 closed<span class="toot-id"> #closed-1213</span></h2><div class="pubdate">21 May at 16:30:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1213">https://github.com/qt4cg/qtspecs/pull/1213</a></div><p>1199 Add ellipsis markup for arguments in variadic functions</p></div>
<div class="toot" id="closed-1199"><h2>Issue #1199 closed<span class="toot-id"> #closed-1199</span></h2><div class="pubdate">21 May at 16:30:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1199">https://github.com/qt4cg/qtspecs/issues/1199</a></div><p>In F+O function signatures, show some indication that a function is variadic.</p></div>
<div class="toot" id="closed-1207"><h2>Issue #1207 closed<span class="toot-id"> #closed-1207</span></h2><div class="pubdate">21 May at 16:27:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1207">https://github.com/qt4cg/qtspecs/issues/1207</a></div><p>Array filter: Positional access</p></div>
<div class="toot" id="closed-1217"><h2>Issue #1217 closed<span class="toot-id"> #closed-1217</span></h2><div class="pubdate">21 May at 16:27:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1217">https://github.com/qt4cg/qtspecs/pull/1217</a></div><p>1207 Allow numeric predicates when filtering arrays</p></div>
<div class="toot" id="closed-1219"><h2>Issue #1219 closed<span class="toot-id"> #closed-1219</span></h2><div class="pubdate">21 May at 16:24:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1219">https://github.com/qt4cg/qtspecs/pull/1219</a></div><p>1218 Drop use of union(A,B) syntax</p></div>
<div class="toot" id="closed-1218"><h2>Issue #1218 closed<span class="toot-id"> #closed-1218</span></h2><div class="pubdate">21 May at 16:24:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1218">https://github.com/qt4cg/qtspecs/issues/1218</a></div><p>Residual references to union(A, B)</p></div>
<div class="toot" id="closed-934"><h2>Issue #934 closed<span class="toot-id"> #closed-934</span></h2><div class="pubdate">21 May at 16:20:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/934">https://github.com/qt4cg/qtspecs/issues/934</a></div><p>String comparison in deep-equal</p></div>
<div class="toot" id="closed-1167"><h2>Issue #1167 closed<span class="toot-id"> #closed-1167</span></h2><div class="pubdate">21 May at 16:20:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1167">https://github.com/qt4cg/qtspecs/issues/1167</a></div><p>Merge $collation into $options parameter of fn:deep-equal()</p></div>
<div class="toot" id="closed-1191"><h2>Issue #1191 closed<span class="toot-id"> #closed-1191</span></h2><div class="pubdate">21 May at 16:20:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1191">https://github.com/qt4cg/qtspecs/pull/1191</a></div><p>1167, 934 deep equal merge collations param</p></div>
<div class="toot" id="closed-1197"><h2>Issue #1197 closed<span class="toot-id"> #closed-1197</span></h2><div class="pubdate">21 May at 16:18:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1197">https://github.com/qt4cg/qtspecs/pull/1197</a></div><p>1192 Allow fn as abbreviation for function</p></div>
<div class="toot" id="closed-1116"><h2>Issue #1116 closed<span class="toot-id"> #closed-1116</span></h2><div class="pubdate">21 May at 16:15:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1116">https://github.com/qt4cg/qtspecs/issues/1116</a></div><p>unparsed-text() end-of-line normalization</p></div>
<div class="toot" id="closed-1117"><h2>Issue #1117 closed<span class="toot-id"> #closed-1117</span></h2><div class="pubdate">21 May at 16:15:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1117">https://github.com/qt4cg/qtspecs/pull/1117</a></div><p>1116 Add options param to unparsed-text</p></div>
<div class="toot" id="closed-1223"><h2>Issue #1223 closed<span class="toot-id"> #closed-1223</span></h2><div class="pubdate">21 May at 16:11:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1223">https://github.com/qt4cg/qtspecs/pull/1223</a></div><p>Minor: fixed URL</p></div>
<div class="toot" id="closed-1222"><h2>Issue #1222 closed<span class="toot-id"> #closed-1222</span></h2><div class="pubdate">21 May at 16:09:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1222">https://github.com/qt4cg/qtspecs/pull/1222</a></div><p>1214 hash examples</p></div>
<div class="toot" id="closed-116"><h2>Issue #116 closed<span class="toot-id"> #closed-116</span></h2><div class="pubdate">21 May at 16:07:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/116">https://github.com/qt4cg/qtspecs/issues/116</a></div><p>Clarify the fn:transform function() wrt multiple top-level elements</p></div>
<div class="toot" id="closed-652"><h2>Issue #652 closed<span class="toot-id"> #closed-652</span></h2><div class="pubdate">21 May at 16:07:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/652">https://github.com/qt4cg/qtspecs/issues/652</a></div><p>Defining a common function library for XPath, XSLT, and XQuery applications</p></div>
<div class="toot" id="closed-1220"><h2>Issue #1220 closed<span class="toot-id"> #closed-1220</span></h2><div class="pubdate">21 May at 16:05:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1220">https://github.com/qt4cg/qtspecs/pull/1220</a></div><p>73 copy&amp;paste typo in fn:graphemes (combining diaeresis should be ZWJ)</p></div>
<div class="toot" id="created-1231"><h2>Pull request #1231 created<span class="toot-id"> #created-1231</span></h2><div class="pubdate">21 May at 12:19:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1231">https://github.com/qt4cg/qtspecs/pull/1231</a></div><details><summary>1193 Parsing Functions: Empty input</summary><div class="markup"><p>Issue: #1193 (covers only the obvious 4.0 inconsistencies)</p>
</div></details></div>
<div class="toot" id="created-1230"><h2>Pull request #1230 created<span class="toot-id"> #created-1230</span></h2><div class="pubdate">21 May at 11:38:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1230">https://github.com/qt4cg/qtspecs/pull/1230</a></div><details><summary>1216 Detailed comments on math:e, sinh(), cosh(), tanh()</summary><div class="markup"><p>Issue: #1216</p>
</div></details></div>
<div class="toot" id="created-1229"><h2>Pull request #1229 created<span class="toot-id"> #created-1229</span></h2><div class="pubdate">20 May at 16:46:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1229">https://github.com/qt4cg/qtspecs/pull/1229</a></div><details><summary>Rework record descriptions per ACTION QT4CG-070-01</summary><div class="markup"><p>I think this PR completes the work I started before and that we reviewed briefly some time ago.</p>
<p>Note: because this PR involves changes to the schemas and the stylesheets, the PR build is going to be...funky. I don't know if the diffs will be useful either. There are no (intentional) technical changes in this PR. You can preview the built result by look at https://qt4cgtest.nwalsh.com/branch/action-qt4cg-70-01/xpath-functions-40/Overview.html</p>
<p>A few notes:</p>
<ol>
<li>Instead of just reusing <code>fos:options</code>, I added <code>fos:record-description</code> with a very similar content model.</li>
<li>I couldn't completely remove some of the <code>&lt;fos:type&gt;</code> elements defined in the globals section at the top of the <code>function-catalog.xml</code> because it causes IDREF failures when that file is parsed.</li>
<li>I tinkered a bit with the styling, and moved a bunch of inline table styles into CSS</li>
</ol>
</div></details></div>
<div class="toot" id="agenda-05-21"><h2>QT4 CG meeting 078 draft agenda<span class="toot-id"> #agenda-05-21</span></h2><div class="pubdate">20 May at 11:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/05-21">https://qt4cg.org/meeting/agenda/2024/05-21</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-1221"><h2>Issue #1221 closed<span class="toot-id"> #closed-1221</span></h2><div class="pubdate">19 May at 20:07:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1221">https://github.com/qt4cg/qtspecs/issues/1221</a></div><p>new function - fn:tail-recurse a function to allow users to hand roll their recursion and guarentee tail recursion.</p></div>
<div class="toot" id="created-1228"><h2>Pull request #1228 created<span class="toot-id"> #created-1228</span></h2><div class="pubdate">19 May at 17:56:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1228">https://github.com/qt4cg/qtspecs/pull/1228</a></div><details><summary>– Adding the BLAKE3 hashing algorithm to fn:hash</summary><div class="markup"><p>This is a resubmission of the original https://github.com/qt4cg/qtspecs/pull/1226.
No new changes, this is fixing a pure git-technical issue.</p>
<p>Now the PR is submitted from a dedicated feature-branch and does not depend on any other branch</p>
</div></details></div>
<div class="toot" id="created-1227"><h2>Pull request #1227 created<span class="toot-id"> #created-1227</span></h2><div class="pubdate">19 May at 17:47:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1227">https://github.com/qt4cg/qtspecs/pull/1227</a></div><details><summary>150 PR resubmission for fn ranks</summary><div class="markup"><p>This is a resubmission of the original <a href="https://github.com/qt4cg/qtspecs/pull/1027">PR 1027 for function fn:ranks</a>.
No new changes, this is fixing a pure git-technical issue.</p>
<p>Now the PR is submitted from a dedicated feature-branch and not from <em>master</em></p>
</div></details></div>
<div class="toot" id="closed-1226"><h2>Issue #1226 closed<span class="toot-id"> #closed-1226</span></h2><div class="pubdate">19 May at 17:05:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1226">https://github.com/qt4cg/qtspecs/pull/1226</a></div><p>Add the BLAKE3 hashing algorithm to fn:hash</p></div>
<div class="toot" id="closed-1027"><h2>Issue #1027 closed<span class="toot-id"> #closed-1027</span></h2><div class="pubdate">19 May at 17:02:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1027">https://github.com/qt4cg/qtspecs/pull/1027</a></div><p>150 fn:ranks</p></div>
<div class="toot" id="created-1226"><h2>Pull request #1226 created<span class="toot-id"> #created-1226</span></h2><div class="pubdate">18 May at 22:33:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1226">https://github.com/qt4cg/qtspecs/pull/1226</a></div><details><summary>Add the BLAKE3 hashing algorithm to fn:hash</summary><div class="markup"><p>This PR adds the <strong>BLAKE3</strong> hashing algorithm as one of the hashing algorithms in <strong><code>fn:hash</code></strong></p>
<p>This comes from a different branch than the one that contains the PR for <strong><code>fn:ranks</code></strong>, thus both PRs must be active and independent of each other.</p>
</div></details></div>
<div class="toot" id="created-1225"><h2>Issue #1225 created<span class="toot-id"> #created-1225</span></h2><div class="pubdate">18 May at 08:33:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1225">https://github.com/qt4cg/qtspecs/issues/1225</a></div><details><summary>Generalization of Deep Updates</summary><div class="markup"><p><strong>Note:</strong> This is a discussion issue, as I cannot contribute something substantial so far.</p>
<h3>Observations</h3>
<p>Our current development to support updates in the languages may come as a surprise to developers:</p>
<ul>
<li>The XQuery core specification (which includes <strong>X</strong> in its name) will include constructs for updating <strong>Maps</strong> and <strong>Arrays</strong>.</li>
<li>To update <strong>XML</strong>, an implementation must support the XQuery Update (XQUF) specification.</li>
</ul>
<p>I think we should…</p>
<ol>
<li>either embed map/array updates in XQUF, or</li>
<li>support a modified subset of XQUF in our core specs (while remaining fully compatible with XQUF).</li>
</ol>
<p>I believe 2. is more realistic. By providing a simplified syntax, we could tackle some of the shortcomings of XQUF, such as its verbosity, and seemingly unnecessary restrictions:</p>
<h3>XQUF: Verbosity</h3>
<p>The <em>Transform</em> expression (or <em>Copy Modify</em> expression, as it’s called in 3.0) has a cumbersome and wordy syntax for doing very trivial things:</p>
<pre><code class="language-xquery">copy $node := &lt;a&gt;&lt;b/&gt;&lt;/a&gt;
modify delete node $node/b
return $node
</code></pre>
<p>The 3.0 <em>Transform With</em> syntax is a bit simpler, it utilizes the context item:</p>
<pre><code class="language-xquery">&lt;a&gt;&lt;b/&gt;&lt;/a&gt; transform with {
  delete node ./b
}
</code></pre>
<p>It resulted from the BaseX <code>update</code> syntax…</p>
<pre><code class="language-xquery">&lt;a&gt;&lt;b/&gt;&lt;/a&gt; update {
  delete node ./b
}
</code></pre>
<p>…which comes with an ambiguity that forbids its unchanged adoption: <code>element update {}</code> could be both an element constructor and an update statement. I think that dropping the curly braces (and, optionally, using parentheses) would resolve this issue.</p>
<h3>XQUF: Restrictions</h3>
<p>The XQUF syntax is very powerful, but it has some restrictions that require the use of FLWOR expressions when addressing multiple nodes. For example, the following statement is illegal…</p>
<pre><code class="language-xquery">replace //village with &lt;village/&gt;
</code></pre>
<p>…if the target is not a single node, which means that you have to write…</p>
<pre><code class="language-xquery">for $v in //village
return replace $v with &lt;village/&gt;
</code></pre>
<p>…or…</p>
<pre><code class="language-xquery">(: only supported in BaseX :)
//village ! (replace . with &lt;village/&gt;)
</code></pre>
<p>I’m pretty sure it would be safe to drop the restriction, which also exists for other update expressions, such as <code>insert nodes NODES into SINGLE-NODE</code> or <code>rename node NODE as 'NAME'</code> (<code>delete nodes NODES</code> is legal). Allowing multiple targets would greatly reduce the number of iterations required within update blocks in practice.</p>
<h3>XQuery Update <em>light</em></h3>
<p>I think the new update syntax should meet the following requirements (among others):</p>
<ul>
<li>Compatible with the XQUF node semantics.</li>
<li>Similar syntax for supported input types.</li>
<li>Chaining of update operations.</li>
</ul>
<p>First, we would need to decide on a syntax that would be applicable to both maps/arrays and nodes. We could:</p>
<ol>
<li>Build on the proposal in <a href="https://github.com/qt4cg/qtspecs/pull/832">#832</a>, which introduces a new syntax for maps and arrays, and  extend it for nodes:</li>
</ol>
<pre><code class="language-xquery">update map   INPUT-MAP   { ... }
update array INPUT-ARRAY { ... }
update node  INPUT-NODE  { ... }
</code></pre>
<ol start="2">
<li>Build on XQUF 3.0:</li>
</ol>
<pre><code class="language-xquery">INPUT-MAP   transform with { ... }
INPUT-ARRAY transform with { ... }
INPUT-NODE  transform with { ... }
</code></pre>
<ol start="3">
<li>Build on BaseX (allowing multiple input items and chains):</li>
</ol>
<pre><code class="language-xquery">INPUT-MAPS   update (...) update (...)
INPUT-ARRAYS update (...) update (...)
INPUT-NODES  update (...) update (...)
</code></pre>
<p>Syntax 2. and 3. is challenging, as the type of the input can only be evaluated at time (and for XQUF it has to be determined statically whether an expression is an updating or non-updating).</p>
<p>As we currently have a proposal for 1., I will stick to that syntax, but allow an optional plural form for <code>map</code> and <code>array</code> (inspired by XQUF), and use chains. Within the the update block, we could now use the short syntax also for nodes without the <code>node</code>/<code>nodes</code> keywords:</p>
<pre><code class="language-xquery">update map $country-map {
  delete ??entry:city
},
update maps $country-maps update {
  rename ?entry:village as 'city'
},

update node $country-node {
  delete //city
},
update nodes $country-nodes {
  insert &lt;lakes/&gt; into .,
  insert &lt;mountains/&gt; into .
} {
  insert &lt;lake/&gt; into //lakes
)
</code></pre>
<h3>Semantics</h3>
<ul>
<li>Note that for XQUF update expressions it makes a difference whether multiple expressions are defined with the same block or in a subsequent block – which is why I think chains are essential.</li>
<li>Even though the syntax would be similar for node and map/array updates, the inherent semantics would differ a lot – which is something, however, users would not need to care about too much: Node updates would greatly rely on XQUF, whereas map/array updates would be based on the new proposal.</li>
</ul>
<p>I’m looking forward to everyone’s opinions.</p>
</div></details></div>
<div class="toot" id="created-1224"><h2>Issue #1224 created<span class="toot-id"> #created-1224</span></h2><div class="pubdate">18 May at 02:27:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1224">https://github.com/qt4cg/qtspecs/issues/1224</a></div><details><summary>Attribute priority for xsl:accumulator-rule</summary><div class="markup"><p>I propose that XSLT <code>xsl:accumulator-rule</code> be allowed to take attribute <code>priority</code>, to allow users to be more declarative in their accumulator rules. Even accumulators with two or three rules might require simple overshadowing: a default rule for the majority of nodes, with accommodation for certain exceptions. An explicitly declared priority rather than document order will allows users to better express their intentions, and processor-generated warnings about duplicate matches will be more meaningful.</p>
<p>Because the current rules stipulate that among multiple rules the last one in document order wins, I think that backward compatibility prevents us from using the default priority rules for templates (i.e., allotting -0.5, 0, 0.25 scores based on match pattern types). Rather, in this case, every accumulator rule is assumed to have priority 0, unless otherwise specified. If a node matches more than one rule of the same priority level, the last one wins. This simpler version of priority (assume zero, and if you know multiple matches will overlap, use <code>@priority</code>) is one that many developers have come to use for templates.</p>
</div></details></div>
<div class="toot" id="closed-1188"><h2>Issue #1188 closed<span class="toot-id"> #closed-1188</span></h2><div class="pubdate">18 May at 01:40:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1188">https://github.com/qt4cg/qtspecs/issues/1188</a></div><p>fn:hash: Editorial</p></div>
<div class="toot" id="created-1223"><h2>Pull request #1223 created<span class="toot-id"> #created-1223</span></h2><div class="pubdate">18 May at 01:38:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1223">https://github.com/qt4cg/qtspecs/pull/1223</a></div><details><summary>Minor: fixed URL</summary><div class="markup"><p>Fixes link to Unicode TR29</p>
</div></details></div>
<div class="toot" id="created-1222"><h2>Pull request #1222 created<span class="toot-id"> #created-1222</span></h2><div class="pubdate">18 May at 01:31:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1222">https://github.com/qt4cg/qtspecs/pull/1222</a></div><details><summary>1214 hash examples</summary><div class="markup"><p>addresses #1214</p>
</div></details></div>
<div class="toot" id="created-1221"><h2>Issue #1221 created<span class="toot-id"> #created-1221</span></h2><div class="pubdate">17 May at 13:40:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1221">https://github.com/qt4cg/qtspecs/issues/1221</a></div><details><summary>new function - fn:tail-recurse a function to allow users to hand roll their recursion and guarentee tail recursion.</summary><div class="markup"><p>Motivation:</p>
<ul>
<li>I as a user of XPath want to write a recursive function.</li>
<li>I write the function,</li>
<li>I run it,</li>
<li>it causes a stack overflow</li>
</ul>
<p>So,</p>
<ul>
<li>I don't believe tail recursion detection is part of the spec thus an implementation may not implement it</li>
<li>tail recursion detection I suspect is hard, and I suspect there are cases that are tail recursion that an implementation doesnt  detect</li>
</ul>
<p>Tail recursion is not an uncommon problem in other languages, in imperative languages I would simply implement the algorithm using a 'while' loop, creating the 'body' of the while loop is my problem, but once I've done it, I KNOW that in all implementations my algorithm will be executed tail recursively (imperative code is FULL of loops, stack overloads are not an issue).</p>
<p>An example</p>
<p>I want to implement a power function in C# I know how to write it recursively, but C# doesn't support tail recursion, so I have to turn it into a loop. I could do this in an ad hoc way using a while loop, but I could also write the loop once, and then ask the developer to pass in a function that defines the body of the loop</p>
<p>in C# that function could have the type (i.e. it takes a state and either returns a new state or null, a null would indicte the end of the 'loop')</p>
<p><code>State? recurse(State state)</code></p>
<p>and the library function that executes it have the signature:</p>
<p><code>State TailRecurse&lt;State&gt;(Func&lt;State,State?&gt; f, State state) </code></p>
<p>a complete example of how this would appear in C# would be:
(note C# has a nuance w.r.t. the higher kinded type '?' and so the signature of TailRecurse below is slightly weaker than the one above).</p>
<pre><code>var toPower3 = TailRecursion.Power2(3);
var result = TailRecursion.TailRecurse(toPower3, (0, 2));

Console.WriteLine(result.Value.Item2);

class TailRecursion
{
    // actually we want, but because of a quirk in C# around the '?' higher kinded type we have to write the signature symetrically (I think).
    //public static State TailRecurse&lt;State&gt;(Func&lt;State, State?&gt; f, State state)
    public static State TailRecurse&lt;State&gt;(Func&lt;State?,State?&gt; f, State state)
    {
        while (true)
        {
            var result = f(state);
            if (result == null)
            {
                return state;
            }
            state = result;
        }
    }

    public static Func&lt;(int,int)?,(int,int)?&gt; Power2(int n)
    {
        return powerAndX =&gt;
        {
            if (powerAndX.Value.Item1 &gt; n)
            {
                return null;
            }
            return (powerAndX.Value.Item1 + 1, powerAndX.Value.Item2 * powerAndX.Value.Item2);
        };
    }
}
</code></pre>
<p>in XSLT I could write this function</p>
<pre><code>&lt;xsl:function name="kooks:pow" as="xs:integer"&gt;
    &lt;xsl:param name="x" as ="xs:integer"/&gt;
    &lt;xsl:param name="n" as ="xs:integer"/&gt;
    &lt;xsl:choose&gt;
        &lt;xsl:when test="$n = 0"&gt;
            &lt;xsl:sequence select="$x"/&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
            &lt;xsl:sequence select="$x * kooks:pow($x,$n - 1)"/&gt;
        &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;
</code></pre>
<p>I know its tail recursive, but my environment may not for whatever reason detect it (I would hope it does, but I could be doing something much more complex, that IS tail recursive but the environment simply doesn't see it).</p>
<p>I can't write a loop in XPath etc, it doesnt exist, so I can't escape like I do in C# or scala, in F# (which also doesnt support while loops), I would have to write a function that I was sure F# detected as tail recursive and then path the 'body' of the while loop as a function.</p>
<p>in XSLT this could look like this (basically the same as the C# example)</p>
<p>here the C# signature
<code>State TailRecurse&lt;State&gt;(Func&lt;State,State?&gt; f, State state) </code>
has been translated by using <code>item()*</code> for state an <code>array(*)</code> for State?, where an empty array corresponds to null/none, and an array with 1 element corresponds to 'some' State.</p>
<p>This function IS tail recursive in a very simple way that I think all implementations would detect as such, and thus (if it does) I can pass any function I like and be confident it is processed tail recursively - I can of course do this now, I use saxon, (even though I'm wrestling with it to detect tail recursion for some bizarre reason which is probably my fault) I think it would ideally be a library function and (using a loop) allow non tail recursive environments to support tail recursion, or allow me to simply do the detection myself.</p>
<pre><code>    &lt;xsl:function name="kooks:tailRecurse"&gt;
        &lt;xsl:param name="unfolder" as="function(item()*) as array(*)"/&gt;
        &lt;xsl:param name="state" as="item()*"/&gt;
        &lt;xsl:variable name="newState" select="$unfolder($state)"/&gt;
        &lt;xsl:choose&gt;
            &lt;!-- loop returns null/none - end of recurstion --&gt;
            &lt;xsl:when test="array:size($newState) = 0"&gt;
                &lt;xsl:sequence select="$state"/&gt;
            &lt;/xsl:when&gt;
            &lt;!-- else, unpack the state and loop again --&gt;
            &lt;xsl:otherwise&gt;
                &lt;xsl:sequence select="kooks:tailRecurse($unfolder,array:get($newState,1))"/&gt;
            &lt;/xsl:otherwise&gt;
        &lt;/xsl:choose&gt;        
    &lt;/xsl:function&gt;

</code></pre>
<p>For environments that don't do tail recursion detection, they can simple implement the analogous code to the C# example in their implementation i.e. map it to a while loop.</p>
<p>In both cases I think this is hopefully trivial for the implementor of the language.</p>
<p>Here's a complete example, with tailRecurse defined as above, that would guarentee (in an environment that detected it correctly) that any passed function is processed.</p>
<pre><code>&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:array="http://www.w3.org/2005/xpath-functions/array"
    xmlns:map="http://www.w3.org/2005/xpath-functions/map"
    exclude-result-prefixes="xs"
    version="3.0"
    xmlns:kooks="http://www.kookerella.com"&gt;
    
    &lt;!-- (state -&gt; Maybe state) -&gt; state -&gt; state --&gt; 
    &lt;xsl:function name="kooks:tailRecurse"&gt;
        &lt;xsl:param name="unfolder" as="function(item()*) as array(*)"/&gt;
        &lt;xsl:param name="state" as="item()*"/&gt;
        &lt;xsl:variable name="newState" select="$unfolder($state)"/&gt;
        &lt;xsl:choose&gt;
            &lt;!-- loop returns null/none - end of recurstion --&gt;
            &lt;xsl:when test="array:size($newState) = 0"&gt;
                &lt;xsl:sequence select="$state"/&gt;
            &lt;/xsl:when&gt;
            &lt;!-- else, unpack the state and loop again --&gt;
            &lt;xsl:otherwise&gt;
                &lt;xsl:sequence select="kooks:tailRecurse($unfolder,array:get($newState,1))"/&gt;
            &lt;/xsl:otherwise&gt;
        &lt;/xsl:choose&gt;        
    &lt;/xsl:function&gt;
    
    &lt;xsl:function name="kooks:powUnfolder" as="function(item()*) as array(*)"&gt;
        &lt;xsl:param name="x" as="xs:integer"/&gt;
        &lt;xsl:param name="n" as="xs:integer"/&gt;
        &lt;xsl:sequence select="function($state) {
                if (map:get($state,'power') &gt;= $n)
                (: we're done so return null/none :)
                then array {}
                else
                (: else calculate the next power and loop again :)
                    let $newState := map { 
                        'power': map:get($state,'power') + 1,
                        'result': map:get($state,'result') * $x
                        }
                    return array { $newState }
            }"/&gt;
    &lt;/xsl:function&gt;
    
    &lt;xsl:template match="/"&gt;
        &lt;twoToThePower4&gt;
            &lt;xsl:variable name="seed" select="map { 'power':0,'result':1 }"/&gt;
            &lt;xsl:sequence select="map:get(kooks:tailRecurse(kooks:powUnfolder(2,4),$seed),'result')"/&gt;
        &lt;/twoToThePower4&gt;
    &lt;/xsl:template&gt;    
&lt;/xsl:stylesheet&gt;
</code></pre>
<p>I suspect these lines are not obvious.</p>
<pre><code>            &lt;xsl:variable name="seed" select="map { 'power':0,'result':1 }"/&gt;
            &lt;xsl:sequence select="map:get(kooks:tailRecurse(kooks:powUnfolder(2,4),$seed),'result')"/&gt;
</code></pre>
<p>The first line says anything to the power 0 is 1, the second line says, I want the 'result of 2 to the power 4.</p>
<p>Note its VERY similar to xsl:iterate, but that requires an sequence to drive it, this is just general recursion.</p>
</div></details></div>
<div class="toot" id="closed-73"><h2>Issue #73 closed<span class="toot-id"> #closed-73</span></h2><div class="pubdate">15 May at 11:12:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/73">https://github.com/qt4cg/qtspecs/issues/73</a></div><p>Split a string by graphemes</p></div>
<div class="toot" id="created-1220"><h2>Pull request #1220 created<span class="toot-id"> #created-1220</span></h2><div class="pubdate">15 May at 09:32:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1220">https://github.com/qt4cg/qtspecs/pull/1220</a></div><details><summary>73 copy&amp;paste typo in fn:graphemes (combining diaeresis should be ZWJ)</summary><div class="markup"><p>I wonder which font I need to use in order to see U+1F476 U+200D U+1F6D1 as a single grapheme. When I naively put the character sequence into an HTML page, the two glyphs will be rendered individually. How can we make sure that the grapheme will be rendered as intended for most people when they read the spec?</p>
</div></details></div>
<div class="toot" id="created-1219"><h2>Pull request #1219 created<span class="toot-id"> #created-1219</span></h2><div class="pubdate">14 May at 20:41:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1219">https://github.com/qt4cg/qtspecs/pull/1219</a></div><details><summary>1218 Drop use of union(A,B) syntax</summary><div class="markup"><p>Fix #1218</p>
</div></details></div>
<div class="toot" id="created-1218"><h2>Issue #1218 created<span class="toot-id"> #created-1218</span></h2><div class="pubdate">14 May at 20:18:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1218">https://github.com/qt4cg/qtspecs/issues/1218</a></div><details><summary>Residual references to union(A, B)</summary><div class="markup"><p>The XQuery spec has 10 uses of the obsolete syntax <code>union(A, B)</code>, and the F&amp;O spec has another 6. XSLT has 7, and XDM has two.</p>
</div></details></div>
<div class="toot" id="minutes-05-14"><h2>QT4 CG meeting 077 draft minutes<span class="toot-id"> #minutes-05-14</span></h2><div class="pubdate">14 May at 18:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/05-14">https://qt4cg.org/meeting/minutes/2024/05-14</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-1217"><h2>Pull request #1217 created<span class="toot-id"> #created-1217</span></h2><div class="pubdate">14 May at 17:58:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1217">https://github.com/qt4cg/qtspecs/pull/1217</a></div><details><summary>1207 Allow numeric predicates when filtering arrays</summary><div class="markup"><p>Fix #1207</p>
<p>Also a minor change: <code>$V[23, "fred"]</code> now throws FORG0006 rather than XPTY0004. This keeps it compatible with 3.1 (in case anyone is catching the errors), and is more uniform: it seems unreasonable for <code>$V[23, "fred"]</code> and <code>$V["fred", 23]</code> to throw different errors.</p>
</div></details></div>
<div class="toot" id="created-1216"><h2>Issue #1216 created<span class="toot-id"> #created-1216</span></h2><div class="pubdate">14 May at 16:37:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1216">https://github.com/qt4cg/qtspecs/issues/1216</a></div><details><summary>Detailed comments on math:e, sinh(), cosh(), tanh()</summary><div class="markup"><p>I should have made these comments before we accepted the proposal, but it's only minor details.</p>
<p>In the example given for <code>math:e</code>, the explanation of the example as a compound interest calculation seems a bit simplistic. There are all sorts of assumptions here about the initial investment, the frequency at which interest is calculated, etc. It might be better just to give the expression and the result and not attempt an interpretation.</p>
<p>According to IEEE 754-2008 table 9.1, <code>sinh()</code> can produce overflow or underflow, <code>cosh()</code> can produce overflow, and <code>tanh()</code> can produce underflow. We seem to be catering for exceptions that cannot occur?</p>
<p>The example results should perhaps be tagged as approximate to ensure that they pass automated testing.</p>
<p>We should perhaps be referencing IEEE 754-2019 (though I'm reluctant to purchase a copy...)</p>
</div></details></div>
<div class="toot" id="closed-1195"><h2>Issue #1195 closed<span class="toot-id"> #closed-1195</span></h2><div class="pubdate">14 May at 16:31:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1195">https://github.com/qt4cg/qtspecs/issues/1195</a></div><p>Hash Function: CRC-32</p></div>
<div class="toot" id="closed-1206"><h2>Issue #1206 closed<span class="toot-id"> #closed-1206</span></h2><div class="pubdate">14 May at 16:31:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1206">https://github.com/qt4cg/qtspecs/pull/1206</a></div><p>1195 Hash Function: CRC-32</p></div>
<div class="toot" id="closed-1196"><h2>Issue #1196 closed<span class="toot-id"> #closed-1196</span></h2><div class="pubdate">14 May at 16:28:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1196">https://github.com/qt4cg/qtspecs/issues/1196</a></div><p>Math Functions: `math:e`, `math:sinh`, `math:cosh`, `math:tanh`</p></div>
<div class="toot" id="closed-1205"><h2>Issue #1205 closed<span class="toot-id"> #closed-1205</span></h2><div class="pubdate">14 May at 16:28:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1205">https://github.com/qt4cg/qtspecs/pull/1205</a></div><p>1196 Math Functions: math:e, math:sinh, math:cosh, math:tanh</p></div>
<div class="toot" id="closed-1204"><h2>Issue #1204 closed<span class="toot-id"> #closed-1204</span></h2><div class="pubdate">14 May at 16:24:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1204">https://github.com/qt4cg/qtspecs/pull/1204</a></div><p>1203 Define out-of-range conditions in CSV get function</p></div>
<div class="toot" id="closed-1203"><h2>Issue #1203 closed<span class="toot-id"> #closed-1203</span></h2><div class="pubdate">14 May at 16:24:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1203">https://github.com/qt4cg/qtspecs/issues/1203</a></div><p>CSV parsing: in call of get($R, $Z), what if $R is out of range</p></div>
<div class="toot" id="closed-1215"><h2>Issue #1215 closed<span class="toot-id"> #closed-1215</span></h2><div class="pubdate">14 May at 16:24:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1215">https://github.com/qt4cg/qtspecs/pull/1215</a></div><p>Fix ID/IDREF typo</p></div>
<div class="toot" id="created-1215"><h2>Pull request #1215 created<span class="toot-id"> #created-1215</span></h2><div class="pubdate">14 May at 16:24:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1215">https://github.com/qt4cg/qtspecs/pull/1215</a></div><details><summary>Fix ID/IDREF typo</summary><div class="markup"><p>I'm not sure how this slipped past the PR build checks...</p>
</div></details></div>
<div class="toot" id="created-1214"><h2>Issue #1214 created<span class="toot-id"> #created-1214</span></h2><div class="pubdate">14 May at 16:21:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1214">https://github.com/qt4cg/qtspecs/issues/1214</a></div><details><summary>fn:hash, CRC-32: Describe output</summary><div class="markup"><p>In the <a href="https://qt4cg.org/meeting/minutes/2024/05-14.html">QT4 CG Meeting 077</a> it was suggested that the binary output of the newly added <code>CRC-32</code> algorithm should be further described.</p>
</div></details></div>
<div class="toot" id="closed-1198"><h2>Issue #1198 closed<span class="toot-id"> #closed-1198</span></h2><div class="pubdate">14 May at 16:17:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1198">https://github.com/qt4cg/qtspecs/pull/1198</a></div><p>1189 distinct document order</p></div>
<div class="toot" id="closed-1068"><h2>Issue #1068 closed<span class="toot-id"> #closed-1068</span></h2><div class="pubdate">14 May at 16:15:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1068">https://github.com/qt4cg/qtspecs/pull/1068</a></div><p>73 fn:graphemes</p></div>
<div class="toot" id="closed-1200"><h2>Issue #1200 closed<span class="toot-id"> #closed-1200</span></h2><div class="pubdate">14 May at 16:12:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1200">https://github.com/qt4cg/qtspecs/pull/1200</a></div><p>QT4CG-075-02 Define the term sequence concatenation</p></div>
<div class="toot" id="closed-146"><h2>Issue #146 closed<span class="toot-id"> #closed-146</span></h2><div class="pubdate">14 May at 16:09:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/146">https://github.com/qt4cg/qtspecs/issues/146</a></div><p>fn:apply with last two arguments (array, map) for the positional and keyword args in a func-call</p></div>
<div class="toot" id="closed-162"><h2>Issue #162 closed<span class="toot-id"> #closed-162</span></h2><div class="pubdate">14 May at 16:09:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/162">https://github.com/qt4cg/qtspecs/issues/162</a></div><p>Support unbounded variadic functions on map parameter keys</p></div>
<div class="toot" id="closed-369"><h2>Issue #369 closed<span class="toot-id"> #closed-369</span></h2><div class="pubdate">14 May at 16:08:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/369">https://github.com/qt4cg/qtspecs/issues/369</a></div><p>Namespaces for Functions</p></div>
<div class="toot" id="closed-572"><h2>Issue #572 closed<span class="toot-id"> #closed-572</span></h2><div class="pubdate">14 May at 16:08:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/572">https://github.com/qt4cg/qtspecs/issues/572</a></div><p>fn:evaluate-xpath() function</p></div>
<div class="toot" id="closed-1190"><h2>Issue #1190 closed<span class="toot-id"> #closed-1190</span></h2><div class="pubdate">14 May at 16:08:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1190">https://github.com/qt4cg/qtspecs/pull/1190</a></div><p>1188 XQFO hash</p></div>
<div class="toot" id="created-1213"><h2>Pull request #1213 created<span class="toot-id"> #created-1213</span></h2><div class="pubdate">14 May at 14:58:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1213">https://github.com/qt4cg/qtspecs/pull/1213</a></div><details><summary>1199 Add ellipsis markup for arguments in variadic functions</summary><div class="markup"><p>Fix #1199</p>
</div></details></div>
<div class="toot" id="closed-1210"><h2>Issue #1210 closed<span class="toot-id"> #closed-1210</span></h2><div class="pubdate">14 May at 14:37:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1210">https://github.com/qt4cg/qtspecs/issues/1210</a></div><p>An edge case with coercion in 1.0 compatibility mode</p></div>
<div class="toot" id="created-1212"><h2>Pull request #1212 created<span class="toot-id"> #created-1212</span></h2><div class="pubdate">14 May at 11:45:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1212">https://github.com/qt4cg/qtspecs/pull/1212</a></div><details><summary>1208 correct details of formerly-reserved function names</summary><div class="markup"><p>Fix #1208</p>
</div></details></div>
<div class="toot" id="created-1211"><h2>Pull request #1211 created<span class="toot-id"> #created-1211</span></h2><div class="pubdate">14 May at 10:38:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1211">https://github.com/qt4cg/qtspecs/pull/1211</a></div><details><summary>QT4CG-076-01 Add examples of coercions</summary><div class="markup"><p>Added examples of coercion rules in action, as requested.</p>
<p>Note to reviewers: the XPath spec contains addition paragraphs explaining the effect of the 1.0 compatibility rules.</p>
</div></details></div>
<div class="toot" id="created-1210"><h2>Issue #1210 created<span class="toot-id"> #created-1210</span></h2><div class="pubdate">13 May at 16:31:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1210">https://github.com/qt4cg/qtspecs/issues/1210</a></div><details><summary>An edge case with coercion in 1.0 compatibility mode</summary><div class="markup"><p>XPath 3.1 says</p>
<blockquote>
<p>In a static function call, if [XPath 1.0 compatibility mode] is true and an argument of a static function is not of the expected type, then the following conversions are applied sequentially to the argument value V:</p>
</blockquote>
<p>In 4.0, we have dropped the phrase <em>and [the supplied value] is not of the expected type</em>. One effect of this omission is that when the expected type is <code>xs:string?</code> and the supplied value is <code>()</code>, we now apply the <code>string()</code> function which means we supply <code>""</code> rather than <code>()</code> as the coerced value.</p>
</div></details></div>
<div class="toot" id="created-1209"><h2>Pull request #1209 created<span class="toot-id"> #created-1209</span></h2><div class="pubdate">13 May at 14:49:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1209">https://github.com/qt4cg/qtspecs/pull/1209</a></div><details><summary>1183 Add transient mode and the transient{} expression</summary><div class="markup"><p>Fix #1183</p>
</div></details></div>
<div class="toot" id="agenda-05-14"><h2>QT4 CG meeting 077 draft agenda<span class="toot-id"> #agenda-05-14</span></h2><div class="pubdate">13 May at 13:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/05-14">https://qt4cg.org/meeting/agenda/2024/05-14</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="minutes-05-07"><h2>QT4 CG meeting 076 draft minutes<span class="toot-id"> #minutes-05-07</span></h2><div class="pubdate">13 May at 13:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/05-07">https://qt4cg.org/meeting/minutes/2024/05-07</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-1208"><h2>Issue #1208 created<span class="toot-id"> #created-1208</span></h2><div class="pubdate">13 May at 10:13:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1208">https://github.com/qt4cg/qtspecs/issues/1208</a></div><details><summary>Reserved Function Names: item, empty-sequence</summary><div class="markup"><p>The keywords <code>item</code> and <code>empty-sequence</code> have been dropped from the list of reversed function names:</p>
<ul>
<li>https://qt4cg.org/specifications/xquery-40/xquery-40.html#id-reserved-fn-names</li>
<li>https://www.w3.org/TR/2017/REC-xquery-31-20170321/#id-reserved-fn-names</li>
</ul>
<p>A note exists only for the dropped <code>map</code> and <code>array</code> keywords.</p>
</div></details></div>
<div class="toot" id="created-1207"><h2>Issue #1207 created<span class="toot-id"> #created-1207</span></h2><div class="pubdate">13 May at 10:03:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1207">https://github.com/qt4cg/qtspecs/issues/1207</a></div><details><summary>Array filter: Positional access</summary><div class="markup"><p>I apologize for warming up an already accepted feature, but I have mixed feelings about the deviating rules for filters and array filters. People can do…</p>
<pre><code class="language-xquery">for $n in $numbers[1 to 5]
return $n + 1
</code></pre>
<p>…but they won’t be able to do…</p>
<pre><code class="language-xquery">for member $n in $numbers?[1 to 5]
return $n + 1
</code></pre>
<p>Of course you can always use <code>array:subarray</code>, <code>array:slice</code>, etc., but from the perspective of symmetry and usability, it’s just not obvious why positions are exclusively allowed for sequences. Even if we regard numeric predicates as a design error, we should rather <em>deliberately repeat other people’s mistakes</em>…</p>
</div></details></div>
<div class="toot" id="created-1206"><h2>Pull request #1206 created<span class="toot-id"> #created-1206</span></h2><div class="pubdate">13 May at 08:28:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1206">https://github.com/qt4cg/qtspecs/pull/1206</a></div><details><summary>1195 Hash Function: CRC-32</summary><div class="markup"><p>Issue: #1195</p>
</div></details></div>
<div class="toot" id="created-1205"><h2>Pull request #1205 created<span class="toot-id"> #created-1205</span></h2><div class="pubdate">13 May at 07:31:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1205">https://github.com/qt4cg/qtspecs/pull/1205</a></div><details><summary>1196 Math Functions: math:e, math:sinh, math:cosh, math:tanh</summary><div class="markup"><p>Issue: #1196</p>
</div></details></div>
<div class="toot" id="created-1204"><h2>Pull request #1204 created<span class="toot-id"> #created-1204</span></h2><div class="pubdate">11 May at 18:44:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1204">https://github.com/qt4cg/qtspecs/pull/1204</a></div><details><summary>1203 Define out-of-range conditions in CSV get function</summary><div class="markup"><p>Fix #1203</p>
</div></details></div>
<div class="toot" id="created-1203"><h2>Issue #1203 created<span class="toot-id"> #created-1203</span></h2><div class="pubdate">11 May at 18:01:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1203">https://github.com/qt4cg/qtspecs/issues/1203</a></div><details><summary>CSV parsing: in call of get($R, $Z), what if $R is out of range</summary><div class="markup"><p>In the description of the <code>?get($R, $Z)</code> callback function, it is stated what happens if $Z doesn't identify an actual column (error when $Z is a string, return "" when it is an integer), but it's not stated what happens when $R (the row number) is out of range.</p>
<p>The existing text could also be improved because it talks of "the argument" to the function, when there are two.</p>
<p>The Saxon implementation currently returns "" and I proposed to say that unless anyone objects.</p>
</div></details></div>
<div class="toot" id="created-1202"><h2>Issue #1202 created<span class="toot-id"> #created-1202</span></h2><div class="pubdate">10 May at 11:58:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1202">https://github.com/qt4cg/qtspecs/issues/1202</a></div><details><summary>XQFO: Updated Functions updated?</summary><div class="markup"><p>It’s not always clear in the XQFO draft what has been updated when a function is marked as such. In the attached examples (there are several cases), either the <code>Changed</code> section is missing, or the renderer fails to detect that the function has not actually changed:</p>
<hr>
<p><img src="https://github.com/qt4cg/qtspecs/assets/196589/0c616f31-278a-4147-9266-8d8f5d51378d" alt="image"></p>
</div></details></div>
<div class="toot" id="closed-1201"><h2>Issue #1201 closed<span class="toot-id"> #closed-1201</span></h2><div class="pubdate">09 May at 05:13:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1201">https://github.com/qt4cg/qtspecs/pull/1201</a></div><p>Update the Saxonica EE repo</p></div>
<div class="toot" id="created-1201"><h2>Pull request #1201 created<span class="toot-id"> #created-1201</span></h2><div class="pubdate">09 May at 05:13:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1201">https://github.com/qt4cg/qtspecs/pull/1201</a></div><details><summary>Update the Saxonica EE repo</summary><div class="markup"><p>This should be harmless and I would have thought unnecessary, but there were reports of trouble reading Saxon EE 12.2 from Maven. This PR just updates the maven EE repo URI. The old URI redirects to the new one, but maybe that's causing a problem somehow?</p>
</div></details></div>
<div class="toot" id="closed-1162"><h2>Issue #1162 closed<span class="toot-id"> #closed-1162</span></h2><div class="pubdate">08 May at 18:09:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1162">https://github.com/qt4cg/qtspecs/issues/1162</a></div><p>Revert strict type for positional variables (xs:integer → xs:positiveInteger)</p></div>
<div class="toot" id="closed-1165"><h2>Issue #1165 closed<span class="toot-id"> #closed-1165</span></h2><div class="pubdate">08 May at 18:07:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1165">https://github.com/qt4cg/qtspecs/issues/1165</a></div><p>[Editorial] References to numeric codepoints in prose: consistency</p></div>
<div class="toot" id="created-1200"><h2>Pull request #1200 created<span class="toot-id"> #created-1200</span></h2><div class="pubdate">08 May at 17:36:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1200">https://github.com/qt4cg/qtspecs/pull/1200</a></div><details><summary>QT4CG-075-02 Define the term sequence concatenation</summary><div class="markup"><p>Purely editorial</p>
</div></details></div>
<div class="toot" id="created-1199"><h2>Issue #1199 created<span class="toot-id"> #created-1199</span></h2><div class="pubdate">08 May at 14:29:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1199">https://github.com/qt4cg/qtspecs/issues/1199</a></div><details><summary>In F+O function signatures, show some indication that a function is variadic.</summary><div class="markup"><p>Currently the markup indicates that a function is variadic, but this is not flagged in the displayed signature.</p>
</div></details></div>
<div class="toot" id="created-1198"><h2>Pull request #1198 created<span class="toot-id"> #created-1198</span></h2><div class="pubdate">08 May at 14:28:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1198">https://github.com/qt4cg/qtspecs/pull/1198</a></div><details><summary>1189 distinct document order</summary><div class="markup"><p>Add distinct-document-order function.</p>
<p>(Somehow this PR also includes changes to XSLT examples consequent on allowing "fn" as a synonym for "function")</p>
</div></details></div>
<div class="toot" id="created-1197"><h2>Pull request #1197 created<span class="toot-id"> #created-1197</span></h2><div class="pubdate">08 May at 13:30:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1197">https://github.com/qt4cg/qtspecs/pull/1197</a></div><details><summary>1192 Allow fn as abbreviation for function</summary><div class="markup"><p>Brings function tests into line with inline function syntax</p>
</div></details></div>
<div class="toot" id="created-1196"><h2>Issue #1196 created<span class="toot-id"> #created-1196</span></h2><div class="pubdate">08 May at 10:58:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1196">https://github.com/qt4cg/qtspecs/issues/1196</a></div><details><summary>Math Functions: `math:e`, `math:sinh`, `math:cosh`, `math:tanh`</summary><div class="markup"><p>The functions <code>math:e</code>, <code>math:sinh</code>, <code>math:cosh</code> and <code>math:tanh</code> might have been missed in the past, and would be simple to add.</p>
</div></details></div>
<div class="toot" id="created-1195"><h2>Issue #1195 created<span class="toot-id"> #created-1195</span></h2><div class="pubdate">08 May at 10:47:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1195">https://github.com/qt4cg/qtspecs/issues/1195</a></div><details><summary>Hash Function: CRC-32</summary><div class="markup"><p>I discovered only now that <code>fn:hash</code> mentions that the function can also be used for computing cyclic redundancy checks.</p>
<p>Shouldn’t we add the basic <code>CRC-32</code> algorithm to the list of mandatory algorithms?</p>
</div></details></div>
<div class="toot" id="created-1194"><h2>Issue #1194 created<span class="toot-id"> #created-1194</span></h2><div class="pubdate">08 May at 09:10:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1194">https://github.com/qt4cg/qtspecs/issues/1194</a></div><details><summary>New function fn:query()</summary><div class="markup"><p>I propose a new function <code>fn:query()</code> to perform dynamic XQuery/XPath evaluation: a similar role to fn:transform() and xsl:evaluate.</p>
<p>I propose a design based on the design of fn:invisible-xml() - fn:query should take a query string as its argument, and return a function item that can be called to evaluate the query.</p>
<p>The fn:query() function will need an options map to supply significant aspects of the static context, for example the base URI. But I don't think we need to support everything. Public functions in the calling module should probably be made available automatically, in which case we don't need to support "import module".</p>
<p>The dynamic evaluation function will need an options map to supply significant aspects of the dynamic context, notably the context value and values of external parameters. The query result should be returned in "raw" (ie. unserialized) form.</p>
<p>Perhaps there should be an option language="xpath" to say that the "query" is actually an XPath expression; some implementations might find that easier to support, especially when the processor is itself an XPath processor.</p>
<p>(Motivation: Saxon has a pair of ancient extension functions <code>saxon:compile-query</code> and <code>saxon:query</code> and the design needs modernising, and bridging across to additional platforms. We might as well get it into the standard if we're doing that.)</p>
</div></details></div>
<div class="toot" id="closed-1143"><h2>Issue #1143 closed<span class="toot-id"> #closed-1143</span></h2><div class="pubdate">07 May at 18:24:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1143">https://github.com/qt4cg/qtspecs/issues/1143</a></div><p>Coercion Rules for Choice Item Types</p></div>
<div class="toot" id="closed-1148"><h2>Issue #1148 closed<span class="toot-id"> #closed-1148</span></h2><div class="pubdate">07 May at 18:24:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1148">https://github.com/qt4cg/qtspecs/pull/1148</a></div><p>1143 Coercion rules: handle choice types before atomization</p></div>
<div class="toot" id="closed-1184"><h2>Issue #1184 closed<span class="toot-id"> #closed-1184</span></h2><div class="pubdate">07 May at 17:44:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1184">https://github.com/qt4cg/qtspecs/pull/1184</a></div><p>1165-Use Unicode-style character references</p></div>
<div class="toot" id="closed-1171"><h2>Issue #1171 closed<span class="toot-id"> #closed-1171</span></h2><div class="pubdate">07 May at 16:08:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1171">https://github.com/qt4cg/qtspecs/issues/1171</a></div><p>Predicates returning xs:boolean vs. xs:boolean?</p></div>
<div class="toot" id="closed-1182"><h2>Issue #1182 closed<span class="toot-id"> #closed-1182</span></h2><div class="pubdate">07 May at 16:06:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1182">https://github.com/qt4cg/qtspecs/pull/1182</a></div><p>1171 Change predicate callbacks to allow empty return value</p></div>
<div class="toot" id="closed-1170"><h2>Issue #1170 closed<span class="toot-id"> #closed-1170</span></h2><div class="pubdate">07 May at 16:05:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1170">https://github.com/qt4cg/qtspecs/issues/1170</a></div><p>Editorial: fn:index-where; parentheses; …</p></div>
<div class="toot" id="closed-1186"><h2>Issue #1186 closed<span class="toot-id"> #closed-1186</span></h2><div class="pubdate">07 May at 16:05:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1186">https://github.com/qt4cg/qtspecs/pull/1186</a></div><p>1170 Editorial: fn:index-where</p></div>
<div class="toot" id="created-1193"><h2>Issue #1193 created<span class="toot-id"> #created-1193</span></h2><div class="pubdate">07 May at 14:34:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1193">https://github.com/qt4cg/qtspecs/issues/1193</a></div><details><summary>Parsing Functions: Empty input</summary><div class="markup"><p>I was asked why some of the parsing functions allow empty input and others don’t:</p>
<p>Function | Input
--- | ---
<code>fn:parse-integer</code> | <code>xs:string</code>
<code>fn:parse-uri</code> | <code>xs:string</code>
<code>fn:parse-ietf-date</code> | <code>xs:string?</code>
<code>fn:parse-QName</code> | <code>xs:string</code>
<code>fn:parse-xml</code> | <code>xs:string?</code>
<code>fn:parse-xml-fragment</code> | <code>xs:string?</code>
<code>fn:parse-html</code> | <code>(xs:string \| xs:hexBinary \| xs:base64Binary)?</code>
<code>fn:parse-json</code> | <code>xs:string?</code>
<code>fn:parse-csv</code> | <code>xs:string?</code></p>
<p>I would assume there is no rationale behind this, and that we should always allow empty input.</p>
</div></details></div>
<div class="toot" id="created-1192"><h2>Issue #1192 created<span class="toot-id"> #created-1192</span></h2><div class="pubdate">07 May at 10:11:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1192">https://github.com/qt4cg/qtspecs/issues/1192</a></div><details><summary>Allow "fn" as abbreviation for "function" in ItemType syntax</summary><div class="markup"><p>The syntax for inline functions is, by design, similar to the syntax for function tests. So it's confusing that you can abbreviate "function" to "fn" in the first case but not the second.</p>
<p>Open question: what about "declare function" in the XQuery prolog? My instinct is to leave that as it is.</p>
</div></details></div>
<div class="toot" id="created-1191"><h2>Pull request #1191 created<span class="toot-id"> #created-1191</span></h2><div class="pubdate">06 May at 22:14:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1191">https://github.com/qt4cg/qtspecs/pull/1191</a></div><details><summary>1167, 934 deep equal merge collations param</summary><div class="markup"><p>Fix #934 String comparisons in fn:deep-equal
Fix #1167 Merge $collation and $options params of fn:deep-equal</p>
</div></details></div>
<div class="toot" id="created-1190"><h2>Pull request #1190 created<span class="toot-id"> #created-1190</span></h2><div class="pubdate">06 May at 15:09:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1190">https://github.com/qt4cg/qtspecs/pull/1190</a></div><details><summary>1188 XQFO hash</summary><div class="markup"><p>Fixed description</p>
</div></details></div>
<div class="toot" id="created-1189"><h2>Issue #1189 created<span class="toot-id"> #created-1189</span></h2><div class="pubdate">06 May at 10:43:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1189">https://github.com/qt4cg/qtspecs/issues/1189</a></div><details><summary>Function: distinct document order</summary><div class="markup"><p>The nodes resulting from path traversals are normalized by restoring document order and removing duplicates. There are use cases where this operation needs to be enforced, for which people do things like…</p>
<pre><code class="language-xquery">$nodes/.
$nodes/self::node()
$nodes union ()
$nodes except ()
</code></pre>
<p>…which all look arcane to occasional readers, and are prone to be accidentally optimized away.</p>
<p>It would be sensible to have a helper function that makes this operation explicit, so that users have some clue that something intentional is going on. Some articles called this postprocessing step <em>distinct document order</em>, which is why we added <code>util:ddo</code> in the past – but I would love to find a both canonical and catchier name for it.</p>
</div></details></div>
<div class="toot" id="agenda-05-07"><h2>QT4 CG meeting 076 draft agenda<span class="toot-id"> #agenda-05-07</span></h2><div class="pubdate">06 May at 09:55:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/05-07">https://qt4cg.org/meeting/agenda/2024/05-07</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1188"><h2>Issue #1188 created<span class="toot-id"> #created-1188</span></h2><div class="pubdate">06 May at 08:58:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1188">https://github.com/qt4cg/qtspecs/issues/1188</a></div><details><summary>fn:hash: Editorial</summary><div class="markup"><p>The summary of <code>fn:hash</code> says…</p>
<blockquote>
<p>Returns a string representation of the results from a specified hash, checksum, or cyclic redundancy check function upon the input.</p>
</blockquote>
<p>…but the latest version returns a <code>xs:hexBinary</code> value.</p>
</div></details></div>
<div class="toot" id="created-1187"><h2>Issue #1187 created<span class="toot-id"> #created-1187</span></h2><div class="pubdate">04 May at 10:55:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1187">https://github.com/qt4cg/qtspecs/issues/1187</a></div><details><summary>Decimal rounding</summary><div class="markup"><p>This is in response to a bug/feature request from a Saxon user: see https://saxonica.plan.io/issues/6408</p>
<p>Currently</p>
<p>(a) the round() function gives no control over rounding mode (towards zero, towards positive infinity, etc etc).</p>
<p>(b) decimal division leaves it entirely implementation-defined what the precision of the result should be, let alone what rounding is applied to attain that precision.</p>
<p>This can cause difficulties for users where, for example, financial accounting standards mandate a particular rounding mode.</p>
<p>Is this something we want to address?</p>
</div></details></div>
<div class="toot" id="created-1186"><h2>Pull request #1186 created<span class="toot-id"> #created-1186</span></h2><div class="pubdate">02 May at 11:17:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1186">https://github.com/qt4cg/qtspecs/pull/1186</a></div><details><summary>1170 Editorial: fn:index-where</summary><div class="markup"><p>Issue: 1170</p>
<ul>
<li>Editorial, 2 characters added</li>
<li>“2. Redundant parens in function signatures“ is obsolete (https://github.com/qt4cg/qtspecs/pull/1182/files#diff-7625c07ae8131ff65c3caa677b188ed2b9b66237312d11c05a2fa2838c6f5c67R21233)</li>
</ul>
</div></details></div>
<div class="toot" id="created-1185"><h2>Pull request #1185 created<span class="toot-id"> #created-1185</span></h2><div class="pubdate">02 May at 11:07:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1185">https://github.com/qt4cg/qtspecs/pull/1185</a></div><details><summary>1179 array:values, map:values → contents</summary><div class="markup"><p>Issue: #1179</p>
</div></details></div>
<div class="toot" id="created-1184"><h2>Pull request #1184 created<span class="toot-id"> #created-1184</span></h2><div class="pubdate">01 May at 21:14:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1184">https://github.com/qt4cg/qtspecs/pull/1184</a></div><details><summary>1165-Use Unicode-style character references</summary><div class="markup"><p>Currently only affects F+O.</p>
<p>New element <code>&lt;char&gt;U+xxxx&lt;/char&gt;</code> is supported in the DTD and XSLT. It is automatically expanded to include the character name and glyph. I was hoping to get the Unicode character names directly from the Unicode database, but that's a bit unwieldy, so I created a little file (in the style directory) containing the names of the characters that we actually use.</p>
</div></details></div>
<div class="toot" id="created-1183"><h2>Issue #1183 created<span class="toot-id"> #created-1183</span></h2><div class="pubdate">01 May at 20:24:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1183">https://github.com/qt4cg/qtspecs/issues/1183</a></div><details><summary>transient() - a function to make functions nondeterministic</summary><div class="markup"><p>I propose a function <code>transient()</code> which takes a function as input and returns a function that is functionally identical, but which relaxes the requirement for determinism.</p>
<p>For example, <code>transient(current-dateTime#0)</code> returns a function that returns a date and time, but is not required to return the same date and time on every call, while <code>transient(doc#1)</code> returns a function that dereferences an XML document URI, but is not required to return the same document every time it is called with the same URI.</p>
<p>A valid implementation, of course, could return the supplied function unchanged - the transient() function gives the implementation the freedom to relax the rules, but does not require it to do so.</p>
<p><code>transient()</code> seems like a more friendly name than <code>nondeterministic()</code>.</p>
</div></details></div>
<div class="toot" id="created-1182"><h2>Pull request #1182 created<span class="toot-id"> #created-1182</span></h2><div class="pubdate">30 Apr at 23:39:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1182">https://github.com/qt4cg/qtspecs/pull/1182</a></div><details><summary>1171 Change predicate callbacks to allow empty return value</summary><div class="markup"><p>Return type changes from <code>xs:boolean</code> to <code>xs:boolean?</code></p>
</div></details></div>
<div class="toot" id="created-1181"><h2>Pull request #1181 created<span class="toot-id"> #created-1181</span></h2><div class="pubdate">30 Apr at 22:00:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1181">https://github.com/qt4cg/qtspecs/pull/1181</a></div><details><summary>296 Allow default-namespace=##any</summary><div class="markup"><p>Allows the default namespace for elements and types to have the special value "##any", which causes unprefixed QNames to match elements in any namespace. Use cases include:</p>
<ul>
<li>Casual ad-hoc XPath queries, where over-retrieval isn't a problem</li>
<li>Use with HTML, where it can be unpredictable whether elements will be in a namespace, and where users are accustomed to browser behaviour with its "wilful violation" of the XPath 1.0 specification</li>
<li>Any environment where multiple namespaces are in use for variants of what is essentially the same vocabulary of element names (for example, where the XML designer has made the mistake of versioning the namespace URI)</li>
</ul>
</div></details></div>
<div class="toot" id="closed-161"><h2>Issue #161 closed<span class="toot-id"> #closed-161</span></h2><div class="pubdate">30 Apr at 20:02:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/161">https://github.com/qt4cg/qtspecs/issues/161</a></div><p>Support unbounded variadic functions on sequence parameters</p></div>
<div class="toot" id="closed-1137"><h2>Issue #1137 closed<span class="toot-id"> #closed-1137</span></h2><div class="pubdate">30 Apr at 20:02:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1137">https://github.com/qt4cg/qtspecs/pull/1137</a></div><p>161 Variadic functions</p></div>
<div class="toot" id="created-1180"><h2>Issue #1180 created<span class="toot-id"> #created-1180</span></h2><div class="pubdate">30 Apr at 18:04:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1180">https://github.com/qt4cg/qtspecs/issues/1180</a></div><details><summary>fn:unparsed-text: `cache` option</summary><div class="markup"><p>In #1117, we discussed the pros and cons of a <code>deterministic</code> option for <code>fn:unparsed-text</code>.</p>
<p>I would suggest  making the function strictly nondeterministic, but adding a <code>cache</code> option:</p>
<ul>
<li>That way we don’t equate determinism with caching, which can in fact be different things. For example, an implementation might decide to do deterministic things at compile time, whereas it might be better to cache data only when it’s actually requested.</li>
<li>The meaning of the option will be easier to explain to non-experts (…and avoid confusion among experts).</li>
</ul>
</div></details></div>
<div class="toot" id="minutes-04-30"><h2>QT4 CG meeting 075 draft minutes<span class="toot-id"> #minutes-04-30</span></h2><div class="pubdate">30 Apr at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/04-30">https://qt4cg.org/meeting/minutes/2024/04-30</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1086"><h2>Issue #1086 closed<span class="toot-id"> #closed-1086</span></h2><div class="pubdate">30 Apr at 16:22:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1086">https://github.com/qt4cg/qtspecs/issues/1086</a></div><p>array:values spec cleanup</p></div>
<div class="toot" id="closed-1087"><h2>Issue #1087 closed<span class="toot-id"> #closed-1087</span></h2><div class="pubdate">30 Apr at 16:22:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1087">https://github.com/qt4cg/qtspecs/pull/1087</a></div><p>1086 Editorial changes to array:values</p></div>
<div class="toot" id="closed-1166"><h2>Issue #1166 closed<span class="toot-id"> #closed-1166</span></h2><div class="pubdate">30 Apr at 16:16:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1166">https://github.com/qt4cg/qtspecs/issues/1166</a></div><p>Invalid option keys: the rule is unclear</p></div>
<div class="toot" id="closed-1168"><h2>Issue #1168 closed<span class="toot-id"> #closed-1168</span></h2><div class="pubdate">30 Apr at 16:16:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1168">https://github.com/qt4cg/qtspecs/pull/1168</a></div><p>1166 Clarify rule on invalid option keys</p></div>
<div class="toot" id="closed-1173"><h2>Issue #1173 closed<span class="toot-id"> #closed-1173</span></h2><div class="pubdate">30 Apr at 16:12:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1173">https://github.com/qt4cg/qtspecs/issues/1173</a></div><p>array:build, map:build: Positional access</p></div>
<div class="toot" id="closed-1174"><h2>Issue #1174 closed<span class="toot-id"> #closed-1174</span></h2><div class="pubdate">30 Apr at 16:12:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1174">https://github.com/qt4cg/qtspecs/pull/1174</a></div><p>1173 array:build, map:build: Positional access</p></div>
<div class="toot" id="closed-1177"><h2>Issue #1177 closed<span class="toot-id"> #closed-1177</span></h2><div class="pubdate">30 Apr at 16:10:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1177">https://github.com/qt4cg/qtspecs/pull/1177</a></div><p>1162 Positional variables are xs:integer not xs:positiveInteger</p></div>
<div class="toot" id="closed-553"><h2>Issue #553 closed<span class="toot-id"> #closed-553</span></h2><div class="pubdate">30 Apr at 16:08:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/553">https://github.com/qt4cg/qtspecs/issues/553</a></div><p>New function fn:substitute()</p></div>
<div class="toot" id="created-1179"><h2>Issue #1179 created<span class="toot-id"> #created-1179</span></h2><div class="pubdate">30 Apr at 16:02:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1179">https://github.com/qt4cg/qtspecs/issues/1179</a></div><details><summary>Editorial: `array:values`, `map:values`</summary><div class="markup"><p>Triggered by #1087:</p>
<ol>
<li>Align <code>map:values</code> with <code>array:values</code></li>
<li>Revise notes.</li>
<li>Rename the functions.</li>
</ol>
<p>@michaelhkay You suggested that <code>content</code> might be a better name – rather than <code>item</code> – for retrieving the sequence-concatenation of values in map lookups in https://github.com/qt4cg/qtspecs/issues/1169#issuecomment-2074378446. Should we rename the functions to <code>array:contents</code>, <code>map:contents</code> or use <code>array:items</code> and <code>map:items</code>?</p>
</div></details></div>
<div class="toot" id="closed-1178"><h2>Issue #1178 closed<span class="toot-id"> #closed-1178</span></h2><div class="pubdate">30 Apr at 16:00:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1178">https://github.com/qt4cg/qtspecs/pull/1178</a></div><p>1146 Add inline change markup in the XPath/XQuery spec</p></div>
<div class="toot" id="created-1178"><h2>Pull request #1178 created<span class="toot-id"> #created-1178</span></h2><div class="pubdate">28 Apr at 22:51:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1178">https://github.com/qt4cg/qtspecs/pull/1178</a></div><details><summary>1146 Add inline change markup in the XPath/XQuery spec</summary><div class="markup"><p>There is more work to be done to ensure the change log entries are complete, but this is a good start.</p>
</div></details></div>
<div class="toot" id="closed-1159"><h2>Issue #1159 closed<span class="toot-id"> #closed-1159</span></h2><div class="pubdate">27 Apr at 20:40:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1159">https://github.com/qt4cg/qtspecs/issues/1159</a></div><p>Filter operator for arrays</p></div>
<div class="toot" id="created-1177"><h2>Pull request #1177 created<span class="toot-id"> #created-1177</span></h2><div class="pubdate">27 Apr at 20:36:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1177">https://github.com/qt4cg/qtspecs/pull/1177</a></div><details><summary>1162 Positional variables are xs:integer not xs:positiveInteger</summary><div class="markup"><p>Reverts a change that made the type xs:positiveInteger as the impact of the change was not fully explored, and the same change was not made elsewhere e.g. to the argument type of array:get() or the return type of fn:position().</p>
<p>Note: the use of xs:positiveInteger has been retained for row and column numbers in the CSV functions, and for codepoints in the fn:char() function.</p>
</div></details></div>
<div class="toot" id="created-1176"><h2>Issue #1176 created<span class="toot-id"> #created-1176</span></h2><div class="pubdate">26 Apr at 03:15:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1176">https://github.com/qt4cg/qtspecs/issues/1176</a></div><details><summary>Use fn:parse-uri to check whether a filepath is relative or absolute</summary><div class="markup"><p>I have a question about the new function <code>fn:parse-uri()</code>. A common use case is to check whether a file path is absolute or relative. For example, I want to check whether the file path <code>images/img1.png</code> is relative and can therefore be converted to an absolute file path using <code>resolve-uri()</code>. Or I want to check whether <code>$base</code> is absolute and can therefore be used as the second argument in <code>resolve-uri()</code>.</p>
<p>How would I use a <code>uri-structure-record</code> map determined as a result of<code> fn:parse-uri ()</code> to decide whether it is a relative or absolute file path?<br>
Greetings, Frank</p>
</div></details></div>
<div class="toot" id="created-1175"><h2>Issue #1175 created<span class="toot-id"> #created-1175</span></h2><div class="pubdate">25 Apr at 18:18:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1175">https://github.com/qt4cg/qtspecs/issues/1175</a></div><details><summary>XPath: Optional parameters in the definition of an inline function</summary><div class="markup"><p>This is a proposal to extend the definition of an inline-function item with the ability to specify a set of optional/keyword-value parameters, following the sequence of positional parameters of the function.</p>
<p>This is very similar to what we already have for static function definitions: https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-function-definition and https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-static-functions</p>
<p>While a <strong>static function definition</strong> has the following parts:</p>
<ul>
<li>
<p>The function name, which is an <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-expanded-qname">expanded QName</a>.</p>
</li>
<li>
<p>A (possibly empty) list of required parameters, each having:</p>
</li>
<li>
<p>a parameter name (an <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-expanded-qname">expanded QName</a>)</p>
</li>
<li>
<p>a required type (a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-sequence-type">sequence type</a>)</p>
</li>
<li>
<p>A (possibly empty) list of optional parameters, each having:</p>
</li>
<li>
<p>a parameter name (an <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-expanded-qname">expanded QName</a>)</p>
</li>
<li>
<p>a required type (a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-sequence-type">sequence type</a>)</p>
</li>
<li>
<p>a default value expression (an expression: see <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-expressions">4 Expressions</a>)</p>
</li>
<li>
<p>A return type (a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-sequence-type">sequence type</a>)</p>
</li>
<li>
<p>A (possibly empty) set of function annotations</p>
</li>
<li>
<p>A body. The function body contains the logic that enables the function result to be computed from the supplied arguments and information in the static and dynamic context.</p>
</li>
</ul>
<p>For an <strong>inline function definition</strong> we will have:</p>
<ul>
<li>
<p>A name of a variable to contain the function item being defined.</p>
</li>
<li>
<p>A (possibly empty) list of required parameters, each having:</p>
</li>
<li>
<p>a parameter name (an <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-expanded-qname">expanded QName</a>)</p>
</li>
<li>
<p>an optional type (a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-sequence-type">sequence type</a>)</p>
</li>
<li>
<p>A (possibly empty) list of optional parameters, each having:</p>
</li>
<li>
<p>a parameter name (an <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-expanded-qname">expanded QName</a>)</p>
</li>
<li>
<p>an optional type (a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-sequence-type">sequence type</a>)</p>
</li>
<li>
<p>a default value expression (an expression: see <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-expressions">4 Expressions</a>)</p>
</li>
<li>
<p>An optional return type (a <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#dt-sequence-type">sequence type</a>)</p>
</li>
<li>
<p>A body. The function body contains the logic that enables the function result to be computed from the supplied arguments and information in the static and dynamic context.</p>
</li>
</ul>
<p><strong>What is accomplished by introducing optional parameters</strong>?</p>
<p>The answer is the same as for the effect of having optional parameters in a static function definition: increased <strong><em>brevity</em></strong>, <strong><em>conciseness</em></strong> and <strong><em>clarity</em></strong> .</p>
<pre><code class="language-xq">let $myFun := fn($pos1, $pos2, $posK, $kw1 := expr1, $kw2 := expr2, ...,  $kwN := exprN) { (: Some expression :)} 
</code></pre>
<p>replaces what would otherwise be a set of <code>N! + 1</code> separate inline function definitions, each of which must be assigned to a separate variable.</p>
<p>Similarly to the static function calls, with this new feature a call to such an inline function must provide values for all positional arguments, followed by an optional set (meaning in any order) of assignments of values to specific keyword-valued (optional) arguments. The rules for an inline function call are similar to those for a call to a static function - the provided values for the positional arguments must precede all other provided values and the values for the optional arguments may be provided in any order.</p>
<p>Here is a short example of an inline function definition and calling it:</p>
<pre><code class="language-xq">let $incr := fn($arg1, $increment := 1) {$arg1 + $increment }
 return
  (
   $incr(5),
   $incr(5, increment := 2),
   $incr(5, increment := 3)
 )
</code></pre>
<p>produces:</p>
<p><code>6, 7, 8</code></p>
</div></details></div>
<div class="toot" id="created-1174"><h2>Pull request #1174 created<span class="toot-id"> #created-1174</span></h2><div class="pubdate">24 Apr at 12:45:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1174">https://github.com/qt4cg/qtspecs/pull/1174</a></div><details><summary>1173 array:build, map:build: Positional access</summary><div class="markup"><p>Issue: #1173</p>
</div></details></div>
<div class="toot" id="closed-1110"><h2>Issue #1110 closed<span class="toot-id"> #closed-1110</span></h2><div class="pubdate">24 Apr at 12:40:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1110">https://github.com/qt4cg/qtspecs/issues/1110</a></div><p>New error codes</p></div>
<div class="toot" id="created-1173"><h2>Issue #1173 created<span class="toot-id"> #created-1173</span></h2><div class="pubdate">24 Apr at 10:13:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1173">https://github.com/qt4cg/qtspecs/issues/1173</a></div><details><summary>array:build, map:build: Positional access</summary><div class="markup"><p><code>array:build</code> seems to be the only function (for iterating over ordered input) for which the HOF parameters lacks a positional parameter:</p>
<pre><code class="language-xquery">array:build(
  $input   as item()*,	
  $action  as function(item()) as item()*  := fn:identity#1
) as array(*)

(: should be :)
array:build(
  $input   as item()*,	
  $action  as function(item(), xs:integer) as item()*  := fn:identity#1
) as array(*)
</code></pre>
</div></details></div>
<div class="toot" id="created-1172"><h2>Issue #1172 created<span class="toot-id"> #created-1172</span></h2><div class="pubdate">24 Apr at 10:08:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1172">https://github.com/qt4cg/qtspecs/issues/1172</a></div><details><summary>Iterating maps: Positional access</summary><div class="markup"><p>With the new filter expression for maps, the context position is available. To be consistent, if we want to provide positional access for unordered data, we should…</p>
<ul>
<li>either provide this for map functions  as well (<code>map:filter</code>, <code>map:for-each</code>), or</li>
<li>don’t provide it for map predicates at all.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1171"><h2>Issue #1171 created<span class="toot-id"> #created-1171</span></h2><div class="pubdate">24 Apr at 10:02:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1171">https://github.com/qt4cg/qtspecs/issues/1171</a></div><details><summary>Predicates returning xs:boolean vs. xs:boolean?</summary><div class="markup"><p>In <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html#id-filter-maps-and-arrays">4.13.4  Filter Expressions for Maps and Arrays</a>, the type of the predicate expression <code>FILTER</code> is <code>xs:boolean?</code>.</p>
<p>To be consistent, we should either relax the types of the predicate/filter functions (for <code>fn:filter</code>, etc.) or stick with <code>xs:boolean</code>.</p>
</div></details></div>
<div class="toot" id="created-1170"><h2>Issue #1170 created<span class="toot-id"> #created-1170</span></h2><div class="pubdate">24 Apr at 07:31:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1170">https://github.com/qt4cg/qtspecs/issues/1170</a></div><details><summary>Editorial: fn:index-where; parentheses; …</summary><div class="markup"><h4>1. fn:index-where, array:index-where</h4>
<blockquote>
<p>Returns the position in an input ...</p>
</blockquote>
<p>→ positions</p>
<h4>2. Redundant parens in function signatures</h4>
<pre><code>as (function(xs:anyAtomicType, item()*) as xs:boolean)
...
</code></pre>
</div></details></div>
<div class="toot" id="created-1169"><h2>Issue #1169 created<span class="toot-id"> #created-1169</span></h2><div class="pubdate">24 Apr at 06:35:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1169">https://github.com/qt4cg/qtspecs/issues/1169</a></div><details><summary>Maps &amp; Arrays: Consistency &amp; Terminology</summary><div class="markup"><p>After the introduction of #1094 and #1159, and before adding more map/array operations, I think it’s time to get more serious about consistency and terminology. The current drafts employ a variety of terms that are not clearly defined, or separated from each other. We now have at least…</p>
<blockquote>
<p>items, members, pairs, keys, values, entries</p>
</blockquote>
<p>…which are sometimes used for maps, for arrays, or for both data structures. A first attempt to clean up, with reducing the overall effort:</p>
<ol>
<li>
<p>A minor one: The modifier for lookups should be in singular form, analagous to node axes: <code>item</code>, <code>key</code>, <code>value</code>, <code>pair</code>.</p>
</li>
<li>
<p>While I first advocated the orthogonality principle for axes in lookup expressions, I now think we should stick to the existing terminology. Otherwise, we would need to revise many other existing parts of the spec. My suggestion would be to:</p>
</li>
</ol>
<ul>
<li>introduce <code>member</code> for arrays</li>
<li>only allow <code>key</code>, <code>value</code> and <code>pair</code> for maps</li>
<li>allow <code>items</code> for both maps and arrays</li>
</ul>
<p>This would make it symmetric with a) the current terminology for maps and arrays, and b) enhanced <code>for</code> clauses, i.e. <code>for member $m</code> and <code>for key $k value $v</code>.</p>
<p>The reverse approach would be to drop <code>for member $m</code> and to also allow <code>for key $k value $v</code> for arrays (with <code>for value</code> replacing <code>for member</code>). In addition, we could have <code>for pair</code>.</p>
<ol start="3">
<li>
<p>With the introduction of the <code>item</code> axis, <code>map:values</code> and <code>arrays:values</code> should be renamed to <code>map:items</code> and <code>array:items</code>. → <code>map:contents</code> and <code>array:contents</code>, see <a href="https://github.com/qt4cg/qtspecs/issues/1179">#1179</a></p>
</li>
<li>
<p>I would suggest dropping <code>array:members</code> and <code>array:of-members</code>. The names don’t imply we’ll deal with records, and it’s not in line with <code>for member $m</code> either. If we want to keep these functions, we could rename them to <code>array:pairs</code> and <code>array:of-pairs</code> and add the integer positions as keys, and we should introduce and consistently use the term <code>pair</code> for maps and arrays.</p>
</li>
</ol>
<p>Closely related: #826</p>
</div></details></div>
<div class="toot" id="closed-1125"><h2>Issue #1125 closed<span class="toot-id"> #closed-1125</span></h2><div class="pubdate">23 Apr at 22:48:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1125">https://github.com/qt4cg/qtspecs/pull/1125</a></div><p>1094 Enhanced lookup expressions</p></div>
<div class="toot" id="closed-1094"><h2>Issue #1094 closed<span class="toot-id"> #closed-1094</span></h2><div class="pubdate">23 Apr at 22:48:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1094">https://github.com/qt4cg/qtspecs/issues/1094</a></div><p>Axis steps in lookup expressions</p></div>
<div class="toot" id="minutes-04-23"><h2>QT4 CG meeting 074 draft minutes<span class="toot-id"> #minutes-04-23</span></h2><div class="pubdate">23 Apr at 17:10:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/04-23">https://qt4cg.org/meeting/minutes/2024/04-23</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1135"><h2>Issue #1135 closed<span class="toot-id"> #closed-1135</span></h2><div class="pubdate">23 Apr at 16:04:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1135">https://github.com/qt4cg/qtspecs/issues/1135</a></div><p>Definition of focus functions</p></div>
<div class="toot" id="closed-1157"><h2>Issue #1157 closed<span class="toot-id"> #closed-1157</span></h2><div class="pubdate">23 Apr at 16:04:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1157">https://github.com/qt4cg/qtspecs/pull/1157</a></div><p>1135 Correction to definition of focus functions</p></div>
<div class="toot" id="closed-1163"><h2>Issue #1163 closed<span class="toot-id"> #closed-1163</span></h2><div class="pubdate">23 Apr at 16:01:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1163">https://github.com/qt4cg/qtspecs/pull/1163</a></div><p>1159 Add filter expressions for maps and arrays</p></div>
<div class="toot" id="closed-235"><h2>Issue #235 closed<span class="toot-id"> #closed-235</span></h2><div class="pubdate">23 Apr at 15:59:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/235">https://github.com/qt4cg/qtspecs/issues/235</a></div><p>Add multiple=true() option to fn:parse-json and fn:json-doc</p></div>
<div class="toot" id="closed-1155"><h2>Issue #1155 closed<span class="toot-id"> #closed-1155</span></h2><div class="pubdate">23 Apr at 15:59:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1155">https://github.com/qt4cg/qtspecs/issues/1155</a></div><p>Glossary formatting</p></div>
<div class="toot" id="closed-1164"><h2>Issue #1164 closed<span class="toot-id"> #closed-1164</span></h2><div class="pubdate">23 Apr at 15:59:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1164">https://github.com/qt4cg/qtspecs/pull/1164</a></div><p>1155 Consistency of glossaries</p></div>
<div class="toot" id="created-1168"><h2>Pull request #1168 created<span class="toot-id"> #created-1168</span></h2><div class="pubdate">22 Apr at 23:15:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1168">https://github.com/qt4cg/qtspecs/pull/1168</a></div><details><summary>1166 Clarify rule on invalid option keys</summary><div class="markup"><p>An error is raised for an option key unless (a) it is listed in the specification, or (b) it is recognized by the implementation, or (c) it is a QName with a non-absent namespace.</p>
<p>Also clarified the rule about accepting an array in place of a sequence (I'm not sure whether this is something that we actually do, and certainly it doesn't happen unless the parameter explicitly allows an array.)</p>
<p>Fix #1166</p>
</div></details></div>
<div class="toot" id="created-1167"><h2>Issue #1167 created<span class="toot-id"> #created-1167</span></h2><div class="pubdate">22 Apr at 17:08:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1167">https://github.com/qt4cg/qtspecs/issues/1167</a></div><details><summary>Merge $collation into $options parameter of fn:deep-equal()</summary><div class="markup"><p>To avoid the ugly third parameter to deep-equal which will almost always be set to (), merge $collation into the $options parameter, whose type becomes <code>(map(*) | xs:string)?</code> for backwards compatibility.</p>
<p>The same idea is being applied to unparsed-text and can probably be done elsewhere.</p>
</div></details></div>
<div class="toot" id="created-1166"><h2>Issue #1166 created<span class="toot-id"> #created-1166</span></h2><div class="pubdate">22 Apr at 14:42:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1166">https://github.com/qt4cg/qtspecs/issues/1166</a></div><details><summary>Invalid option keys: the rule is unclear</summary><div class="markup"><p>PR #1059 introduced the rule:</p>
<blockquote>
<p>If an option is not described in the specification, if it is not supported by the implementation and if its name is in no namespace, a type error [err:FORG0013] must be raised.</p>
</blockquote>
<p>and this has proved its worth in finding quite a few errors in the test suite!</p>
<p>However, it's not entirely clear what it means.</p>
<p>Entries in the options map can have keys of any type. I suspect this rule is intended to apply to (a) keys of type xs:string, and (b) strings of type xs:QName where the namespace URI is absent.</p>
<p>Alternatively, perhaps it should apply to ALL option keys other than a QName in a non-null namespace?</p>
</div></details></div>
<div class="toot" id="agenda-04-23"><h2>QT4 CG meeting 074 draft agenda<span class="toot-id"> #agenda-04-23</span></h2><div class="pubdate">22 Apr at 13:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/04-23">https://qt4cg.org/meeting/agenda/2024/04-23</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1165"><h2>Issue #1165 created<span class="toot-id"> #created-1165</span></h2><div class="pubdate">22 Apr at 11:06:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1165">https://github.com/qt4cg/qtspecs/issues/1165</a></div><details><summary>[Editorial] References to numeric codepoints in prose: consistency</summary><div class="markup"><p>A quick glance in F+O finds:</p>
<pre><code> \n (newline, x0A)
π (x3C0)
the glyph ≂̸ which is expressed using the two codepoints #x2242 #x0338
A format token of &amp;#x661; (Arabic-Indic digit one)
the format token &amp;#x2460; (circled digit one, ①)
the actual Unicode character COMBINING DIARESIS (Unicode codepoint U+0308) or &amp;#x0308;
The Latin small letter dotless i (ı, U+0131, used in Turkish)
the Unicode replacement character (U+FFFD)
CRLF (U+000D, U+000A), LF (U+000A), or CR (U+000D)
comma "," (U+002C)
the Unicode quotation mark " (U+0022)
a single newline (U+000A) character
</code></pre>
<p>I feel we could do better...</p>
</div></details></div>
<div class="toot" id="closed-700"><h2>Issue #700 closed<span class="toot-id"> #closed-700</span></h2><div class="pubdate">21 Apr at 22:47:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/700">https://github.com/qt4cg/qtspecs/issues/700</a></div><p>Operators for array mapping and filtering</p></div>
<div class="toot" id="created-1164"><h2>Pull request #1164 created<span class="toot-id"> #created-1164</span></h2><div class="pubdate">21 Apr at 22:16:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1164">https://github.com/qt4cg/qtspecs/pull/1164</a></div><details><summary>1155 Consistency of glossaries</summary><div class="markup"><p>Use a common style for all glossaries.</p>
<p>Add a glossary to F+O.</p>
<p>Fix #1155</p>
</div></details></div>
<div class="toot" id="created-1163"><h2>Pull request #1163 created<span class="toot-id"> #created-1163</span></h2><div class="pubdate">19 Apr at 20:39:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1163">https://github.com/qt4cg/qtspecs/pull/1163</a></div><p>1159 Add filter expressions for maps and arrays</p></div>
<div class="toot" id="created-1162"><h2>Issue #1162 created<span class="toot-id"> #created-1162</span></h2><div class="pubdate">18 Apr at 10:19:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1162">https://github.com/qt4cg/qtspecs/issues/1162</a></div><details><summary>Revert strict type for positional variables (xs:integer → xs:positiveInteger)</summary><div class="markup"><p>I feel that the decision to change <code>xs:integer</code> to <code>xs:positiveInteger</code> was a bit hasty (https://github.com/qt4cg/qtspecs/pull/1131#issuecomment-2051379262):</p>
<p>To be consistent, numerous other expressions and functions would need to be rewritten as well to use stricter types (arbitrary examples: the <code>count</code> clause; <code>$err:line-number</code> in the catch clause; the result type of <code>fn:string-to-codepoints</code>; positions in <code>array:get</code>, <code>fn:parse-integer</code>, etc.; the position parameter in HOF functions, and so on and on). We haven’t done so yet, and I seriously wonder what exactly we would win from the stricter types. In many cases, it would be reasonable to also define a strict upper limit, which is not possible with our types anyway.</p>
<p>Implementations may build heavily on the fact that <code>xs:integer</code> has been the default type for integer values in previous versions of the languages. For example, we use cached instances for the most small integer values, or we rewrite constructs with <code>xs:integer</code> to other constructs accepting the same type.</p>
<p>For all these challenges, as always, technical solutions exist, but the question is if there aren’t more interesting things to focus on than on such corner cases. Queries like <code>count(1 to 1000000000000)</code> are not supported by all implementations either although they may appear trivial to the ordinary user (by coincidence, it’s supported by BaseX, but I doubt it has been used a lot).</p>
<p>In short, I would like us to revert the change in https://github.com/qt4cg/qtspecs/pull/1131/commits/bba6e4f1067e0ef0779688622a58320a5298d440 and stick with <code>xs:integer</code>. If people feel bad about it, I would suggest discussing strict types in a much broader and general way.</p>
</div></details></div>
<div class="toot" id="created-1161"><h2>Issue #1161 created<span class="toot-id"> #created-1161</span></h2><div class="pubdate">18 Apr at 07:49:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1161">https://github.com/qt4cg/qtspecs/issues/1161</a></div><details><summary>More changes to drop the requirement for document-uri() uniqueness</summary><div class="markup"><p>Issue #898 was about dropping this constraint that document-uri()s had to be unique and PR #905 was adopted to resolve it. However, I see that the the XPath specification still contains the following note:</p>
<blockquote>
<p>Note:</p>
<p>This means that given a document node $N, the result of fn:doc(fn:document-uri($N)) is $N will always be true, unless fn:document-uri($N) is an empty sequence.</p>
</blockquote>
<p>I don't believe that applies any longer, so it should be removed.</p>
<p>It's possible that we need to finesse the description of <em>available documents</em> as well. The current description was clearly written from the perspective that document URIs would be unique and there'd be a 1:1 mapping from URIs to documents.</p>
</div></details></div>
<div class="toot" id="minutes-04-16"><h2>QT4 CG meeting 073 draft minutes<span class="toot-id"> #minutes-04-16</span></h2><div class="pubdate">16 Apr at 17:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/04-16">https://qt4cg.org/meeting/minutes/2024/04-16</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-1160"><h2>Issue #1160 created<span class="toot-id"> #created-1160</span></h2><div class="pubdate">16 Apr at 17:38:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1160">https://github.com/qt4cg/qtspecs/issues/1160</a></div><details><summary>fn:is-collation-available</summary><div class="markup"><p>The new function <strong><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-collation">fn:collation</a></strong> raises an error [<a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#ERRFOCH0002">err:FOCH0002</a>]  in the case when the requested collation is not supported. Or, if the <code>fallback</code> key's value is <code>true()</code>, then the implementation chooses "the most similar supported collation" - which could be perceived as arbitrary and unexpected by the code developer.</p>
<p>This might be OK if the language has try/catch capabilities and <code>fallback="no"</code>  is specified, but may not be the best outcome in a pure XPath evaluation.</p>
<p>A solution to this problem is to provide a function <strong>fn:is-collation-available</strong> that accepts the same argument (<code>$options</code> map) as <code>fn:collation</code>, and also could accept a string argument whose value is the URI of the collation. This function produces a boolean, <code>true()</code> meaning that the collation is available and can be constructed and used, <code>false()</code> - otherwise.</p>
<p><strong>Signature</strong></p>
<p><code>fn:is-collation-available( $descriptor  as&nbsp;xs:string | map(*)  )&nbsp;as&nbsp;xs:boolean</code></p>
</div></details></div>
<div class="toot" id="closed-1140"><h2>Issue #1140 closed<span class="toot-id"> #closed-1140</span></h2><div class="pubdate">16 Apr at 16:31:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1140">https://github.com/qt4cg/qtspecs/issues/1140</a></div><p>Use $target instead of $search for indexing functions</p></div>
<div class="toot" id="closed-1141"><h2>Issue #1141 closed<span class="toot-id"> #closed-1141</span></h2><div class="pubdate">16 Apr at 16:31:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1141">https://github.com/qt4cg/qtspecs/pull/1141</a></div><p>1140 Replace 'search' with 'target' for indexing functions</p></div>
<div class="toot" id="closed-1147"><h2>Issue #1147 closed<span class="toot-id"> #closed-1147</span></h2><div class="pubdate">16 Apr at 16:28:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1147">https://github.com/qt4cg/qtspecs/pull/1147</a></div><p>QT4CG-072-01 Clarify schema type terminology</p></div>
<div class="toot" id="closed-1142"><h2>Issue #1142 closed<span class="toot-id"> #closed-1142</span></h2><div class="pubdate">16 Apr at 16:25:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1142">https://github.com/qt4cg/qtspecs/issues/1142</a></div><p>fn:deep-equal: items-equal</p></div>
<div class="toot" id="closed-1150"><h2>Issue #1150 closed<span class="toot-id"> #closed-1150</span></h2><div class="pubdate">16 Apr at 16:25:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1150">https://github.com/qt4cg/qtspecs/pull/1150</a></div><p>1142 Drop restriction disallowing items-equal with unordered</p></div>
<div class="toot" id="closed-1138"><h2>Issue #1138 closed<span class="toot-id"> #closed-1138</span></h2><div class="pubdate">16 Apr at 16:22:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1138">https://github.com/qt4cg/qtspecs/issues/1138</a></div><p>format-number arguments</p></div>
<div class="toot" id="closed-1151"><h2>Issue #1151 closed<span class="toot-id"> #closed-1151</span></h2><div class="pubdate">16 Apr at 16:22:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1151">https://github.com/qt4cg/qtspecs/pull/1151</a></div><p>1138 Merge format and format-name params of format-number</p></div>
<div class="toot" id="closed-1152"><h2>Issue #1152 closed<span class="toot-id"> #closed-1152</span></h2><div class="pubdate">16 Apr at 16:18:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1152">https://github.com/qt4cg/qtspecs/pull/1152</a></div><p>1146 Inline change log</p></div>
<div class="toot" id="closed-115"><h2>Issue #115 closed<span class="toot-id"> #closed-115</span></h2><div class="pubdate">16 Apr at 16:12:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/115">https://github.com/qt4cg/qtspecs/issues/115</a></div><p>Lookup operator on arrays of maps</p></div>
<div class="toot" id="closed-298"><h2>Issue #298 closed<span class="toot-id"> #closed-298</span></h2><div class="pubdate">16 Apr at 16:12:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/298">https://github.com/qt4cg/qtspecs/issues/298</a></div><p>Abstract supertype for map and array</p></div>
<div class="toot" id="closed-397"><h2>Issue #397 closed<span class="toot-id"> #closed-397</span></h2><div class="pubdate">16 Apr at 16:12:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/397">https://github.com/qt4cg/qtspecs/issues/397</a></div><p>Type names</p></div>
<div class="toot" id="closed-836"><h2>Issue #836 closed<span class="toot-id"> #closed-836</span></h2><div class="pubdate">16 Apr at 16:12:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/836">https://github.com/qt4cg/qtspecs/issues/836</a></div><p>Add support for CSV 'dialect' features covered by the OKFN's Frictionless Data CSV spec in `fn:parse-csv` and related functions</p></div>
<div class="toot" id="closed-1115"><h2>Issue #1115 closed<span class="toot-id"> #closed-1115</span></h2><div class="pubdate">16 Apr at 16:12:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1115">https://github.com/qt4cg/qtspecs/issues/1115</a></div><p>XSLT - ability to call a function from xslt (not just xpath)</p></div>
<div class="toot" id="closed-1154"><h2>Issue #1154 closed<span class="toot-id"> #closed-1154</span></h2><div class="pubdate">16 Apr at 16:10:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1154">https://github.com/qt4cg/qtspecs/issues/1154</a></div><p>[xsl:item-type] error in sample</p></div>
<div class="toot" id="closed-1156"><h2>Issue #1156 closed<span class="toot-id"> #closed-1156</span></h2><div class="pubdate">16 Apr at 16:10:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1156">https://github.com/qt4cg/qtspecs/pull/1156</a></div><p>Fix error in XSLT example</p></div>
<div class="toot" id="closed-1084"><h2>Issue #1084 closed<span class="toot-id"> #closed-1084</span></h2><div class="pubdate">16 Apr at 16:10:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1084">https://github.com/qt4cg/qtspecs/issues/1084</a></div><p>Incorrect rendition of option defaults</p></div>
<div class="toot" id="closed-1149"><h2>Issue #1149 closed<span class="toot-id"> #closed-1149</span></h2><div class="pubdate">16 Apr at 16:10:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1149">https://github.com/qt4cg/qtspecs/pull/1149</a></div><p>1084 Add fos:default-description to support prose descriptions of defaults</p></div>
<div class="toot" id="created-1159"><h2>Issue #1159 created<span class="toot-id"> #created-1159</span></h2><div class="pubdate">15 Apr at 22:41:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1159">https://github.com/qt4cg/qtspecs/issues/1159</a></div><details><summary>Filter operator for arrays</summary><div class="markup"><p>I propose to provide <code>?[...]</code> as a filter operator for arrays.</p>
<p>For example,</p>
<pre><code>let $array := [(1,2,3), (4,5,6,7)]
return $array?[count(.) = 4]
</code></pre>
<p>returns</p>
<p><code>[(4,5,6,7)]</code></p>
<p>I propose that the operator should work exactly like the familiar <code>[]</code> for sequences in its handling of numeric and boolean predicate values. So for example $array?[2,1] in the above example returns <code>[(4,5,6,7), (1,2,3)]</code>. The result is always an array (which may be a little surprising). This means that <code>$array?[3]</code> has the same effect as <code>[$array?3]</code> or <code>[$array(3)]</code>.</p>
</div></details></div>
<div class="toot" id="created-1158"><h2>Issue #1158 created<span class="toot-id"> #created-1158</span></h2><div class="pubdate">15 Apr at 22:33:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1158">https://github.com/qt4cg/qtspecs/issues/1158</a></div><details><summary>Simple mapping operator for arrays</summary><div class="markup"><p>I propose to provide <code>!!</code> as a simple mapping operator for arrays.</p>
<p>For example <code>[(1,2,3), (4.5.6)]!!count(.)</code> returns <code>[3, 3]</code>.</p>
<p>The expression on the LHS must be an array.</p>
<p>The expression on the RHS is evaluated once for every member of the array, with that member as the context value, with the context position set to the position of that member in the array, and with the context size set to the array size.</p>
<p>The result is returned as an array which will always be the same size as the input array.</p>
<p>Note in passing that this provides a solution (though perhaps a clumsy solution) to issue #755, in that the example expression</p>
<p><code>(0 to 4) ~ count(.)</code></p>
<p>can now be written as <code>[(0 to 4)]!!count(.)?*</code></p>
</div></details></div>
<div class="toot" id="created-1157"><h2>Pull request #1157 created<span class="toot-id"> #created-1157</span></h2><div class="pubdate">15 Apr at 17:23:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1157">https://github.com/qt4cg/qtspecs/pull/1157</a></div><details><summary>1135 Correction to definition of focus functions</summary><div class="markup"><p>Fix #1135</p>
</div></details></div>
<div class="toot" id="created-1156"><h2>Pull request #1156 created<span class="toot-id"> #created-1156</span></h2><div class="pubdate">15 Apr at 17:06:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1156">https://github.com/qt4cg/qtspecs/pull/1156</a></div><details><summary>Fix error in XSLT example</summary><div class="markup"><p>Fix #1154</p>
</div></details></div>
<div class="toot" id="agenda-04-16"><h2>QT4 CG meeting 073 draft agenda<span class="toot-id"> #agenda-04-16</span></h2><div class="pubdate">15 Apr at 12:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/04-16">https://qt4cg.org/meeting/agenda/2024/04-16</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1155"><h2>Issue #1155 created<span class="toot-id"> #created-1155</span></h2><div class="pubdate">15 Apr at 12:05:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1155">https://github.com/qt4cg/qtspecs/issues/1155</a></div><details><summary>Glossary formatting</summary><div class="markup"><p>The format of the glossary for the data model spec differs needlessly from the other specifications. (Note, linking from the glossary entry to the place where the term is defined seems useful.)</p>
</div></details></div>
<div class="toot" id="created-1154"><h2>Issue #1154 created<span class="toot-id"> #created-1154</span></h2><div class="pubdate">14 Apr at 19:41:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1154">https://github.com/qt4cg/qtspecs/issues/1154</a></div><details><summary>[xsl:item-type] error in sample</summary><div class="markup"><p>Here : https://qt4cg.org/specifications/xslt-40/Overview-diff.html#named-item-types</p>
<p>First sample is</p>
<pre><code>&lt;xsl:item-type name="cx:complex" as="record(r as xs:double, i as xs:double)"/&gt;

&lt;xsl:variable name="i" as="cx:complex" select="cx:number(0, 1)"/&gt;
</code></pre>
<p><code>xsl:variable/@select</code> should probably be <code>cx:complex(0, 1)</code> instead of <code>cx:number</code></p>
</div></details></div>
<div class="toot" id="created-1153"><h2>Issue #1153 created<span class="toot-id"> #created-1153</span></h2><div class="pubdate">14 Apr at 15:05:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1153">https://github.com/qt4cg/qtspecs/issues/1153</a></div><details><summary>XSLT: debugging template rule selection</summary><div class="markup"><p>The biggest headache when debugging XSLT stylesheets is working out which template rules have been invoked in response to an <code>xsl:apply-templates</code> instruction (I'm hitting this frustration right now with the qtspecs build stylesheets...). The <code>xsl:message</code> instruction is unhelpful here, because if the "wrong" template rule is firing, you don't know where to add the message. And the only other standardised debugging aids are <code>fn:trace()</code> and <code>xsl:assert</code>, which don't help either.</p>
<p>I propose an attribute on <code>xsl:apply-templates</code>, <code>xsl:apply-imports</code>, and <code>xsl:next-match</code>: trace=yes|no. If enabled, execution of the instruction causes a message to be output (as if by xsl:message) identifying the rule that is invoked, in an implementation-defined way. In the case that a built-in template rule is invoked, the message should indicate this, and any implicit apply-templates performed by the built-in rule should be evaluated as if it specified trace="yes". It is "recommended" that the message output should identify the stylesheet module, line number, match pattern, and mode, if the information is available, and should also include a representation of the item that is being processed by the instruction, for example the node kind and name.</p>
</div></details></div>
<div class="toot" id="created-1152"><h2>Pull request #1152 created<span class="toot-id"> #created-1152</span></h2><div class="pubdate">13 Apr at 07:35:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1152">https://github.com/qt4cg/qtspecs/pull/1152</a></div><details><summary>1146 Inline change log</summary><div class="markup"><p>This is a first cut at changes to introduce an inline change log - changes shown at the start of each affected section, with a flag in the TOC to indicate which sections have changed.</p>
<p>It is currently applied, for demonstration purposes, to changes made in the serialization spec.</p>
<p>More specifically:</p>
<ul>
<li>Added the <code>changes</code> and <code>change</code> elements to the DTD; <code>changes</code> is an optional element that follows <code>head</code> within any section</li>
<li>Changed the XSLT stylesheets and CSS to render the <code>changes</code> element, and to add a flag to the TOC entry if a <code>changes</code> element is present</li>
<li>Added specimen <code>changes</code> elements to the seriallization spec</li>
</ul>
<p>There's a lot more to be done:</p>
<ul>
<li>Generate an aggregated list of changes in an appendix</li>
<li>Improve the CSS rendition</li>
<li>Toggle change markings on and off; browse forward and backward through changed sections</li>
<li>Add the <code>changes</code> data to the other specs</li>
</ul>
</div></details></div>
<div class="toot" id="created-1151"><h2>Pull request #1151 created<span class="toot-id"> #created-1151</span></h2><div class="pubdate">12 Apr at 18:14:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1151">https://github.com/qt4cg/qtspecs/pull/1151</a></div><details><summary>1138 Merge format and format-name params of format-number</summary><div class="markup"><p>close #1138</p>
<p>Note, the proposal could do with further editorial work to use standard <code>options</code> markup to define the options available.</p>
</div></details></div>
<div class="toot" id="created-1150"><h2>Pull request #1150 created<span class="toot-id"> #created-1150</span></h2><div class="pubdate">12 Apr at 17:51:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1150">https://github.com/qt4cg/qtspecs/pull/1150</a></div><details><summary>1142 Drop restriction disallowing items-equal with unordered</summary><div class="markup"><p>Allows the use of an items-equal callback even when comparisons are unordered, despite the fact that this may have atrocious performance.</p>
<p>close #1142</p>
</div></details></div>
<div class="toot" id="created-1149"><h2>Pull request #1149 created<span class="toot-id"> #created-1149</span></h2><div class="pubdate">12 Apr at 14:53:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1149">https://github.com/qt4cg/qtspecs/pull/1149</a></div><details><summary>1084 Add fos:default-description to support prose descriptions of defaults</summary><div class="markup"><p>Close #1084</p>
<p>This won't render correctly in the PR, but hopefully the diff is clear enough to decide if this is the approach we want to take.</p>
</div></details></div>
<div class="toot" id="created-1148"><h2>Pull request #1148 created<span class="toot-id"> #created-1148</span></h2><div class="pubdate">12 Apr at 14:45:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1148">https://github.com/qt4cg/qtspecs/pull/1148</a></div><details><summary>1143 Coercion rules: handle choice types before atomization</summary><div class="markup"><p>Fix #1143</p>
</div></details></div>
<div class="toot" id="created-1147"><h2>Pull request #1147 created<span class="toot-id"> #created-1147</span></h2><div class="pubdate">12 Apr at 14:12:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1147">https://github.com/qt4cg/qtspecs/pull/1147</a></div><details><summary>QT4CG-072-01 Clarify schema type terminology</summary><div class="markup"><p>Responding to an action from the review of PR #1132, this editorial PR attempts to improve the definitions and usage of terms such as "schema type", "atomic type", "pure union type", "generalized atomic type".</p>
</div></details></div>
<div class="toot" id="closed-796"><h2>Issue #796 closed<span class="toot-id"> #closed-796</span></h2><div class="pubdate">12 Apr at 11:41:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/796">https://github.com/qt4cg/qtspecs/issues/796</a></div><p>allow explicit type expressions in XPath variable bindings</p></div>
<div class="toot" id="closed-1131"><h2>Issue #1131 closed<span class="toot-id"> #closed-1131</span></h2><div class="pubdate">12 Apr at 11:41:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1131">https://github.com/qt4cg/qtspecs/pull/1131</a></div><p>796,231 - Extend XPath for and let expressions</p></div>
<div class="toot" id="created-1146"><h2>Issue #1146 created<span class="toot-id"> #created-1146</span></h2><div class="pubdate">12 Apr at 08:57:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1146">https://github.com/qt4cg/qtspecs/issues/1146</a></div><details><summary>Identifying 4.0 Changes</summary><div class="markup"><p>The list of changes in an appendix is (a) difficult to maintain (with a tendency to cause Git conflicts) and (b) remote from the places in the spec where the changes actually arise. At the same time, automated diff markup tends to give a lot of unwanted detail, highlighting changes that are purely editorial.</p>
<p>I propose that we try out an alternative approach. Each section/subsection with significant changes should start with an info box listing the changes, headed "Changes in 4.0". This should be rendered with a distinct colour or border to make it recognisable, and it should be possible to toggle whether the changes are shown or hidden. Changes that represent an incompatibility should be specially marked, perhaps with a device such as a warning triangle. A Δ marker (or colour highlighting) could appear in the table of contents against any section that has a <code>changes</code> entry.</p>
<p>Internally, the changes should be identified with custom markup: I suggest an optional <code>&lt;changes&gt;</code> element immediately after <code>&lt;head&gt;</code>, with a sequence of <code>&lt;change&gt;</code> children, each of which should contain administrative metadata (such as a link to the issue and/or PR) as well as user-readable text.</p>
<p>For changes to F+O functions, corresponding elements should be added to the FOS catalog schema; this should replace (or generate) the current "History" section.</p>
</div></details></div>
<div class="toot" id="closed-1145"><h2>Issue #1145 closed<span class="toot-id"> #closed-1145</span></h2><div class="pubdate">12 Apr at 08:19:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1145">https://github.com/qt4cg/qtspecs/issues/1145</a></div><p>Array Decomposition</p></div>
<div class="toot" id="closed-1144"><h2>Issue #1144 closed<span class="toot-id"> #closed-1144</span></h2><div class="pubdate">12 Apr at 08:18:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1144">https://github.com/qt4cg/qtspecs/issues/1144</a></div><p>Sequence Decomposition</p></div>
<div class="toot" id="created-1145"><h2>Issue #1145 created<span class="toot-id"> #created-1145</span></h2><div class="pubdate">12 Apr at 07:54:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1145">https://github.com/qt4cg/qtspecs/issues/1145</a></div><details><summary>Array Decomposition</summary><div class="markup"><p>This proposal allows arrays to be decomposed and assigned to separate variables in a single declaration within a for or let expression binding.</p>
<p>Given an array such as <code>[1, 2, 3]</code>, the values within that array cannot easily be extracted. With the current version of XPath and XQuery, they need to be assigned to a temporary variable first. For example:</p>
<pre><code>let $result := get-camera-point()
let $x := $result?(1)
let $y := $result?(2)
let $z := $result?(3)
return "(" || $x || "," || $y || "," || $z || ")"
</code></pre>
<p>This proposal would allow this to be written more concisely as:</p>
<pre><code>let [$x, $y, $z] := get-camera-point()
return "(" || $x || "," || $y || "," || $z || ")"
</code></pre>
<p>These are equivalent in this proposal, except that <code>$result</code> is not a statically known variable binding in the array decomposition let clause.</p>
<blockquote>
<p>Note: The older syntax in <a href="https://github.com/expath/xpath-ng/pull/8">XPath-NG</a> was:</p>
<p>let $[x, y, z] := get-camera-point()
return "(" || $x || "," || $y || "," || $z || ")"</p>
</blockquote>
<p>For each variable declaration in the array decomposition at index <code>N</code>, and <code>$expr</code> being the result of the for/let expression, then <code>$expr?(N)</code> is the value bound to the variable declaration as a new variable binding. If the value does not exist, an <code>err:FOAY0001</code> (array index out of bounds) error will be raised.</p>
<p>An array decomposition can be used in any for or let clause binding to decompose the items in an array. If the type of the for or let clause binding expression is not a sequence, an <code>err:XPTY0004</code> error is raised.</p>
<h3>Assigning the rest of an array</h3>
<p>It can be useful to only extract part of an array (e.g. the heading of a table), and store the rest of the items in another variable. For example:</p>
<pre><code>let $(heading as array(xs:string), rows as array(xs:string)...) :=
    load-csv("test.csv")
</code></pre>
<p>If there are no items remaining in the array the result is an empty array.</p>
<h3>Influences</h3>
<p>Tuple decomposition is found in various languages such as Python, Scala, and C#. These languages also have support for tuple types.</p>
<p>Python has support for specifying that a variable is assigned the remaining values in the tuple.</p>
<h2>Use Cases</h2>
<p>There are many cases where fixed size sequences may be used such as points, complex and rational numbers, sin/cos, and mul/div. This makes extracting data from these simpler, and may also be used to aid readability by assigning descriptive names to each of the items in the sequence.</p>
<h2>Examples</h2>
<p>Extracting values from an array:</p>
<pre><code>declare function sincos($angle as xs:double?) {
    [ math:sin($angle), math:cos($angle) ]
};

let $angle := math:pi()
let [$sin, $cos] := sincos($angle)
return $sin || "," || $cos
</code></pre>
</div></details></div>
<div class="toot" id="created-1144"><h2>Issue #1144 created<span class="toot-id"> #created-1144</span></h2><div class="pubdate">12 Apr at 07:47:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1144">https://github.com/qt4cg/qtspecs/issues/1144</a></div><details><summary>Sequence Decomposition</summary><div class="markup"><p>This proposal allows sequences to be decomposed and assigned to separate variables in a single declaration within a for or let expression binding.</p>
<p>Given a sequence such as <code>(1, 2, 3)</code>, the values within that sequence cannot easily be extracted. With the current version of XPath and XQuery, they need to be assigned to a temporary variable first. For example:</p>
<pre><code>let $result := get-camera-point()
let $x := $result[1]
let $y := $result[2]
let $z := $result[3]
return "(" || $x || "," || $y || "," || $z || ")"
</code></pre>
<p>This proposal would allow this to be written more concisely as:</p>
<pre><code>let ($x, $y, $z) := get-camera-point()
return "(" || $x || "," || $y || "," || $z || ")"
</code></pre>
<p>These are equivalent in this proposal, except that <code>$result</code> is not a statically known variable binding in the sequence decomposition let clause.</p>
<blockquote>
<p>Note: The older syntax in <a href="https://github.com/expath/xpath-ng/pull/8">XPath-NG</a> was:</p>
<p>let $(x, y, z) := get-camera-point()
return "(" || $x || "," || $y || "," || $z || ")"</p>
</blockquote>
<p>For each variable declaration in the sequence decomposition at index <code>N</code>, and <code>$expr</code> being the result of the for/let expression, then <code>$expr[N]</code> is the value bound to the variable declaration as a new variable binding. If the value does not exist, an empty sequence is bound to the variable.</p>
<p>A sequence decomposition can be used in any for or let clause binding to decompose the items in a sequence. If the type of the for or let clause binding expression is not a sequence, an <code>err:XPTY0004</code> error is raised.</p>
<h3>Assigning the rest of a sequence</h3>
<p>It can be useful to only extract part of a sequence or array (e.g. the heading of a table), and store the rest of the items in another variable. For example:</p>
<pre><code>let $(heading, rows ...) := fn:parse-csv("test.csv")
</code></pre>
<p>If there are no items remaining in the sequence the result is an empty sequence.</p>
<h3>Influences</h3>
<p>Tuple decomposition is found in various languages such as Python, Scala, and C#. These languages also have support for tuple types.</p>
<p>Python has support for specifying that a variable is assigned the remaining values in the tuple.</p>
<h2>Use Cases</h2>
<p>There are many cases where fixed size sequences may be used such as points, complex and rational numbers, sin/cos, and mul/div. This makes extracting data from these simpler, and may also be used to aid readability by assigning descriptive names to each of the items in the sequence.</p>
<h2>Examples</h2>
<p>Extracting values from a sequence:</p>
<pre><code>declare function sincos($angle as xs:double?) {
    math:sin($angle), math:cos($angle)
};

let $angle := math:pi()
let ($sin, $cos) := sincos($angle)
return $sin || "," || $cos
</code></pre>
</div></details></div>
<div class="toot" id="closed-983"><h2>Issue #983 closed<span class="toot-id"> #closed-983</span></h2><div class="pubdate">12 Apr at 06:33:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/983">https://github.com/qt4cg/qtspecs/issues/983</a></div><p>fn:reduce (or fn:fold without initial value)</p></div>
<div class="toot" id="created-1143"><h2>Issue #1143 created<span class="toot-id"> #created-1143</span></h2><div class="pubdate">11 Apr at 21:52:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1143">https://github.com/qt4cg/qtspecs/issues/1143</a></div><details><summary>Coercion Rules for Choice Item Types</summary><div class="markup"><p>The proposal that we accepted for choice item types (PR #1132) invokes atomization only if the choice type is a generalised atomic type, that is, if all alternatives in the choice are atomic.</p>
<p>This makes it tricky to take advantage of choice types for extending existing functions in a backwards-compatible way. For example, we might want to change the second argument of fn:unparsed-text from <code>$encoding as xs:string</code> to <code>$options as (xs:string | map(*))</code>. But under the current rules, this means the supplied value of the $encoding argument will no longer be atomized.</p>
<p>I propose to change this by effectively promoting rule 3 to appear before rule 2. Rule 2 is the atomization rule, and rule 3 is the new rule:</p>
<blockquote>
<p>If R is a [choice item type] <em>that is not a [generalized atomic type]</em>, then the following rules are applied with R set to each of the alternatives in the choice item type, in order, until an alternative is found that does not result in a type error; a type error is raised only if all alternatives fail.</p>
</blockquote>
<p>The phrase in italics is deleted.</p>
<p>The effect is that if the required type is <code>(xs:string | map(*))</code> then we first try converting the supplied argument as if the required type were <code>xs:string</code> (including atomization), and if that fails we try converting it as if the required type were map(*).</p>
</div></details></div>
<div class="toot" id="closed-231"><h2>Issue #231 closed<span class="toot-id"> #closed-231</span></h2><div class="pubdate">11 Apr at 21:35:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/231">https://github.com/qt4cg/qtspecs/issues/231</a></div><p>for expression: "at" keyword</p></div>
<div class="toot" id="closed-1139"><h2>Issue #1139 closed<span class="toot-id"> #closed-1139</span></h2><div class="pubdate">11 Apr at 21:34:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1139">https://github.com/qt4cg/qtspecs/issues/1139</a></div><p>let clause: function coercion</p></div>
<div class="toot" id="closed-788"><h2>Issue #788 closed<span class="toot-id"> #closed-788</span></h2><div class="pubdate">11 Apr at 21:31:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/788">https://github.com/qt4cg/qtspecs/issues/788</a></div><p>New function fn:annotate()</p></div>
<div class="toot" id="closed-1105"><h2>Issue #1105 closed<span class="toot-id"> #closed-1105</span></h2><div class="pubdate">11 Apr at 21:20:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1105">https://github.com/qt4cg/qtspecs/issues/1105</a></div><p>Casting to numerical type from strings with underscores</p></div>
<div class="toot" id="closed-67"><h2>Issue #67 closed<span class="toot-id"> #closed-67</span></h2><div class="pubdate">11 Apr at 21:18:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/67">https://github.com/qt4cg/qtspecs/issues/67</a></div><p>Allow optional parameters and keyword arguments on map and sequence variadic functions.</p></div>
<div class="toot" id="closed-132"><h2>Issue #132 closed<span class="toot-id"> #closed-132</span></h2><div class="pubdate">11 Apr at 21:17:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/132">https://github.com/qt4cg/qtspecs/issues/132</a></div><p>Clarify if redirects should be followed</p></div>
<div class="toot" id="closed-613"><h2>Issue #613 closed<span class="toot-id"> #closed-613</span></h2><div class="pubdate">11 Apr at 21:16:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/613">https://github.com/qt4cg/qtspecs/issues/613</a></div><p>Allow "union" as synonym for "|" everywhere</p></div>
<div class="toot" id="closed-666"><h2>Issue #666 closed<span class="toot-id"> #closed-666</span></h2><div class="pubdate">11 Apr at 21:16:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/666">https://github.com/qt4cg/qtspecs/issues/666</a></div><p>Polyfill function implementations</p></div>
<div class="toot" id="closed-713"><h2>Issue #713 closed<span class="toot-id"> #closed-713</span></h2><div class="pubdate">11 Apr at 21:15:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/713">https://github.com/qt4cg/qtspecs/issues/713</a></div><p>Annotations: Editorial notes</p></div>
<div class="toot" id="closed-834"><h2>Issue #834 closed<span class="toot-id"> #closed-834</span></h2><div class="pubdate">11 Apr at 21:14:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/834">https://github.com/qt4cg/qtspecs/issues/834</a></div><p>Add creation function for `csv-row-record` type</p></div>
<div class="toot" id="created-1142"><h2>Issue #1142 created<span class="toot-id"> #created-1142</span></h2><div class="pubdate">11 Apr at 11:51:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1142">https://github.com/qt4cg/qtspecs/issues/1142</a></div><details><summary>fn:deep-equal: items-equal</summary><div class="markup"><p>The current spec says about <code>items-equal</code> that…</p>
<blockquote>
<p>If this option is present then the <code>ordered</code> option MUST be <code>true</code> and the <code>unordered-elements</code> option MUST be an empty sequence.</p>
</blockquote>
<p>I doesn’t say what is going to happen if <code>ordered</code> is <code>false</code> or if <code>unordered-elements</code> is non-empty.</p>
<p>My preference would be to allow all combinations; we could then do things like:</p>
<pre><code class="language-xquery">deep-equal(
  (1, 2, 3),
  (3.1, 2.1, 1.1),
  { 'ordered': false(), 'items-equal': fn($a, $b) { xs:integer($a) = xs:integer($b) } }
)
</code></pre>
<p>It may imply O(n²), but it’s very simple to formulate other XPath expressions with the same complexity, such as <code>$huge1[. = $huge2]</code>.</p>
</div></details></div>
<div class="toot" id="created-1141"><h2>Pull request #1141 created<span class="toot-id"> #created-1141</span></h2><div class="pubdate">10 Apr at 09:07:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1141">https://github.com/qt4cg/qtspecs/pull/1141</a></div><details><summary>1140 Replace 'search' with 'target' for indexing functions</summary><div class="markup"><p>Close #1140</p>
<p>Having created the issue, per my outstanding action, I thought I'd take a quick look to see how extensive the change would be. AFAICT (though I confess to not looking exceedingly carefully), only two functions are effected. Here, for your consideration, is a PR that resolves the issue.</p>
</div></details></div>
<div class="toot" id="created-1140"><h2>Issue #1140 created<span class="toot-id"> #created-1140</span></h2><div class="pubdate">10 Apr at 08:59:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1140">https://github.com/qt4cg/qtspecs/issues/1140</a></div><details><summary>Use $target instead of $search for indexing functions</summary><div class="markup"><p>Back in February, when we discussed <code>array:index-of</code>, DN observed that the argument name <code>$search</code> could be interpreted as performing some sort of action. The alternative <code>$target</code> was proposed instead as being more "noun like".</p>
</div></details></div>
<div class="toot" id="minutes-04-09"><h2>QT4 CG meeting 072 draft minutes<span class="toot-id"> #minutes-04-09</span></h2><div class="pubdate">09 Apr at 17:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/04-09">https://qt4cg.org/meeting/minutes/2024/04-09</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1093"><h2>Issue #1093 closed<span class="toot-id"> #closed-1093</span></h2><div class="pubdate">09 Apr at 16:32:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1093">https://github.com/qt4cg/qtspecs/pull/1093</a></div><p>1091 Add fn:collation function</p></div>
<div class="toot" id="closed-1091"><h2>Issue #1091 closed<span class="toot-id"> #closed-1091</span></h2><div class="pubdate">09 Apr at 16:32:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1091">https://github.com/qt4cg/qtspecs/issues/1091</a></div><p>Convenience function to construct a collation URI</p></div>
<div class="toot" id="closed-99"><h2>Issue #99 closed<span class="toot-id"> #closed-99</span></h2><div class="pubdate">09 Apr at 16:29:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/99">https://github.com/qt4cg/qtspecs/issues/99</a></div><p>Functions that determine equality of two sequences or equality of two arrays</p></div>
<div class="toot" id="closed-1063"><h2>Issue #1063 closed<span class="toot-id"> #closed-1063</span></h2><div class="pubdate">09 Apr at 16:29:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1063">https://github.com/qt4cg/qtspecs/issues/1063</a></div><p>deep-equal() - option to compare functions liberally</p></div>
<div class="toot" id="closed-1120"><h2>Issue #1120 closed<span class="toot-id"> #closed-1120</span></h2><div class="pubdate">09 Apr at 16:29:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1120">https://github.com/qt4cg/qtspecs/pull/1120</a></div><p>99v2 deep equal with callback</p></div>
<div class="toot" id="closed-122"><h2>Issue #122 closed<span class="toot-id"> #closed-122</span></h2><div class="pubdate">09 Apr at 16:26:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/122">https://github.com/qt4cg/qtspecs/issues/122</a></div><p>Support general union sequence types</p></div>
<div class="toot" id="closed-1132"><h2>Issue #1132 closed<span class="toot-id"> #closed-1132</span></h2><div class="pubdate">09 Apr at 16:26:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1132">https://github.com/qt4cg/qtspecs/pull/1132</a></div><p>122 Choice item types (generalizing local union types)</p></div>
<div class="toot" id="closed-1112"><h2>Issue #1112 closed<span class="toot-id"> #closed-1112</span></h2><div class="pubdate">09 Apr at 16:23:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1112">https://github.com/qt4cg/qtspecs/pull/1112</a></div><p>1110-partial New error codes</p></div>
<div class="toot" id="closed-1118"><h2>Issue #1118 closed<span class="toot-id"> #closed-1118</span></h2><div class="pubdate">09 Apr at 16:20:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1118">https://github.com/qt4cg/qtspecs/issues/1118</a></div><p>Use new map{} syntax in adaptive output method</p></div>
<div class="toot" id="closed-1123"><h2>Issue #1123 closed<span class="toot-id"> #closed-1123</span></h2><div class="pubdate">09 Apr at 16:20:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1123">https://github.com/qt4cg/qtspecs/pull/1123</a></div><p>1118 Drop the "map" keyword in adaptive serialization output</p></div>
<div class="toot" id="closed-1128"><h2>Issue #1128 closed<span class="toot-id"> #closed-1128</span></h2><div class="pubdate">09 Apr at 16:17:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1128">https://github.com/qt4cg/qtspecs/pull/1128</a></div><p>1020 Further notes on the consequences of function coercion</p></div>
<div class="toot" id="closed-1133"><h2>Issue #1133 closed<span class="toot-id"> #closed-1133</span></h2><div class="pubdate">09 Apr at 16:14:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1133">https://github.com/qt4cg/qtspecs/issues/1133</a></div><p>fn:filter why predicate as map(*)</p></div>
<div class="toot" id="closed-1134"><h2>Issue #1134 closed<span class="toot-id"> #closed-1134</span></h2><div class="pubdate">09 Apr at 16:14:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1134">https://github.com/qt4cg/qtspecs/pull/1134</a></div><p>1133 Correct map:filter callback signature</p></div>
<div class="toot" id="created-1139"><h2>Issue #1139 created<span class="toot-id"> #created-1139</span></h2><div class="pubdate">09 Apr at 11:00:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1139">https://github.com/qt4cg/qtspecs/issues/1139</a></div><details><summary>let clause: function coercion</summary><div class="markup"><p>@michaelhkay I should be careful (as I regularly miss changes and additions in the 4.0 drafts), but it seems that the application of the function coercion rules for typed <code>let</code> clauses (https://qt4cg.org/specifications/xquery-40/xquery-40.html#id-binding-rules) is not mentioned in the list of substantive changes at the end of the document. Would it be useful to add it, or does this change fall into a different category?</p>
</div></details></div>
<div class="toot" id="agenda-04-09"><h2>QT4 CG meeting 072 draft agenda<span class="toot-id"> #agenda-04-09</span></h2><div class="pubdate">08 Apr at 11:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/04-09">https://qt4cg.org/meeting/agenda/2024/04-09</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1138"><h2>Issue #1138 created<span class="toot-id"> #created-1138</span></h2><div class="pubdate">07 Apr at 23:01:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1138">https://github.com/qt4cg/qtspecs/issues/1138</a></div><details><summary>format-number arguments</summary><div class="markup"><p>Given the availability of choice item types, I propose that we merge the <code>format</code> and <code>format-name</code> parameters of <code>fn:format-number</code> into a single parameter of type <code>(xs:string | xs:QName | map(*))</code>. This seems a better design when parameters are mutually exclusive and perform a related role.</p>
</div></details></div>
<div class="toot" id="created-1137"><h2>Pull request #1137 created<span class="toot-id"> #created-1137</span></h2><div class="pubdate">07 Apr at 15:27:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1137">https://github.com/qt4cg/qtspecs/pull/1137</a></div><details><summary>161 Variadic functions</summary><div class="markup"><p>Fix #161</p>
<p>This proposal attempts to do the minimum necessary to allow the variable-arity nature of the fn:concat function to be reproduced for other functions including user-defined functions. The idea is that fn:concat should no longer be treated as a special case.</p>
<p>The proposal is deliberately less ambitious than some of the ideas discussed in the referenced issue. It's generally easier to get something into the language if we take smaller steps.</p>
<p>For an overview see section 4.5.3 of the XQuery spec.</p>
</div></details></div>
<div class="toot" id="created-1136"><h2>Issue #1136 created<span class="toot-id"> #created-1136</span></h2><div class="pubdate">07 Apr at 11:34:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1136">https://github.com/qt4cg/qtspecs/issues/1136</a></div><details><summary>Defining names for parameters on typed function tests</summary><div class="markup"><p>When defining the type of a higher-order function parameter, you cannot currently specify the names of the parameters of that higher-order function.</p>
<p>Allowing this can be useful for variou reasons:</p>
<ol>
<li>documenting the parameter names in the function signature -- this makes it clear looking at the function in an IDE, etc. what the parameters are;</li>
<li>making the specs clearer by referring to the parameters by name;</li>
<li>allowing a processor to provide better error messages by referring to the parameters names, e.g. when there is a type conversion error;</li>
<li>allowing a user to reference the parameter by name if we enable this to resolve named keyword argments (which is currently being discussed in #1114).</li>
</ol>
<p>Thus, you could declare e.g. <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-index-where">index-where</a> like this:</p>
<pre><code class="language-xquery">declare function fn:index-where(
  $input as&nbsp;item()*,
  $predicate as&nbsp;function(
    $item as item(),
    $position as xs:integer
  ) as xs:boolean
)&nbsp;as&nbsp;xs:integer* {
  (: ... :)
};
</code></pre>
</div></details></div>
<div class="toot" id="created-1135"><h2>Issue #1135 created<span class="toot-id"> #created-1135</span></h2><div class="pubdate">06 Apr at 12:08:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1135">https://github.com/qt4cg/qtspecs/issues/1135</a></div><details><summary>Definition of focus functions</summary><div class="markup"><p>§5.4.2.6 states</p>
<blockquote>
<p>The expression function { EXPR } (or fn { EXPR }) is a syntactic shorthand for the expression function($Z as item()<em>) as item()</em> { $Z ! (EXPR) }, where $Z is a variable name that is otherwise unused. Note that the function body (EXPR) is evaluated with a [fixed focus]: the context position and context size will always be 1 (one).</p>
</blockquote>
<p>This is no longer true now since generalization of the context item to context value. EXPR is evaluated once with the entire sequence $Z as the context value, it is not evaluated once for each item in $Z.</p>
<p>We have no direct way of expressing this in the absence of a resolution to issue #755.</p>
</div></details></div>
<div class="toot" id="created-1134"><h2>Pull request #1134 created<span class="toot-id"> #created-1134</span></h2><div class="pubdate">05 Apr at 15:45:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1134">https://github.com/qt4cg/qtspecs/pull/1134</a></div><details><summary>1133 Correct map:filter callback signature</summary><div class="markup"><p>Fix #1133</p>
</div></details></div>
<div class="toot" id="created-1133"><h2>Issue #1133 created<span class="toot-id"> #created-1133</span></h2><div class="pubdate">05 Apr at 15:23:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1133">https://github.com/qt4cg/qtspecs/issues/1133</a></div><details><summary>fn:filter why predicate as map(*)</summary><div class="markup"><p><code>fn:filter</code> is defined like this :</p>
<pre><code>map:filter(
  $map as map(*),	
  $predicate as function(xs:anyAtomicType, item()*) as map(*)	
) as map(*)
</code></pre>
<p>Why the predicate function is not returning a <code>xs:boolean</code> ?</p>
</div></details></div>
<div class="toot" id="created-1132"><h2>Pull request #1132 created<span class="toot-id"> #created-1132</span></h2><div class="pubdate">05 Apr at 11:26:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1132">https://github.com/qt4cg/qtspecs/pull/1132</a></div><details><summary>122 Choice item types (generalizing local union types)</summary><div class="markup"><p>Fix #122.</p>
<p>Allows the new item type syntax <code>(A | B)</code>, replacing <code>union(A, B)</code>; the alternatives are no longer restricted to be atomic types. The choice item type is a generalized atomic type if and only if all the alternatives are generalized atomic types.</p>
<p>Note that #122 also proposed unions of sequence types. While that is also viable, I found that unions of item types handled pretty well all practical use cases, and it seems excessive to offer both. Unions of item types proved (a) more useful (b) easier to combine with the existing feature of local union types, and (c) easier to handle in the coercion rules. Providing both is also tricky to handle in the grammar.</p>
</div></details></div>
<div class="toot" id="closed-1044"><h2>Issue #1044 closed<span class="toot-id"> #closed-1044</span></h2><div class="pubdate">04 Apr at 08:51:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1044">https://github.com/qt4cg/qtspecs/issues/1044</a></div><p>CSV row delimiter - allowed values</p></div>
<div class="toot" id="closed-1104"><h2>Issue #1104 closed<span class="toot-id"> #closed-1104</span></h2><div class="pubdate">04 Apr at 08:49:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1104">https://github.com/qt4cg/qtspecs/issues/1104</a></div><p>TypeTest expressions</p></div>
<div class="toot" id="created-1131"><h2>Pull request #1131 created<span class="toot-id"> #created-1131</span></h2><div class="pubdate">31 Mar at 22:29:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1131">https://github.com/qt4cg/qtspecs/pull/1131</a></div><details><summary>796,231 - Extend XPath for and let expressions</summary><div class="markup"><p>Fix #796
Fix #231</p>
<p>Extends "for" and "let" expressions in XPath to allow a larger subset of XQuery FLWOR expression syntax. Specifically:</p>
<ul>
<li>Allow positional variables (<code>at $pos</code>)</li>
<li>Allow type declarations (<code>as type</code>)</li>
<li>Allow let/for clauses to be mixed without an intervening <code>return</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="closed-1122"><h2>Issue #1122 closed<span class="toot-id"> #closed-1122</span></h2><div class="pubdate">28 Mar at 14:10:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1122">https://github.com/qt4cg/qtspecs/issues/1122</a></div><p>Rendering xspecref</p></div>
<div class="toot" id="closed-1130"><h2>Issue #1130 closed<span class="toot-id"> #closed-1130</span></h2><div class="pubdate">28 Mar at 14:10:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1130">https://github.com/qt4cg/qtspecs/pull/1130</a></div><p>Fix xspecref to production</p></div>
<div class="toot" id="created-1130"><h2>Pull request #1130 created<span class="toot-id"> #created-1130</span></h2><div class="pubdate">28 Mar at 14:10:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1130">https://github.com/qt4cg/qtspecs/pull/1130</a></div><details><summary>Fix xspecref to production</summary><div class="markup"><p>Fix #1122</p>
<p>This is (apparently) the first use of an <code>xspecref</code> to a production.</p>
</div></details></div>
<div class="toot" id="closed-1129"><h2>Issue #1129 closed<span class="toot-id"> #closed-1129</span></h2><div class="pubdate">28 Mar at 13:22:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1129">https://github.com/qt4cg/qtspecs/pull/1129</a></div><p>Fix Norm's affiliation</p></div>
<div class="toot" id="created-1129"><h2>Pull request #1129 created<span class="toot-id"> #created-1129</span></h2><div class="pubdate">28 Mar at 13:22:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1129">https://github.com/qt4cg/qtspecs/pull/1129</a></div><details><summary>Fix Norm's affiliation</summary><div class="markup"><p>Someone preparing a QT4 status talk for a conference observed that my affiliation on the data model spec was out-of-date.</p>
<p>I'm just going to merge this one without any fanfare.</p>
</div></details></div>
<div class="toot" id="created-1128"><h2>Pull request #1128 created<span class="toot-id"> #created-1128</span></h2><div class="pubdate">28 Mar at 11:07:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1128">https://github.com/qt4cg/qtspecs/pull/1128</a></div><details><summary>1020 Further notes on the consequences of function coercion</summary><div class="markup"><p>Adds further notes an examples explaining the consequences of function coercion, especially when applied to maps and arrays. The new notes make it clear that test case MapTest-058 is incorrect; a map, once coerced to a function, cannot be used as a map.</p>
</div></details></div>
<div class="toot" id="created-1127"><h2>Issue #1127 created<span class="toot-id"> #created-1127</span></h2><div class="pubdate">28 Mar at 00:59:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1127">https://github.com/qt4cg/qtspecs/issues/1127</a></div><details><summary>Binary resources</summary><div class="markup"><p>We have some functions that accept binary input (parse-html, parse-csv) and others that don't (parse-xml, parse-json). There seems to be no obvious justification for the inconsistency.</p>
<p>Related to this:</p>
<p>(a) we have no functions to convert (encode/decode) between binary and string given an encoding</p>
<p>(b) we have no function to read a binary resource from a URI</p>
<p>Both of these are available in the EXPath bin library but should perhaps be promoted to the main spec.</p>
</div></details></div>
<div class="toot" id="closed-1039"><h2>Issue #1039 closed<span class="toot-id"> #closed-1039</span></h2><div class="pubdate">28 Mar at 00:24:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1039">https://github.com/qt4cg/qtspecs/issues/1039</a></div><p>Allow dynamic collations in XQuery "order by" and "group by"</p></div>
<div class="toot" id="closed-1092"><h2>Issue #1092 closed<span class="toot-id"> #closed-1092</span></h2><div class="pubdate">28 Mar at 00:24:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1092">https://github.com/qt4cg/qtspecs/pull/1092</a></div><p>1039 Add notes referring to fn:collation-key</p></div>
<div class="toot" id="closed-1100"><h2>Issue #1100 closed<span class="toot-id"> #closed-1100</span></h2><div class="pubdate">27 Mar at 23:59:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1100">https://github.com/qt4cg/qtspecs/pull/1100</a></div><p>99 fn:equal() function to compare sequences and arrays</p></div>
<div class="toot" id="closed-1113"><h2>Issue #1113 closed<span class="toot-id"> #closed-1113</span></h2><div class="pubdate">27 Mar at 22:18:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1113">https://github.com/qt4cg/qtspecs/issues/1113</a></div><p>Misleading rendering BiDi text in parse-integer example</p></div>
<div class="toot" id="closed-1126"><h2>Issue #1126 closed<span class="toot-id"> #closed-1126</span></h2><div class="pubdate">27 Mar at 14:34:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1126">https://github.com/qt4cg/qtspecs/pull/1126</a></div><p>1060 Minor fixes</p></div>
<div class="toot" id="created-1126"><h2>Pull request #1126 created<span class="toot-id"> #created-1126</span></h2><div class="pubdate">27 Mar at 14:34:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1126">https://github.com/qt4cg/qtspecs/pull/1126</a></div><details><summary>1060 Minor fixes</summary><div class="markup"><p>Whitespace, variable names, tests</p>
</div></details></div>
<div class="toot" id="closed-1121"><h2>Issue #1121 closed<span class="toot-id"> #closed-1121</span></h2><div class="pubdate">27 Mar at 14:13:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1121">https://github.com/qt4cg/qtspecs/pull/1121</a></div><p>1060 Formatting</p></div>
<div class="toot" id="created-1125"><h2>Pull request #1125 created<span class="toot-id"> #created-1125</span></h2><div class="pubdate">27 Mar at 12:26:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1125">https://github.com/qt4cg/qtspecs/pull/1125</a></div><details><summary>1094 Enhanced lookup expressions</summary><div class="markup"><p>Fix #1094</p>
<p>Lookup expressions (both deep and shallow) are enhanced in two ways:</p>
<p>(a) the syntax is extended to provide options that avoid flattening the result. For example <code>$V?pairs::K</code> delivers the result as a sequence of key-value pairs.</p>
<p>(b) a new KeySpecifier format is provided to filter the results by type. For example <code>$V??type(record(first, last))</code> selects all items in the recursive content that are of type <code>record(first, last)</code>. This replaces the previous syntax <code>$V??*::record(first, last)</code> which caused ambiguities with occurrence indicators.</p>
</div></details></div>
<div class="toot" id="closed-859"><h2>Issue #859 closed<span class="toot-id"> #closed-859</span></h2><div class="pubdate">27 Mar at 09:21:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/859">https://github.com/qt4cg/qtspecs/issues/859</a></div><p>Syntax problem with type-qualified wildcards in lookup expressions</p></div>
<div class="toot" id="closed-1106"><h2>Issue #1106 closed<span class="toot-id"> #closed-1106</span></h2><div class="pubdate">27 Mar at 09:21:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1106">https://github.com/qt4cg/qtspecs/pull/1106</a></div><p>859 lookup syntax problems</p></div>
<div class="toot" id="created-1124"><h2>Issue #1124 created<span class="toot-id"> #created-1124</span></h2><div class="pubdate">27 Mar at 08:46:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1124">https://github.com/qt4cg/qtspecs/issues/1124</a></div><details><summary>Formatting XPath/XQuery: Preferences, Conventions</summary><div class="markup"><p>In #1060, the formatting of code examples in the spec was unified. This issue is about discussing the formatting rules and (ideally) to define conventions for newly added code. If we don’t manage to define rules, the existing specs should provide enough examples for all syntactical constructs to be inspired by.</p>
<p>To start with, one suggestion in <a href="https://qt4cg.org/meeting/minutes/2024/03-26.html">yesterday’s meeting</a> was to choose a more compact presentation. Empty maps, empty arrays, and functions with an empty body are currently formatted as follows:</p>
<pre><code class="language-xquery">map { }, { },
array { }, [ ],
function { }, fn { }, fn($x) { }
</code></pre>
<p>We could remove the inner whitespace:</p>
<pre><code class="language-xquery">map {}, {},
array {}, [],
function {}, fn {}, fn($x) {}
</code></pre>
</div></details></div>
<div class="toot" id="created-1123"><h2>Pull request #1123 created<span class="toot-id"> #created-1123</span></h2><div class="pubdate">27 Mar at 08:36:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1123">https://github.com/qt4cg/qtspecs/pull/1123</a></div><details><summary>1118 Drop the "map" keyword in adaptive serialization output</summary><div class="markup"><p>Close #1118</p>
</div></details></div>
<div class="toot" id="created-1122"><h2>Issue #1122 created<span class="toot-id"> #created-1122</span></h2><div class="pubdate">27 Mar at 08:33:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1122">https://github.com/qt4cg/qtspecs/issues/1122</a></div><details><summary>Rendering xspecref</summary><div class="markup"><p>xspecref markup in the serialization spec is being rendered incorrectly. See for example</p>
<p><code>&lt;xspecref spec="XP40" ref="doc-xpath40-MapConstructor"/&gt;</code></p>
<p>in section 10, which renders as</p>
<p>A [map item] is serialized using the syntax of a [Section ] ^XP40 without ...</p>
<p>where the link to the referenced section works correctly, but the section title is not displayed.</p>
</div></details></div>
<div class="toot" id="created-1121"><h2>Pull request #1121 created<span class="toot-id"> #created-1121</span></h2><div class="pubdate">27 Mar at 08:24:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1121">https://github.com/qt4cg/qtspecs/pull/1121</a></div><details><summary>1060 Formatting</summary><div class="markup"><p>Minor editorial fixes (examples, typos). I’ll merge this after a while if no one objects.</p>
</div></details></div>
<div class="toot" id="created-1120"><h2>Pull request #1120 created<span class="toot-id"> #created-1120</span></h2><div class="pubdate">26 Mar at 23:44:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1120">https://github.com/qt4cg/qtspecs/pull/1120</a></div><details><summary>99v2 deep equal with callback</summary><div class="markup"><p>A second attempt to address issue #99</p>
<p>Replaces PR #1100</p>
<p>Fix #99
Fix #1063</p>
<p>In response to comments during the review of #1100, this PR abandons the proposed fn:equal() function and instead adds a callback option to fn:deep-equal. This can potentially be used to compare any pair of items (including maps and arrays) if desired.</p>
</div></details></div>
<div class="toot" id="created-1119"><h2>Issue #1119 created<span class="toot-id"> #created-1119</span></h2><div class="pubdate">26 Mar at 22:01:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1119">https://github.com/qt4cg/qtspecs/issues/1119</a></div><details><summary>Declare namespace bindings in XPath</summary><div class="markup"><p>We have dropped the proposed "with" expression, which was in the spec but never reviewed by the WG.</p>
<p>We need to reconsider the requirement: do we need some kind of construct to declare namespace prefixes, and perhaps other parts of the static context, in XPath?</p>
<p>One thought here is that when XPath expressions are issued from a host language such as Javascript or Python, the typical pattern is to have lots of small independent XPath expressions within a program. It doesn't make sense for each such expression to have its own boilerplate to establish the context, which will usually be the same for each expression. Rather it makes sense for the XPath invocation API to supply a reference to a context object which is set up once and reused. However, this doesn't mean that there's no room for XPath syntax to establish the context. For example, one might envisage a program doing</p>
<pre><code>XPath engine = new XPath();
engine.setStaticContext("declare namespace abc='http://abc.uri'; pqr = 'http://pqr.uri");
engine.evaluate("//x/@y");
</code></pre>
<p>so the syntax for creating the static context would be decoupled from the expression syntax.</p>
</div></details></div>
<div class="toot" id="closed-711"><h2>Issue #711 closed<span class="toot-id"> #closed-711</span></h2><div class="pubdate">26 Mar at 21:52:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/711">https://github.com/qt4cg/qtspecs/issues/711</a></div><p>Using annotations for navigation of JSON trees</p></div>
<div class="toot" id="closed-1070"><h2>Issue #1070 closed<span class="toot-id"> #closed-1070</span></h2><div class="pubdate">26 Mar at 21:31:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1070">https://github.com/qt4cg/qtspecs/issues/1070</a></div><p>Concise syntax for map construction</p></div>
<div class="toot" id="closed-1071"><h2>Issue #1071 closed<span class="toot-id"> #closed-1071</span></h2><div class="pubdate">26 Mar at 21:31:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1071">https://github.com/qt4cg/qtspecs/pull/1071</a></div><p>1070 Bare Brace map constructor syntax</p></div>
<div class="toot" id="created-1118"><h2>Issue #1118 created<span class="toot-id"> #created-1118</span></h2><div class="pubdate">26 Mar at 21:30:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1118">https://github.com/qt4cg/qtspecs/issues/1118</a></div><details><summary>Use new map{} syntax in adaptive output method</summary><div class="markup"><p>Should the adaptive output method be changed to use the new bare-brace syntax when serializing maps, dropping the <code>map</code> keyword?</p>
</div></details></div>
<div class="toot" id="closed-1019"><h2>Issue #1019 closed<span class="toot-id"> #closed-1019</span></h2><div class="pubdate">26 Mar at 17:26:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1019">https://github.com/qt4cg/qtspecs/issues/1019</a></div><p>XQFO: Unknown option parameters</p></div>
<div class="toot" id="closed-1059"><h2>Issue #1059 closed<span class="toot-id"> #closed-1059</span></h2><div class="pubdate">26 Mar at 17:26:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1059">https://github.com/qt4cg/qtspecs/pull/1059</a></div><p>1019 XQFO: Unknown option parameters</p></div>
<div class="toot" id="closed-1077"><h2>Issue #1077 closed<span class="toot-id"> #closed-1077</span></h2><div class="pubdate">26 Mar at 17:23:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1077">https://github.com/qt4cg/qtspecs/pull/1077</a></div><p>Correct the status of new language features</p></div>
<div class="toot" id="closed-1074"><h2>Issue #1074 closed<span class="toot-id"> #closed-1074</span></h2><div class="pubdate">26 Mar at 17:20:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1074">https://github.com/qt4cg/qtspecs/pull/1074</a></div><p>Confirm status of provisional functions</p></div>
<div class="toot" id="closed-1097"><h2>Issue #1097 closed<span class="toot-id"> #closed-1097</span></h2><div class="pubdate">26 Mar at 17:17:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1097">https://github.com/qt4cg/qtspecs/pull/1097</a></div><p>566-partial Fix colon issue in URI parsing</p></div>
<div class="toot" id="closed-1107"><h2>Issue #1107 closed<span class="toot-id"> #closed-1107</span></h2><div class="pubdate">26 Mar at 17:14:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1107">https://github.com/qt4cg/qtspecs/issues/1107</a></div><p>Grammar discrepancy on fn:pin() examples</p></div>
<div class="toot" id="closed-1060"><h2>Issue #1060 closed<span class="toot-id"> #closed-1060</span></h2><div class="pubdate">26 Mar at 17:14:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1060">https://github.com/qt4cg/qtspecs/issues/1060</a></div><p>Formatting XPath/XQuery</p></div>
<div class="toot" id="closed-1078"><h2>Issue #1078 closed<span class="toot-id"> #closed-1078</span></h2><div class="pubdate">26 Mar at 17:14:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1078">https://github.com/qt4cg/qtspecs/pull/1078</a></div><p>1060 Formatting XPath/XQuery</p></div>
<div class="toot" id="closed-1076"><h2>Issue #1076 closed<span class="toot-id"> #closed-1076</span></h2><div class="pubdate">26 Mar at 17:10:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1076">https://github.com/qt4cg/qtspecs/pull/1076</a></div><p>1075 Drop 'with' expressions</p></div>
<div class="toot" id="closed-1075"><h2>Issue #1075 closed<span class="toot-id"> #closed-1075</span></h2><div class="pubdate">26 Mar at 17:10:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1075">https://github.com/qt4cg/qtspecs/issues/1075</a></div><p>Drop "with" expressions</p></div>
<div class="toot" id="closed-1109"><h2>Issue #1109 closed<span class="toot-id"> #closed-1109</span></h2><div class="pubdate">26 Mar at 02:17:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1109">https://github.com/qt4cg/qtspecs/issues/1109</a></div><p>Discrepancies in fn:hash() published examples</p></div>
<div class="toot" id="created-1117"><h2>Pull request #1117 created<span class="toot-id"> #created-1117</span></h2><div class="pubdate">26 Mar at 00:04:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1117">https://github.com/qt4cg/qtspecs/pull/1117</a></div><details><summary>1116 Add options param to unparsed-text</summary><div class="markup"><p>Reverts the change to unparsed-text and unparsed-text-lines so they no longer normalise line endings by default.</p>
<p>Instead an options parameter is added to select this as a non-default behaviour.</p>
<p>At the same time, we add an option to control whether the function is deterministic (that is, returns the same content if called repeatedly with the same URI). In 3.1 the spec stated that implementations might provide an option to do this, but did not provide an interoperable way of setting this option. For compatibility, the default is still to be deterministic.</p>
<p>Fix #1116</p>
</div></details></div>
<div class="toot" id="created-1116"><h2>Issue #1116 created<span class="toot-id"> #created-1116</span></h2><div class="pubdate">25 Mar at 15:43:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1116">https://github.com/qt4cg/qtspecs/issues/1116</a></div><details><summary>unparsed-text() end-of-line normalization</summary><div class="markup"><p>I'm uncomfortable with the backwards-incompatible change we have made to <code>unparsed-text()</code> which now normalizes line endings.</p>
<p>I think it's unlikely that there are many users who care about the difference between LF and CRLF line endings and want to preserve that difference; but I think it's very likely that there are users who have written application code that expects the line ending to be CRLF, where the application will break if the line ending changes.</p>
<p>I would be more comfortable with the change if there were an option setting to revert to the 3.1 behaviour. But my preference would be to add the option and keep the default compatible with 3.1.</p>
<p>Also, for users who want to treat the file as a sequence of lines, we already introduced <code>unparsed-text-lines()</code> so they don't have to worry about different representations of line endings.</p>
</div></details></div>
<div class="toot" id="agenda-03-26"><h2>QT4 CG meeting 071 draft agenda<span class="toot-id"> #agenda-03-26</span></h2><div class="pubdate">25 Mar at 14:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/03-26">https://qt4cg.org/meeting/agenda/2024/03-26</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1115"><h2>Issue #1115 created<span class="toot-id"> #created-1115</span></h2><div class="pubdate">25 Mar at 14:11:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1115">https://github.com/qt4cg/qtspecs/issues/1115</a></div><details><summary>XSLT - ability to call a function from xslt (not just xpath)</summary><div class="markup"><p>I don't think this is possible in 3.0 and I don't think its yet suggested (whats the easiest way to find out)....if it has then close.</p>
<p>I wonder in passing many times why I ever use</p>
<p><code>&lt;xsl:call-template.../&gt;</code></p>
<p>when functions exist?
I never use the data context inside a named template...feels dangerous.</p>
<p>So the only reason I do it, is because I can embed literal XML elements e.g.</p>
<pre><code>&lt;xsl:call-template name='foo'&gt;
   &lt;xsl:with-param name='barElement' as='element(barElement)'&gt;
     &lt;barElement/&gt;
   &lt;xsl:with-param/&gt;


</code></pre>
<p>but if I could do</p>
<pre><code>&lt;xsl:call-function name='foo'&gt;
   &lt;xsl:with-param name='barElement' as='element(barElement)'&gt;
     &lt;barElement/&gt;
   &lt;xsl:with-param/&gt;

</code></pre>
<p>then i would use functions always in preference to named templates.</p>
<p>motivation</p>
<ul>
<li>language simplification (though you'd have to keep named templates for legacy)</li>
<li>you explicitly remove the data context (which I think is error prone in practice).</li>
<li>if people used functions in preference to named templates then you would be able to use more of your code directly from x-path expressions.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1114"><h2>Issue #1114 created<span class="toot-id"> #created-1114</span></h2><div class="pubdate">25 Mar at 13:32:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1114">https://github.com/qt4cg/qtspecs/issues/1114</a></div><details><summary>Partial function application: Keywords and placeholders</summary><div class="markup"><p>The test suite contains test cases – <a href="https://github.com/qt4cg/qt4tests/blob/e633f879db71b4bac91ac304fa13fd28619d0e1b/prod/FunctionCall.xml#L1178-L1240">FunctionCall-414 … FunctionCall-417</a> – for partially applied functions with keywords and placeholders:</p>
<pre><code class="language-xml">&lt;test-case name="FunctionCall-414" covers-40="keywords"&gt;
  &lt;description&gt;Use of keyword arguments with placeholders on user-defined function&lt;/description&gt;
  &lt;created by="Michael Kay" on="2023-03-13"/&gt;
  &lt;modified by="Michael Kay" on="2023-12-13" change="do what the description says"/&gt;
  &lt;dependency type="spec" value="XQ40+"/&gt;
  &lt;test&gt;&lt;![CDATA[
     declare function local:diff ($s as xs:integer, $t as xs:integer) as xs:integer { 
        $s - $t
     };  
     local:diff(s := 12, t := ?)(8)
  ]]&gt;&lt;/test&gt;
  &lt;result&gt;
    &lt;assert-eq&gt;4&lt;/assert-eq&gt;
  &lt;/result&gt;
&lt;/test-case&gt;
...
</code></pre>
<p>I didn’t find information on this feature combination in the spec; is it already covered? If yes, is it also possible to partially apply function items with keywords?…</p>
<pre><code class="language-xquery">declare function local:f($s, $t) { $s - $t };
local:f#2(s := 12, t := ?)(8),
local:f(?, ?)(s := 12, t := ?)(8)
...
</code></pre>
<p>If 2x yes, I can try to add some more test cases (for example, I assume that <code>$f(t := 12, ?)</code> is illegal, as arguments without keywords probably need to be placed first).</p>
</div></details></div>
<div class="toot" id="created-1113"><h2>Issue #1113 created<span class="toot-id"> #created-1113</span></h2><div class="pubdate">25 Mar at 10:40:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1113">https://github.com/qt4cg/qtspecs/issues/1113</a></div><details><summary>Misleading rendering BiDi text in parse-integer example</summary><div class="markup"><p>In fuction index one example of fn:parse-integer() is using parameters containing arabic letters. This leads to wrong display of parameters as 1st and 2nd parameter look like switched because browser renders both of them from left to right. It is this example:</p>
<pre><code>&lt;fos:test&gt;
               &lt;fos:expression&gt;&lt;eg&gt;translate('٢٠٢٣', '٠١٢٣٤٥٦٧٨٩', '0123456789')
=&gt; parse-integer()&lt;/eg&gt;&lt;/fos:expression&gt;
               &lt;fos:result&gt;2023&lt;/fos:result&gt;
            &lt;/fos:test&gt;
</code></pre>
<p>This looks confusing. I don't know what will be the best fix. Maybe storing '٠١٢٣٤٥٦٧٨٩' into variable would help and prevent the issue.</p>
</div></details></div>
<div class="toot" id="created-1112"><h2>Pull request #1112 created<span class="toot-id"> #created-1112</span></h2><div class="pubdate">25 Mar at 08:15:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1112">https://github.com/qt4cg/qtspecs/pull/1112</a></div><details><summary>1110-partial New error codes</summary><div class="markup"><p>Issue: #1110.</p>
<ul>
<li><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview-diff.html#func-hash">fn:hash</a>: I added <code>FOHA0001</code> as error code.</li>
<li><a href="https://qt4cg.org/specifications/xpath-functions-40/Overview-diff.html#func-op">fn:op</a>: I used <code>XPTY0004</code> as error code, as the allowed operators could also be defined as string enumeration.</li>
<li><a href="https://qt4cg.org/specifications/xquery-40/xquery-40-diff.html#id-map-test">XQuery, Map Test</a>: Not included in this PR.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1111"><h2>Issue #1111 created<span class="toot-id"> #created-1111</span></h2><div class="pubdate">24 Mar at 08:40:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1111">https://github.com/qt4cg/qtspecs/issues/1111</a></div><details><summary>xsl:pipeline</summary><div class="markup"><p>In XSLT 3.0 it is not possible to write a multi-phase streaming transformation, where two are more phases each operate in streaming mode and the result of one phase is piped into the next. Such transformations can only be written as multiple stylesheets, coordinated by some calling application.</p>
<p>A non-streamed multiphase transformation typically uses variables for the intermediate results:</p>
<pre><code>&lt;xsl:variable name="temp1"&gt;
   &lt;xsl:apply-templates mode="phase1"/&gt;
&lt;/xsl:variable&gt;
&lt;xsl:variable name="temp2"&gt;
   &lt;xsl:apply-templates select="$temp1" mode="phase2"/&gt;
&lt;/xsl:variable&gt;
&lt;xsl:apply-templates select="$temp2"/&gt;
</code></pre>
<p>This cannot be streamed because variables cannot hold streamed nodes.</p>
<p>The idea is to allow this to be written:</p>
<pre><code>&lt;xsl:pipeline streamable="yes"&gt;
   &lt;xsl:apply-templates mode="phase1"/&gt;
   &lt;xsl:apply-templates select="." mode="phase2"/&gt;
   &lt;xsl:apply-templates select="." mode="phase3"/&gt;
&lt;/xsl:pipeline&gt;
</code></pre>
<p>where each instruction in the pipeline takes as its context value the result of the previous instruction.</p>
<p>Even when no streaming is involved, the xsl:pipeline instruction brings usability benefits: it's much clearer to the reader what is going on.</p>
<p>(Triggered by a support request from a user wanting to make an existing pipelined transformation streamable; but the idea was considered and "postponed to v.next" during XSLT 3.0 development. The replacement of "context item" by "context value" removes one of the obstacles.)</p>
</div></details></div>
<div class="toot" id="created-1110"><h2>Issue #1110 created<span class="toot-id"> #created-1110</span></h2><div class="pubdate">23 Mar at 17:40:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1110">https://github.com/qt4cg/qtspecs/issues/1110</a></div><details><summary>New error codes</summary><div class="markup"><p>The XQFO spec includes various “[TODO: error code]” comments. Should we add error codes when finalizing PRs, or does a master plan exist to add them at the very end?</p>
</div></details></div>
<div class="toot" id="created-1109"><h2>Issue #1109 created<span class="toot-id"> #created-1109</span></h2><div class="pubdate">23 Mar at 15:46:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1109">https://github.com/qt4cg/qtspecs/issues/1109</a></div><details><summary>Discrepancies in fn:hash() published examples</summary><div class="markup"><p>In the third example:</p>
<p><code>hash("") </code></p>
<p>the expected result has a spurious trailing letter "o". That's trivial and I will fix it.</p>
<p>In the seventh example:</p>
<p><code>hash(serialize($doc), map{"algorithm": "sha-1"}) </code></p>
<p>I am getting a completely different result, which I suspect is because I am getting a different result from <code>serialize()</code>. Perhaps the difference is something like a trailing newline, I don't know.</p>
<p>In my case the result of <code>serialize($doc)</code> is the 14-character string <code>"&lt;doc&gt;abc&lt;/doc&gt;"</code>, which I believe is correct, but I suspect there might be other results of <code>serialize($doc)</code> that would also be conformant with the spec.</p>
</div></details></div>
<div class="toot" id="created-1108"><h2>Pull request #1108 created<span class="toot-id"> #created-1108</span></h2><div class="pubdate">22 Mar at 17:06:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1108">https://github.com/qt4cg/qtspecs/pull/1108</a></div><details><summary>566-partial Describe a less aggressive %-encoding for fn:build-uri</summary><div class="markup"><p>My proposal seemed to meet with general approval, so here is my attempt to implement it in the spec.</p>
</div></details></div>
<div class="toot" id="created-1107"><h2>Issue #1107 created<span class="toot-id"> #created-1107</span></h2><div class="pubdate">22 Mar at 16:27:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1107">https://github.com/qt4cg/qtspecs/issues/1107</a></div><details><summary>Grammar discrepancy on fn:pin() examples</summary><div class="markup"><p>I'm probably getting the wrong end of the stick, but I can't see how the example for <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-pin">fn:pin():</a></p>
<pre><code>pin(["a","b","c"])?1 =&gt; label()?parent =&gt; array:foot()
</code></pre>
<p>meets the current EBNF. (I know bits of this area may be in flux, so this may be just for the record .)</p>
<pre><code>pin(["a","b","c"])?1 =&gt; label()
</code></pre>
<p>meets the production for <code>ArrowExpr</code>, and the RHS of an <code>ArrowExpr</code> is, in this case, an <code>ArrowStaticFunction</code> <code>ArgumentList</code> pair, which doesn't encompass the subsequent lookup.</p>
<p>But for <code>LookupExpr</code> to include the <code>?parent</code> requires <code>PostfixExpr</code> as its first term, and <code>PostfixExpr</code> can only include <code>ArrowExpr</code> via <code>PrimaryExpr/ParenthesizedExpr</code>, i.e. with brackets.</p>
</div></details></div>
<div class="toot" id="closed-1052"><h2>Issue #1052 closed<span class="toot-id"> #closed-1052</span></h2><div class="pubdate">21 Mar at 12:51:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1052">https://github.com/qt4cg/qtspecs/issues/1052</a></div><p>parse-csv() - simplify output</p></div>
<div class="toot" id="created-1106"><h2>Pull request #1106 created<span class="toot-id"> #created-1106</span></h2><div class="pubdate">21 Mar at 12:41:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1106">https://github.com/qt4cg/qtspecs/pull/1106</a></div><details><summary>859 lookup syntax problems</summary><div class="markup"><p>Fix the syntax ambiguity identified in issue #859 by dropping the troublesome construct.</p>
<p>It is hoped something else will be introduced in its place.</p>
<p>Fix #859</p>
</div></details></div>
<div class="toot" id="created-1105"><h2>Issue #1105 created<span class="toot-id"> #created-1105</span></h2><div class="pubdate">21 Mar at 11:53:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1105">https://github.com/qt4cg/qtspecs/issues/1105</a></div><details><summary>Casting to numerical type from strings with underscores</summary><div class="markup"><p>The <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#prod-xpath40-Digits">Digits</a> production now permits underscores as separators in long numerical character sequences.
However in casting to numerical types, either by operator or by function:</p>
<pre><code>'12_345_678' as xs:integer
number('12.345_678')
</code></pre>
<p>am I correct that this should fail according to <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#casting-from-strings">Casting from xs:string and xs:untypedAtomic</a>, even though a static resolution/rewrite would be possible?</p>
</div></details></div>
<div class="toot" id="created-1104"><h2>Issue #1104 created<span class="toot-id"> #created-1104</span></h2><div class="pubdate">21 Mar at 10:06:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1104">https://github.com/qt4cg/qtspecs/issues/1104</a></div><details><summary>TypeTest expressions</summary><div class="markup"><p>Our current status quo text allows the result of a lookup expression to be filtered by type:</p>
<p><code>[[1,2], [3,4], 5, 6]?*::array(*)?1</code></p>
<p>and issue #859 points out that this doesn't work because of a syntax ambiguity involving occurrence indicators ('?' is both an occurrence indicator and a lookup operator).</p>
<p>This issue addresses that problem by re-examining the requirements, and pulling in a number of other issues at the same time.</p>
<p>In path expressions we have a shorthand syntax for selecting nodes, called the node test, and the proposed syntax <code>::array(*)</code> was modelled on this. Node tests have a considerable overlap with types, but there are limitations. For example the <code>self</code> axis is often used to turn a node test into a general predicate, but <code>[self::XX]</code> can only be used to test elements, not attributes. However, the popularity of node tests and the self axis illustrates the need for a concise filtering operation.</p>
<p>Of course it's always possible to write <code>[. instance of array(*)]</code> but this gets extremely verbose.</p>
<p>In XSLT 3.0, template rules matching maps and arrays could only be written as <code>match=".[. instance of array(*)]"</code>, which gets really ugly, so we have proposed an alternative in 4.0. Specifically, you can match any type using <code>match="type(ItemType)"</code>, and for many types such as arrays and maps you can abbreviate this to, for example <code>match="array(*)"</code>. But this feels clumsy because the type() wrapper is sometimes needed and sometimes not.</p>
<p>I would like to propose an expression that has concise syntax, whose effect is equivalent to <code>. instance of T</code>. I propose to use the <code>~</code> symbol. This is available as both a binary and unary operator, so we can define a binary form <code>$z ~ T</code> which is syntactic shorthand for <code>$z instance of T</code>, and a unary form <code>~T</code> which is shorthand for <code>. ~ T</code>.</p>
<p>First, in the case of lookup expressions, we can now write:</p>
<p><code>[[1,2], [3,4], 5, 6]?*[~array(*)]?1</code></p>
<p>TypeTests will often be used within predicates in this way, and of course the usage is completely general.</p>
<p>Here's an example used for array:filter: <code>array:filter($array, fn{~xs:integer+})</code> which selects all members of the array comprising one or more integers.</p>
<p>In XSLT 4.0 the syntax <code>~T</code> replaces the current TypePattern, giving a much more uniform way of matching items by type.</p>
<p>In XPath and XSLT conditionals the construct can be used as an equivalent to XQuery's TypeswitchExpr:</p>
<pre><code>&lt;xsl:choose&gt;
  &lt;xsl:when test="~xs:integer"&gt;...&lt;/xsl:when&gt;
  &lt;xsl:when test="~xs:string"&gt;...&lt;/xsl:when&gt;
  ...
&lt;/xsl:choose&gt;
</code></pre>
<p>The choice of tilde for this operator is motivated by:</p>
<ul>
<li>There are not many symbols available</li>
<li>Tilde has many different uses in mathematics and computing, some of which represent a boolean test applied to a value (for example testing whether it is similar to another value or whether it matches some pattern), which is not dissimilar to this proposed usage</li>
<li>The alliteration between "tilde" and "type" has some mnemonic value (cf. the use of <code>@</code> for the attribute axis).</li>
</ul>
</div></details></div>
<div class="toot" id="created-1103"><h2>Issue #1103 created<span class="toot-id"> #created-1103</span></h2><div class="pubdate">19 Mar at 18:24:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1103">https://github.com/qt4cg/qtspecs/issues/1103</a></div><details><summary>CSV Parsing - handling line ending normalization</summary><div class="markup"><p>During discussion of PR #1066 there was much debate about how best to handle normalization of (typically CRLF) line endings.</p>
<p>Perhaps it's very unlikely that CRLF line endings will make it as far as the parse-csv() function, because they will already have been normalized for example by unparsed-text(). But data can also be read in other ways, for example bin:read-binary() or sql:query() extension functions, or passed in as a string-valued parameter to a transformation.</p>
<p>Perhaps we should have a separate mechanism for normalizing line endings in any data, independent of CSV parsing? (But perhaps it's important to retain CRLF in quoted strings?)</p>
<p>Perhaps CSV parsing should normalise CRLF unconditionally, without needing to set a special option for it?</p>
</div></details></div>
<div class="toot" id="closed-1101"><h2>Issue #1101 closed<span class="toot-id"> #closed-1101</span></h2><div class="pubdate">19 Mar at 18:21:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1101">https://github.com/qt4cg/qtspecs/issues/1101</a></div><p>XQuery: Normalize line endings</p></div>
<div class="toot" id="closed-1089"><h2>Issue #1089 closed<span class="toot-id"> #closed-1089</span></h2><div class="pubdate">19 Mar at 17:49:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1089">https://github.com/qt4cg/qtspecs/issues/1089</a></div><p>Rounding when casting string to date/time or duration types</p></div>
<div class="toot" id="closed-1090"><h2>Issue #1090 closed<span class="toot-id"> #closed-1090</span></h2><div class="pubdate">19 Mar at 17:49:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1090">https://github.com/qt4cg/qtspecs/pull/1090</a></div><p>1089 Add rounding rules for casting string to duration etc</p></div>
<div class="toot" id="closed-1079"><h2>Issue #1079 closed<span class="toot-id"> #closed-1079</span></h2><div class="pubdate">19 Mar at 17:46:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1079">https://github.com/qt4cg/qtspecs/issues/1079</a></div><p>Editorial: XSLT, Applying Template Rules, Examples</p></div>
<div class="toot" id="closed-1083"><h2>Issue #1083 closed<span class="toot-id"> #closed-1083</span></h2><div class="pubdate">19 Mar at 17:46:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1083">https://github.com/qt4cg/qtspecs/pull/1083</a></div><p>1079 Change book used in example</p></div>
<div class="toot" id="closed-1050"><h2>Issue #1050 closed<span class="toot-id"> #closed-1050</span></h2><div class="pubdate">19 Mar at 17:43:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1050">https://github.com/qt4cg/qtspecs/issues/1050</a></div><p>Potential (low-risk) Ambiguities in XPath EBNF</p></div>
<div class="toot" id="closed-1081"><h2>Issue #1081 closed<span class="toot-id"> #closed-1081</span></h2><div class="pubdate">19 Mar at 17:43:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1081">https://github.com/qt4cg/qtspecs/pull/1081</a></div><p>1050 Fix ItemType grammar ambiguity</p></div>
<div class="toot" id="closed-1080"><h2>Issue #1080 closed<span class="toot-id"> #closed-1080</span></h2><div class="pubdate">19 Mar at 17:40:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1080">https://github.com/qt4cg/qtspecs/pull/1080</a></div><p>1036 Rephrase the rules for number-parser with liberal JSON</p></div>
<div class="toot" id="closed-1036"><h2>Issue #1036 closed<span class="toot-id"> #closed-1036</span></h2><div class="pubdate">19 Mar at 17:40:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1036">https://github.com/qt4cg/qtspecs/issues/1036</a></div><p>parse-json: liberal parsing</p></div>
<div class="toot" id="closed-1102"><h2>Issue #1102 closed<span class="toot-id"> #closed-1102</span></h2><div class="pubdate">19 Mar at 17:40:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1102">https://github.com/qt4cg/qtspecs/pull/1102</a></div><p>Fix broken idref to escaped-crlf in test generation</p></div>
<div class="toot" id="created-1102"><h2>Pull request #1102 created<span class="toot-id"> #created-1102</span></h2><div class="pubdate">19 Mar at 17:40:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1102">https://github.com/qt4cg/qtspecs/pull/1102</a></div><details><summary>Fix broken idref to escaped-crlf in test generation</summary><div class="markup"><p>It appears that <code>escaped-crlf-3</code> might have been intended. @michaelhkay ?</p>
</div></details></div>
<div class="toot" id="closed-1073"><h2>Issue #1073 closed<span class="toot-id"> #closed-1073</span></h2><div class="pubdate">19 Mar at 17:33:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1073">https://github.com/qt4cg/qtspecs/pull/1073</a></div><p>XQFO (editorial)</p></div>
<div class="toot" id="closed-757"><h2>Issue #757 closed<span class="toot-id"> #closed-757</span></h2><div class="pubdate">19 Mar at 17:32:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/757">https://github.com/qt4cg/qtspecs/issues/757</a></div><p>Function families</p></div>
<div class="toot" id="closed-463"><h2>Issue #463 closed<span class="toot-id"> #closed-463</span></h2><div class="pubdate">19 Mar at 17:32:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/463">https://github.com/qt4cg/qtspecs/issues/463</a></div><p>fn:parts() - extract the parts of a (not-really) atomic value</p></div>
<div class="toot" id="closed-448"><h2>Issue #448 closed<span class="toot-id"> #closed-448</span></h2><div class="pubdate">19 Mar at 17:31:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/448">https://github.com/qt4cg/qtspecs/issues/448</a></div><p>Support extended dateTime formats of ISO-8601:2019?</p></div>
<div class="toot" id="closed-283"><h2>Issue #283 closed<span class="toot-id"> #closed-283</span></h2><div class="pubdate">19 Mar at 17:31:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/283">https://github.com/qt4cg/qtspecs/issues/283</a></div><p>Enumeration types</p></div>
<div class="toot" id="closed-218"><h2>Issue #218 closed<span class="toot-id"> #closed-218</span></h2><div class="pubdate">19 Mar at 17:31:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/218">https://github.com/qt4cg/qtspecs/issues/218</a></div><p>Function library for maps with composite keys: and thoughts on encapsulation</p></div>
<div class="toot" id="closed-119"><h2>Issue #119 closed<span class="toot-id"> #closed-119</span></h2><div class="pubdate">19 Mar at 17:31:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/119">https://github.com/qt4cg/qtspecs/issues/119</a></div><p>Allow a map's key value to be any sequence</p></div>
<div class="toot" id="closed-33"><h2>Issue #33 closed<span class="toot-id"> #closed-33</span></h2><div class="pubdate">19 Mar at 17:31:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/33">https://github.com/qt4cg/qtspecs/issues/33</a></div><p>JSON Parsing &amp; Serialization: Numbers</p></div>
<div class="toot" id="closed-883"><h2>Issue #883 closed<span class="toot-id"> #closed-883</span></h2><div class="pubdate">19 Mar at 17:30:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/883">https://github.com/qt4cg/qtspecs/issues/883</a></div><p>Improve return type for fn:load-xquery-module()</p></div>
<div class="toot" id="minutes-03-19"><h2>QT4 CG meeting 070 draft minutes<span class="toot-id"> #minutes-03-19</span></h2><div class="pubdate">19 Mar at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/03-19">https://qt4cg.org/meeting/minutes/2024/03-19</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1072"><h2>Issue #1072 closed<span class="toot-id"> #closed-1072</span></h2><div class="pubdate">19 Mar at 17:29:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1072">https://github.com/qt4cg/qtspecs/pull/1072</a></div><p>883 Return type of load-xquery-module</p></div>
<div class="toot" id="closed-1066"><h2>Issue #1066 closed<span class="toot-id"> #closed-1066</span></h2><div class="pubdate">19 Mar at 17:27:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1066">https://github.com/qt4cg/qtspecs/pull/1066</a></div><p>1052 Simplify the results of parse-csv</p></div>
<div class="toot" id="created-1101"><h2>Issue #1101 created<span class="toot-id"> #created-1101</span></h2><div class="pubdate">19 Mar at 13:04:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1101">https://github.com/qt4cg/qtspecs/issues/1101</a></div><details><summary>XQuery: Normalize line endings</summary><div class="markup"><p>Various tests, such as <a href="https://github.com/qt4cg/qt4tests/blob/c4210d9d22e756a05dfb54a0ca06fae159fe0bbc/misc/XMLEdition.xml#L132-L140"><code>line-ending-Q002</code></a>, validate if line ending are normalized when parsing the input:</p>
<pre><code class="language-xml">&lt;test-case name="line-ending-Q002"&gt;
  &lt;description&gt;Normalization of line endings in XQuery&lt;/description&gt;
  &lt;created by="Michael Kay" on="2011-11-24"/&gt;
  &lt;dependency type="spec" value="XQ10+"/&gt;
  &lt;test&gt;deep-equal(string-to-codepoints('&amp;#xd;&amp;#xa;'), (10))&lt;/test&gt;
  &lt;result&gt;
    &lt;assert-true/&gt;
  &lt;/result&gt;
&lt;/test-case&gt;
</code></pre>
<p>I cannot find a corresponding note in the current <a href="https://qt4cg.org/specifications/xquery-40/xquery-40.html">XQuery 4 draft</a>. Should we add it?</p>
<p>I would welcome this normalization. I assume that no one over the last decades has missed carriage return in XML?</p>
</div></details></div>
<div class="toot" id="closed-1099"><h2>Issue #1099 closed<span class="toot-id"> #closed-1099</span></h2><div class="pubdate">19 Mar at 12:35:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1099">https://github.com/qt4cg/qtspecs/pull/1099</a></div><p>Build fixes</p></div>
<div class="toot" id="created-1100"><h2>Pull request #1100 created<span class="toot-id"> #created-1100</span></h2><div class="pubdate">19 Mar at 12:21:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1100">https://github.com/qt4cg/qtspecs/pull/1100</a></div><details><summary>99 fn:equal() function to compare sequences and arrays</summary><div class="markup"><p>Fix issue #99</p>
<p>Introduces a function fn:equal() that compares two arbitrary values (sequences, maps, arrays, etc), with a callback for comparing "leaf" items in the structure.</p>
</div></details></div>
<div class="toot" id="created-1099"><h2>Pull request #1099 created<span class="toot-id"> #created-1099</span></h2><div class="pubdate">19 Mar at 12:17:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1099">https://github.com/qt4cg/qtspecs/pull/1099</a></div><details><summary>Build fixes</summary><div class="markup"><p>I had a brain cramp when I wrote the <code>build.gradle</code> file for this repository. This PR fixes that.</p>
<p>It also adds a <code>nobreak</code> attribute to the <code>code</code> element. The intent, not yet implemented, is that you can say</p>
<pre><code>&lt;code nobreak="true"&gt;some long, but not unreasonably long expression&lt;/code&gt;
</code></pre>
<p>and the stylesheet will prevent a line break in the middle of the expression.</p>
</div></details></div>
<div class="toot" id="created-1098"><h2>Pull request #1098 created<span class="toot-id"> #created-1098</span></h2><div class="pubdate">19 Mar at 12:14:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1098">https://github.com/qt4cg/qtspecs/pull/1098</a></div><details><summary>566-partial Editorial improvements for parse-uri</summary><div class="markup"><ol>
<li>Add a note clarifying that the fragment identifier should be (1) URI decoded and (2) ignored if it's the empty string.</li>
<li>Reworked a bit of the description in order to avoid an ambiguity in how <code>///abc</code> should be parsed. (The current spec can be satisfied either by parsing it as <code>//(/abc)()</code> or <code>//()/abc</code> and only the former is intended.)</li>
</ol>
</div></details></div>
<div class="toot" id="created-1097"><h2>Pull request #1097 created<span class="toot-id"> #created-1097</span></h2><div class="pubdate">18 Mar at 16:22:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1097">https://github.com/qt4cg/qtspecs/pull/1097</a></div><details><summary>566-partial Fix colon issue in URI parsing</summary><div class="markup"><p>In the course of reviewing the tests for <code>fn:parse-uri</code>, I discovered (or perhaps more correctly, @ChristianGruen discovered) that the rules for matching Windows drive letters are inconsistent. This PR fixes that inconsistency.</p>
</div></details></div>
<div class="toot" id="created-1096"><h2>Issue #1096 created<span class="toot-id"> #created-1096</span></h2><div class="pubdate">18 Mar at 15:36:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1096">https://github.com/qt4cg/qtspecs/issues/1096</a></div><details><summary>Effect of atomization on array:index-of()</summary><div class="markup"><p>What is the expected result of the expression:</p>
<p><code>array:index-of( [[1,2], [3,4]],  [3,4] )</code></p>
<p>It seems that the second argument is atomised (because its declared type is atomic), but the first argument is not.</p>
<p>So both members of the array have count=1, whereas $search has count=2, so nothing matches, so the result is ().</p>
<p>Now, what if we write:</p>
<p><code>array:index-of( [[1,2], (3,4)],  [3,4] )</code></p>
<p>This time it seems that the second member of the array matches, so the result is 2.</p>
<p>This doesn't feel right. One solution would be to say that each member of the array is itself atomised. But that seems to lead to other surprises with other examples of nested arrays.</p>
<p>An alternative would be to atomize neither argument (which would mean changing the function signature). But then we would need to use a different comparison operation.</p>
<p>We seem to be back where we started -- I was unhappy about introducing this function because of the difficulty of defining a good comparison operation for it to use.</p>
</div></details></div>
<div class="toot" id="agenda-03-19"><h2>QT4 CG meeting 070 draft agenda<span class="toot-id"> #agenda-03-19</span></h2><div class="pubdate">18 Mar at 14:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/03-19">https://qt4cg.org/meeting/agenda/2024/03-19</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-1095"><h2>Issue #1095 closed<span class="toot-id"> #closed-1095</span></h2><div class="pubdate">18 Mar at 11:44:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1095">https://github.com/qt4cg/qtspecs/issues/1095</a></div><p>Collation: caseblind → Standardize or replace with `html-ascii-case-insensitive`?</p></div>
<div class="toot" id="created-1095"><h2>Issue #1095 created<span class="toot-id"> #created-1095</span></h2><div class="pubdate">18 Mar at 11:20:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1095">https://github.com/qt4cg/qtspecs/issues/1095</a></div><details><summary>Collation: caseblind → Standardize or replace with `html-ascii-case-insensitive`?</summary><div class="markup"><p>Various test cases use the artificial <code>http://www.w3.org/2010/09/qt-fots-catalog/collation/caseblind</code> collation. It seems that most (all) of them could also be written with the <code>http://www.w3.org/2005/xpath-functions/collation/html-ascii-case-insensitive</code>.</p>
<p>Could we replace the tests with the standardized collation, or should we rather try to standardize the caseblind variant?</p>
</div></details></div>
<div class="toot" id="created-1094"><h2>Issue #1094 created<span class="toot-id"> #created-1094</span></h2><div class="pubdate">18 Mar at 09:25:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1094">https://github.com/qt4cg/qtspecs/issues/1094</a></div><details><summary>Axis steps in lookup expressions</summary><div class="markup"><p>This issue picks up where issue #341, issue #350, issue #596, issue #960 etc left off - an attempt to find better syntax and semantics for navigation within JTrees (by which I mean trees of maps and arrays). The problems we are addressing are well aired in those previous issues. There are new opportunities for improving navigation within pinned trees, where upwards navigation becomes possible.</p>
<p>Firstly I propose that the existing constructs <code>?*</code>, <code>?key</code>, and <code>?1</code> be treated as abbreviations for <code>?content::*</code>, <code>?content::key</code>, and <code>?content::1</code> respectively. The content axis delivers a flattened sequence of items.</p>
<p>Then I propose we introduce an <code>entry</code> axis. <code>?entry::*</code>, <code>?entry::key</code>, and <code>?entry::1</code> deliver their results as a sequence of key value pairs, in the style of <code>map:pairs()</code>. Arrays for this purpose are treated as maps with integer keys. For example if <code>$A</code> is <code>[(1,2), (3,4)]</code> then <code>$A?entry::*</code> delivers <code>(map{'key':1, 'value':(1,2)}, map{'key':2 'value':(3,4)}</code>.</p>
<p>This applies equally to the deep lookup operator. <code>$A??entry::*</code> returns all the key-value pairs within the JTree rooted at $A, recursively.</p>
<p>We could also consider a <code>value</code> axis which delivers a sequence of arrays containing the values, losing the associated keys.</p>
<p>If values are labelled, as a result of being found by navigating a pinned JTree. then upwards navigation is also possible. For an item in a pinned tree,</p>
<ul>
<li>
<p><code>containing-entry::*</code> delivers the containing entry as a key-value pair. Duplicates are eliminated.</p>
</li>
<li>
<p><code>owner::*</code> delivers the immediately containing map or array as identified by the label</p>
</li>
<li>
<p><code>ownership::*</code> delivers the transitive closure of the <code>owner::*</code> axis.</p>
</li>
<li>
<p><code>peer::*</code> delivers <code>owner::*/entry::*</code></p>
</li>
<li>
<p><code>following-member::*</code> delivers the subarray of the containing array that follows the current entry</p>
</li>
<li>
<p><code>preceding-member::*</code> delivers the subarray of the containing array thay precedes the current entry</p>
</li>
</ul>
<p>Of course, improved names for these concepts are welcomed!</p>
<p>In these examples I have used <code>*</code> to select everything on the relevant axis. This can always be replaced by a key specifier K that selects the item only if it is labelled with a key K. So for example ownership::address selects the containing maps and arrays that are themselves in a map entry with key "address".</p>
<p>I think we also need a convenient way to filter the selection by type (see issue #859 for a problem with the current syntax). I propose</p>
<p><code>??content::[record(longitude, latitude)]</code></p>
<p>to select all items in the recursive content that match type <code>record(longitude, latitude)</code></p>
<p>Similarly</p>
<p><code>??entry::[array(xs:integer)+]</code></p>
<p>to select all entries where the value is an array of integers.</p>
<p>Finally, responding to issue #341, I propose that lookup operators should be error free: rather than reporting errors, they should return nothing.</p>
</div></details></div>
<div class="toot" id="created-1093"><h2>Pull request #1093 created<span class="toot-id"> #created-1093</span></h2><div class="pubdate">17 Mar at 16:08:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1093">https://github.com/qt4cg/qtspecs/pull/1093</a></div><details><summary>1091 Add fn:collation function</summary><div class="markup"><p>Fix #1091</p>
</div></details></div>
<div class="toot" id="created-1092"><h2>Pull request #1092 created<span class="toot-id"> #created-1092</span></h2><div class="pubdate">17 Mar at 09:30:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1092">https://github.com/qt4cg/qtspecs/pull/1092</a></div><details><summary>1039 Add notes referring to fn:collation-key</summary><div class="markup"><p>Fix #1039</p>
<p>Rather than adding a new feature to the language, we add notes to "order by" and "group by" explaining how the requirement can be met using the fn:collation-key() function.</p>
</div></details></div>
<div class="toot" id="closed-334"><h2>Issue #334 closed<span class="toot-id"> #closed-334</span></h2><div class="pubdate">16 Mar at 21:51:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/334">https://github.com/qt4cg/qtspecs/issues/334</a></div><p>Transient properties: a new approach to deep selection and update in maps and arrays</p></div>
<div class="toot" id="closed-86"><h2>Issue #86 closed<span class="toot-id"> #closed-86</span></h2><div class="pubdate">16 Mar at 21:40:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/86">https://github.com/qt4cg/qtspecs/issues/86</a></div><p>Fallback for named timezones </p></div>
<div class="toot" id="closed-64"><h2>Issue #64 closed<span class="toot-id"> #closed-64</span></h2><div class="pubdate">16 Mar at 21:36:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/64">https://github.com/qt4cg/qtspecs/issues/64</a></div><p>Specify optional parameters to create bounded variadic functions</p></div>
<div class="toot" id="closed-56"><h2>Issue #56 closed<span class="toot-id"> #closed-56</span></h2><div class="pubdate">16 Mar at 21:18:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/56">https://github.com/qt4cg/qtspecs/issues/56</a></div><p>Allow item-type to be matched within its definition scope</p></div>
<div class="toot" id="created-1091"><h2>Issue #1091 created<span class="toot-id"> #created-1091</span></h2><div class="pubdate">16 Mar at 15:16:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1091">https://github.com/qt4cg/qtspecs/issues/1091</a></div><details><summary>Convenience function to construct a collation URI</summary><div class="markup"><p>I propose a convenience function to construct a collation URI: for example</p>
<p>collation({'lang':'fr'})</p>
<p>returns a collation URI suitable for French.</p>
<p>If the property names supplied are those that are defined for UCA collation names, the result will be the corresponding UCA collation URI; alternatively, implementation-defined property names can be included.</p>
</div></details></div>
<div class="toot" id="created-1090"><h2>Pull request #1090 created<span class="toot-id"> #created-1090</span></h2><div class="pubdate">15 Mar at 15:53:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1090">https://github.com/qt4cg/qtspecs/pull/1090</a></div><details><summary>1089 Add rounding rules for casting string to duration etc</summary><div class="markup"><p>Fix #1089</p>
</div></details></div>
<div class="toot" id="created-1089"><h2>Issue #1089 created<span class="toot-id"> #created-1089</span></h2><div class="pubdate">15 Mar at 15:35:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1089">https://github.com/qt4cg/qtspecs/issues/1089</a></div><details><summary>Rounding when casting string to date/time or duration types</summary><div class="markup"><p>F+O section 21.2 describes rules for rounding when strings are cast to xs:decimal. The same rules should apply when casting to a dateTime, time, or duration, in the case where the number of digits in the fractional seconds part exceeds the precision supported by the implementation.</p>
</div></details></div>
<div class="toot" id="closed-1082"><h2>Issue #1082 closed<span class="toot-id"> #closed-1082</span></h2><div class="pubdate">15 Mar at 14:50:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1082">https://github.com/qt4cg/qtspecs/issues/1082</a></div><p>Inconsistency in underscore in numeric literal grammar</p></div>
<div class="toot" id="closed-1088"><h2>Issue #1088 closed<span class="toot-id"> #closed-1088</span></h2><div class="pubdate">15 Mar at 14:50:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1088">https://github.com/qt4cg/qtspecs/pull/1088</a></div><p>1082 Fix numeric literal grammar</p></div>
<div class="toot" id="created-1088"><h2>Pull request #1088 created<span class="toot-id"> #created-1088</span></h2><div class="pubdate">15 Mar at 13:07:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1088">https://github.com/qt4cg/qtspecs/pull/1088</a></div><details><summary>1082 Fix numeric literal grammar</summary><div class="markup"><p>Fix #1082</p>
<p>Also adds some notes and examples</p>
</div></details></div>
<div class="toot" id="created-1087"><h2>Pull request #1087 created<span class="toot-id"> #created-1087</span></h2><div class="pubdate">15 Mar at 11:44:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1087">https://github.com/qt4cg/qtspecs/pull/1087</a></div><details><summary>1086 Editorial changes to array:values</summary><div class="markup"><p>Fix #1086</p>
</div></details></div>
<div class="toot" id="created-1086"><h2>Issue #1086 created<span class="toot-id"> #created-1086</span></h2><div class="pubdate">15 Mar at 10:40:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1086">https://github.com/qt4cg/qtspecs/issues/1086</a></div><details><summary>array:values spec cleanup</summary><div class="markup"><p>The rules for array:values say:</p>
<blockquote>
<p>The function concatenates the members of $array and returns them as a sequence. The values are returned in their original order. Arrays contained within members are returned unchanged.</p>
<p>The effect of the function is equivalent to $array?*.</p>
</blockquote>
<p>This is all a bit too vague.</p>
<ul>
<li>the values are not concatenated, at least not in the sense of concat()</li>
<li>it doesn't return the members, it returns their sequence concatenation</li>
<li>the phrase "arrays contained within members" is unclear. The examples reveal that this rule is intended to include arrays that ARE members.</li>
<li>the equivalent expression <code>$array?*</code> allows $array to be things that <code>array:values()</code> doesn't allow (like an empty sequence).</li>
</ul>
<p>More subtly, the introduction to section 19.1 says:</p>
<blockquote>
<p>All functionality on arrays is defined in terms of two primitives:</p>
<p>The function [array:members] decomposes an array to a sequence of value records.
The function [array:of-members] composes an array from a sequence of value records.</p>
</blockquote>
<p>and the spec for array:values doesn't conform to this guideline.</p>
<p>Try:</p>
<p>The function returns the sequence-concatenation of the members of $array, retaining order. More formally, the effect of the function is equivalent to the expression <code>array:members($array)?value</code>.</p>
<p>and add to the notes:</p>
<p>Unlike array:flatten, the function does not apply recursively to nested arrays.</p>
</div></details></div>
<div class="toot" id="created-1085"><h2>Issue #1085 created<span class="toot-id"> #created-1085</span></h2><div class="pubdate">14 Mar at 22:07:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1085">https://github.com/qt4cg/qtspecs/issues/1085</a></div><details><summary>Parameters to fn:sort</summary><div class="markup"><p>An interesting suggestion made in passing in the thread discussing fn:ranks(). It would be possible to combine the <code>collation</code> argument and the <code>ascending/descending</code> argument of <code>fn:sort</code> into a single argument, whose value is an optional "ascending|descending" keyword followed by an optional collation URI (whitespace-separated, presumably).</p>
<p>This might seem a little bizarre at first sight, but having a list of collation URIs followed by a list of sort key functions followed by a list of ascending/descending keywords is also a little bizarre, and it would have two advantages - it would make better use of the second argument which is currently nearly always set to <code>()</code>, and it would put the two parts of the order specification (the collation and its direction) in closer proximity. After all, they are used in combination to decide whether one value precedes or follows another.</p>
<p>I'm not 100% convinced by the idea, but it seems worth considering. What do people think?</p>
</div></details></div>
<div class="toot" id="created-1084"><h2>Issue #1084 created<span class="toot-id"> #created-1084</span></h2><div class="pubdate">13 Mar at 18:29:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1084">https://github.com/qt4cg/qtspecs/issues/1084</a></div><details><summary>Incorrect rendition of option defaults</summary><div class="markup"><p>In the F&amp;O spec, when rendering the default value of an option, code font is being used for narrative prose: see for example defaults for the <code>delivery-format</code> and <code>base-output-uri</code> options of <code>fn:transform</code></p>
</div></details></div>
<div class="toot" id="created-1083"><h2>Pull request #1083 created<span class="toot-id"> #created-1083</span></h2><div class="pubdate">13 Mar at 17:58:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1083">https://github.com/qt4cg/qtspecs/pull/1083</a></div><details><summary>1079 Change book used in example</summary><div class="markup"><p>Changed the example to a book by a reputable author.</p>
<p>Fix #1079</p>
</div></details></div>
<div class="toot" id="created-1082"><h2>Issue #1082 created<span class="toot-id"> #created-1082</span></h2><div class="pubdate">13 Mar at 17:35:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1082">https://github.com/qt4cg/qtspecs/issues/1082</a></div><details><summary>Inconsistency in underscore in numeric literal grammar</summary><div class="markup"><p><a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#id-numeric-literals">Numeric Literals</a> describes permitting underscores to be used as separators in sequences of digits within long numbers. The first interpretation rule says underscores are first stripped out.</p>
<p>But the grammar provided appears to me to be inconsistent.</p>
<pre><code>IntegerLiteral	   ::=   	Digits
DecimalLiteral	   ::=   	("." Digits) | (Digits "." [0-9]*)
DoubleLiteral	   ::=   	(("." Digits) | (Digits ("." [0-9]*)?)) [eE] [+-]? Digits
Digits	           ::=   	DecDigit ((DecDigit | "_")* DecDigit)?
DecDigit	   ::=   	[0-9]
</code></pre>
<p><code>Digits</code> permits underscores in the grammar, which works in the integer portion of the numeric literal, but when the value exceeds 1 the fractional part is described as <code>[0-9]*</code>. If underscore stripping is a 'pre-parsing' step, then <code>Digits</code> need not mention it at all.</p>
<p>On the other hand if the grammar is defining the sequence of characters that are permitted, then the fractional section in the grammar should also permit underscores, which it plainly does not in the presence of an integer part. (The test <code>seconds-010</code> uses such in an expansion of π.)</p>
<p>An alternative formulation that I think does describe underscores in fractional parts might be:</p>
<pre><code> DecimalLiteral	   ::=   	("." Digits) | (Digits "." Digits?) 
</code></pre>
<p>and similarly for <code>DoubleLiteral</code>. I know this isn't a game-changer, but for those generating grammars, consistency certainly helps.</p>
</div></details></div>
<div class="toot" id="created-1081"><h2>Pull request #1081 created<span class="toot-id"> #created-1081</span></h2><div class="pubdate">13 Mar at 16:26:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1081">https://github.com/qt4cg/qtspecs/pull/1081</a></div><details><summary>1050 Fix ItemType grammar ambiguity</summary><div class="markup"><p>Two alternatives in the grammar were both EQNames, distinguished semantically. This ambiguity in the grammar is now fixed (no living XPath expressions are harmed by this change).</p>
<p>Fix #1050</p>
</div></details></div>
<div class="toot" id="created-1080"><h2>Pull request #1080 created<span class="toot-id"> #created-1080</span></h2><div class="pubdate">13 Mar at 15:42:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1080">https://github.com/qt4cg/qtspecs/pull/1080</a></div><details><summary>1036 Rephrase the rules for number-parser with liberal JSON</summary><div class="markup"><p>Rephrasing as suggested in the issue.</p>
<p>Fix #1036</p>
</div></details></div>
<div class="toot" id="created-1079"><h2>Issue #1079 created<span class="toot-id"> #created-1079</span></h2><div class="pubdate">13 Mar at 14:45:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1079">https://github.com/qt4cg/qtspecs/issues/1079</a></div><details><summary>Editorial: XSLT, Applying Template Rules, Examples</summary><div class="markup"><p>This guy is all around. Do we really need him in our specs as well? 😏</p>
<p>https://qt4cg.org/pr/1078/xslt-40/Overview.html#applying-templates</p>
<pre><code class="language-xquery">  "Title": "How to Win Elections",
  "Authors": [ "...
</code></pre>
</div></details></div>
<div class="toot" id="created-1078"><h2>Pull request #1078 created<span class="toot-id"> #created-1078</span></h2><div class="pubdate">13 Mar at 14:20:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1078">https://github.com/qt4cg/qtspecs/pull/1078</a></div><details><summary>1060 Formatting XPath/XQuery</summary><div class="markup"><p>Editorial; closes #1060.</p>
<p>This PR attempts to unify the presentation of XPath and XQuery code. It’s not complete, but it should definitely improve the status quo.</p>
<p>The chosen formatting and indentation rules can certainly be discussed. My major objective was consistency: I selected rules that were used frequently enough in the given documents.</p>
<p>Apart from the presentation stuff, this PR fixes various minor bugs in the rules and examples.</p>
</div></details></div>
<div class="toot" id="created-1077"><h2>Pull request #1077 created<span class="toot-id"> #created-1077</span></h2><div class="pubdate">13 Mar at 12:50:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1077">https://github.com/qt4cg/qtspecs/pull/1077</a></div><details><summary>Correct the status of new language features</summary><div class="markup"><p>This PR corrects the status of certain language features that the change appendix in the spec incorrectly describes as having not been accepted by the WG., The features in question are:</p>
<blockquote>
<p>The rules for reporting type errors during static analysis have been changed
so that a processor has more freedom to report errors in respect of constructs that
are evidently wrong, such as <code>@price/@value</code>, even though dynamic evaluation
is defined to return an empty sequence rather than an error.</p>
</blockquote>
<p>This change has in fact been discussed and accepted by the group.  See PRs #603 and #884.</p>
<blockquote>
<pre><code>Record types are added as a new kind of ItemType, constraining
  the value space of maps.
</code></pre>
</blockquote>
<p>Record types have become a fundamental feature of much of our work, with many additional capabilities relying on them. They became an official part of the spec with the closure of issue #172.</p>
<blockquote>
<pre><code>Local union types are added as a new kind of ItemType, constraining
  the value space of atomic values.
</code></pre>
</blockquote>
<blockquote>
<p>Enumeration types are added as a new kind of <code>ItemType</code>, constraining
the value space of strings.</p>
</blockquote>
<p>Local union types and enumeration types became an official part of the spec with the acceptance of PR #691</p>
<blockquote>
<p>The lookup operator <code>?</code> can now be followed by a string literal, for cases where
map keys are strings other than NCNames.</p>
</blockquote>
<p>These changes were endorsed by acceptance of PR #926.</p>
<blockquote>
<p>The rules for value comparisons when comparing values of different types (for example, decimal and double)
have changed to be transitive. A decimal value is no longer converted to double, instead the double is converted
to a decimal without loss of precision. This may affect compatibility in edge cases involving comparison of
values that are numerically very close.</p>
</blockquote>
<p>We still have open issues regarding comparison, conversion, and promotion of numeric values. See for example issue #986. So we may yet decide to roll back these changes. For practical purposes it's sensible to treat the current text as status quo, since so many individual changes have been made that unwinding can only be treated as a new issue.</p>
<blockquote>
<p>A <code>for member</code> clause is added to FLWOR expressions to allow iteration over
an array.</p>
</blockquote>
<p>The current specification of <code>for member</code> results from the acceptance of PR #752.</p>
</div></details></div>
<div class="toot" id="created-1076"><h2>Pull request #1076 created<span class="toot-id"> #created-1076</span></h2><div class="pubdate">13 Mar at 12:02:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1076">https://github.com/qt4cg/qtspecs/pull/1076</a></div><details><summary>1075 Drop 'with' expressions</summary><div class="markup"><p>Proposes dropping "with" expressions from the spec.</p>
<p>Fix #1075</p>
</div></details></div>
<div class="toot" id="created-1075"><h2>Issue #1075 created<span class="toot-id"> #created-1075</span></h2><div class="pubdate">13 Mar at 11:50:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1075">https://github.com/qt4cg/qtspecs/issues/1075</a></div><details><summary>Drop "with" expressions</summary><div class="markup"><p>The current draft includes a proposal for a "with" expression to establish the namespace context for an XPath expression. This has never been reviewed or accepted by the group. See §4.1 of the language specifications.</p>
<p>I propose to raise a PR that drops this feature, in order to force discussion as to whether we want it in its current form, or to replace it with something better, or to drop it entirely.</p>
</div></details></div>
<div class="toot" id="created-1074"><h2>Pull request #1074 created<span class="toot-id"> #created-1074</span></h2><div class="pubdate">13 Mar at 11:42:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1074">https://github.com/qt4cg/qtspecs/pull/1074</a></div><details><summary>Confirm status of provisional functions</summary><div class="markup"><p>The purpose of this PR is to bring the current F&amp;O draft specification into a state where it is confirmed as the current status quo accepted by the CG.</p>
<p>The following functions (mainly new, some amended) that have been present in the draft for some while, but with caveats about their status, are confirmed as part of the status quo:</p>
<ul>
<li>fn:slice</li>
<li>fn:format-number</li>
<li>fn:stack-trace</li>
<li>map:filter</li>
<li>map:replace</li>
<li>array:replace</li>
</ul>
<p>The following functions are dropped (for the time being):</p>
<ul>
<li>fn:json</li>
<li>map:substitute</li>
</ul>
<p>The actual PR essentially changes text that alludes to the status of these functions, it does not change the actual specifications.</p>
<p>The current state of qt4tests in relation to these functions is:</p>
<p>fn:slice - OK
fn:format-number - missing tests for recent changes
fn:stack-trace - no tests
map:filter - OK
map:replace - no tests
array:replace - no tests
fn:json - no tests
map:substitute - no tests</p>
</div></details></div>
<div class="toot" id="created-1073"><h2>Pull request #1073 created<span class="toot-id"> #created-1073</span></h2><div class="pubdate">13 Mar at 09:01:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1073">https://github.com/qt4cg/qtspecs/pull/1073</a></div><details><summary>XQFO (editorial)</summary><div class="markup"><p>Examples fixed.</p>
</div></details></div>
<div class="toot" id="created-1072"><h2>Pull request #1072 created<span class="toot-id"> #created-1072</span></h2><div class="pubdate">13 Mar at 00:51:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1072">https://github.com/qt4cg/qtspecs/pull/1072</a></div><details><summary>883 Return type of load-xquery-module</summary><div class="markup"><p>Use a record type for the return type of the function.</p>
<p>Fix #883</p>
</div></details></div>
<div class="toot" id="created-1071"><h2>Pull request #1071 created<span class="toot-id"> #created-1071</span></h2><div class="pubdate">12 Mar at 22:10:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1071">https://github.com/qt4cg/qtspecs/pull/1071</a></div><details><summary>1070 Bare Brace map constructor syntax</summary><div class="markup"><p>Makes the keyword "map" in map constructors optional.</p>
<p>Fix #1070</p>
</div></details></div>
<div class="toot" id="minutes-03-12"><h2>QT4 CG meeting 069 draft minutes<span class="toot-id"> #minutes-03-12</span></h2><div class="pubdate">12 Mar at 17:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/03-12">https://qt4cg.org/meeting/minutes/2024/03-12</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-220"><h2>Issue #220 closed<span class="toot-id"> #closed-220</span></h2><div class="pubdate">12 Mar at 17:18:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/220">https://github.com/qt4cg/qtspecs/issues/220</a></div><p>Encapsulation</p></div>
<div class="toot" id="closed-262"><h2>Issue #262 closed<span class="toot-id"> #closed-262</span></h2><div class="pubdate">12 Mar at 17:18:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/262">https://github.com/qt4cg/qtspecs/issues/262</a></div><p>Navigation in deep-structured arrays</p></div>
<div class="toot" id="closed-274"><h2>Issue #274 closed<span class="toot-id"> #closed-274</span></h2><div class="pubdate">12 Mar at 17:17:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/274">https://github.com/qt4cg/qtspecs/issues/274</a></div><p>What would it take/would it be possible to build a module repository for QT?</p></div>
<div class="toot" id="closed-295"><h2>Issue #295 closed<span class="toot-id"> #closed-295</span></h2><div class="pubdate">12 Mar at 17:17:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/295">https://github.com/qt4cg/qtspecs/issues/295</a></div><p>Extend support for self-reference in record types</p></div>
<div class="toot" id="closed-314"><h2>Issue #314 closed<span class="toot-id"> #closed-314</span></h2><div class="pubdate">12 Mar at 17:17:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/314">https://github.com/qt4cg/qtspecs/issues/314</a></div><p>Basic Operations on Maps and Arrays</p></div>
<div class="toot" id="closed-825"><h2>Issue #825 closed<span class="toot-id"> #closed-825</span></h2><div class="pubdate">12 Mar at 17:17:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/825">https://github.com/qt4cg/qtspecs/issues/825</a></div><p>array:members-at</p></div>
<div class="toot" id="closed-829"><h2>Issue #829 closed<span class="toot-id"> #closed-829</span></h2><div class="pubdate">12 Mar at 17:17:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/829">https://github.com/qt4cg/qtspecs/issues/829</a></div><p>fn:boolean: EBV support for more item types</p></div>
<div class="toot" id="closed-960"><h2>Issue #960 closed<span class="toot-id"> #closed-960</span></h2><div class="pubdate">12 Mar at 17:17:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/960">https://github.com/qt4cg/qtspecs/issues/960</a></div><p>Should ??KS flatten the results</p></div>
<div class="toot" id="closed-961"><h2>Issue #961 closed<span class="toot-id"> #closed-961</span></h2><div class="pubdate">12 Mar at 17:17:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/961">https://github.com/qt4cg/qtspecs/issues/961</a></div><p>Simulating Objects: Performance</p></div>
<div class="toot" id="closed-1037"><h2>Issue #1037 closed<span class="toot-id"> #closed-1037</span></h2><div class="pubdate">12 Mar at 17:16:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1037">https://github.com/qt4cg/qtspecs/issues/1037</a></div><p>fn:json-to-xml: 'number-parser' option</p></div>
<div class="toot" id="closed-1058"><h2>Issue #1058 closed<span class="toot-id"> #closed-1058</span></h2><div class="pubdate">12 Mar at 17:15:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1058">https://github.com/qt4cg/qtspecs/pull/1058</a></div><p>1037 fn:json-to-xml: 'number-parser' option</p></div>
<div class="toot" id="agenda-03-12"><h2>QT4 CG meeting 069 draft agenda<span class="toot-id"> #agenda-03-12</span></h2><div class="pubdate">11 Mar at 14:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/03-12">https://qt4cg.org/meeting/agenda/2024/03-12</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1070"><h2>Issue #1070 created<span class="toot-id"> #created-1070</span></h2><div class="pubdate">08 Mar at 23:10:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1070">https://github.com/qt4cg/qtspecs/issues/1070</a></div><details><summary>Concise syntax for map construction</summary><div class="markup"><p>It has been suggested that we should allow a "bare braces" syntax for map construction. This would reduce visual clutter especially when defining options arguments, as in</p>
<p><code>serialize($result, map{"method": "adaptive", "indent": true()})</code></p>
<p>I believe there are no syntactic obstacles to dropping the "map" keyword. The main reason it is there was because there was competition for the construct with people doing so-called scripting extensions who wanted "bare braces" to represent blocks of statements.</p>
<p>Allowing <code>{"method": "adaptive"}</code> would align with JSON.</p>
<p>But I think we should go a step further and drop the quotes:</p>
<p><code>{method: "adaptive"}</code></p>
<p>except that we could allow a string literal if the key isn't an NCName, as with record type syntax.</p>
<p>Could we do this and still allow computed or non-string keys? I don't think we need to, the existing syntax remains available.</p>
<p>So I propose we allow:</p>
<p><code>serialize($result, {method: "adaptive", indent: true()})</code></p>
<p>While we're about it, is there any enthusiasm for allowing</p>
<p><code>serialize($result, {method: "adaptive", indent: ✅})</code>  (: U+2705 :)</p>
</div></details></div>
<div class="toot" id="closed-596"><h2>Issue #596 closed<span class="toot-id"> #closed-596</span></h2><div class="pubdate">08 Mar at 22:45:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/596">https://github.com/qt4cg/qtspecs/issues/596</a></div><p>Pinned values: Transforming Trees</p></div>
<div class="toot" id="created-1069"><h2>Issue #1069 created<span class="toot-id"> #created-1069</span></h2><div class="pubdate">08 Mar at 03:58:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1069">https://github.com/qt4cg/qtspecs/issues/1069</a></div><details><summary>fn:ucd</summary><div class="markup"><p>This issue floats the idea of a new function, <code>fn:ucd</code> (for Unicode character database).</p>
<p>The working signature would be <code>fn:ucd($codepoint as xs:positiveInteger) as map(*)?</code>.  In the returned map, each entry would have a key that is a Unicode property name (full or abbreviated) and a value that reflects the property of <code>$character</code> in the Unicode character database.</p>
<p>What would users get? Access to a deep store of character data not otherwise (easily) available, such as name, name alias, bidirectional properties, age (when it entered Unicode), breaks (word, sentence, grapheme), scripts, and dozens of other properties. See <a href="https://www.unicode.org/reports/tr44/#Property_Index">Unicode TR 44</a>. Although many properties are of specialized interest, I think most people would find at least a few of these properties of significance.</p>
<p>Can't we already do this with regular expressions? Well, no. Category escapes in XPath regular expressions, e.g., <code>\p{Lm}</code>, are based upon general categories, but the properties mentioned above cut across these general categories. For example, general category <code>Pd</code> dash is not coterminous with the property <code>Dash</code>. Property <code>Quotation_Mark</code> crosses many subcategories of <code>P</code> Punctuation.</p>
<p>A few use cases:</p>
<p><strong>Extrapolation</strong>
<code>string-to-codepoints('ɑϞ') ! ('U+' || dec-to-hex(.) || ': ' || ucd(.)('Name'))</code> would return <code>('U+251: LATIN SMALL LETTER ALPHA', 'U+3DE: GREEK LETTER KOPPA')</code></p>
<p><strong>Filtering</strong>
<code>if (some $i in string-to-codepoints($text) satisfies ucd($i)('Soft_Dotted')) then...</code></p>
<p><strong>Annotating</strong></p>
<pre><code>&lt;div class="{myfunc:most-frequent((string-to-codepoints($text) ! ucd(.)('Script')))}"&gt;
    &lt;xsl:value-of select="$text"/&gt;
&lt;/div&gt;
</code></pre>
<p>might produce</p>
<pre><code>&lt;div class="Syriac"&gt;ܡܠܟܘܬܐ ܕܫܡܝܐ ܐܝܬܝܗ̇. ܠܐ ܚܫܘܫܘܬܐ ܕܢܦܫܐ܆ ܥܡ ܝܕܥܬܐ ܕܫܪܪܐ ܕܗܠܝܢ ܕܐܝܬܝܗܝܢ&lt;/div&gt;
</code></pre>
<p>And so forth. I can think of dozens of different types of operations where <code>fn:ucd</code> might be significant.</p>
<p>Thoughts?</p>
</div></details></div>
<div class="toot" id="created-1068"><h2>Pull request #1068 created<span class="toot-id"> #created-1068</span></h2><div class="pubdate">08 Mar at 01:51:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1068">https://github.com/qt4cg/qtspecs/pull/1068</a></div><details><summary>73 fn:graphemes</summary><div class="markup"><p>First draft of <code>fn:graphemes</code>, in response to discussion at #73 .</p>
<p>A battery of tests will be submitted as a PR to the qt4tests repository.</p>
</div></details></div>
<div class="toot" id="closed-1067"><h2>Issue #1067 closed<span class="toot-id"> #closed-1067</span></h2><div class="pubdate">07 Mar at 13:48:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1067">https://github.com/qt4cg/qtspecs/issues/1067</a></div><p>fn:deep-equal: significant children</p></div>
<div class="toot" id="created-1067"><h2>Issue #1067 created<span class="toot-id"> #created-1067</span></h2><div class="pubdate">07 Mar at 12:22:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1067">https://github.com/qt4cg/qtspecs/issues/1067</a></div><details><summary>fn:deep-equal: significant children</summary><div class="markup"><p>The current rules of <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-deep-equal">fn:deep-equal</a> are:</p>
<blockquote>
<p>e. Let <code>significant-children($parent)</code> be the sequence of nodes obtained by applying the following steps to the children of <code>$parent</code>, in turn:
&nbsp;&nbsp;i. Comment nodes are discarded if the option <code>comments</code> is false.
&nbsp;&nbsp;ii. Processing instruction nodes are discarded if the option <code>processing-instructions</code> is false.
&nbsp;&nbsp;iii. Adjacent text nodes are merged.
…
…the sequence <code>significant-children($i1)</code> is deep-equal to the sequence <code>significant-children($i2)</code>.</p>
</blockquote>
<p>If my interpretation is correct, the following expression is now expected to return <code>true</code>…</p>
<pre><code class="language-xquery">deep-equal(
  &lt;e&gt;A&lt;!----&gt;B&lt;/e&gt;,
  &lt;e&gt;AB&lt;/e&gt;
)
</code></pre>
<p>…and we need to update various test cases (e.g. <a href="https://github.com/qt4cg/qt4tests/blob/af7640a513bd7bda9f301a0cc8334a58bb5ea78e/fn/deep-equal.xml#L2390-L2398">K2-SeqDeepEqualFunc-22</a>).</p>
</div></details></div>
<div class="toot" id="created-1066"><h2>Pull request #1066 created<span class="toot-id"> #created-1066</span></h2><div class="pubdate">06 Mar at 22:03:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1066">https://github.com/qt4cg/qtspecs/pull/1066</a></div><details><summary>1052 Simplify the results of parse-csv</summary><div class="markup"><p>Changes parse-csv to deliver the results in a simpler format:</p>
<p>(a) the result structure is less deeply nested: one record with four entries
(b) the actual data is delivered as a sequence of arrays of strings, closely aligned with the result of <code>csv-to-arrays</code></p>
<p>The rules in the spec have also been rearranged to reflect this, so the rules are now organised according to the values delivered for each of these four fields.</p>
<p>The examples in the spec are changed to reflect the new output format; in addition they have been editorially reorganized so each example is more self-contained, avoiding the need for extensive scrolling to find the values of variables referenced in each example.</p>
<p>Fix issue #1052</p>
</div></details></div>
<div class="toot" id="created-1065"><h2>Issue #1065 created<span class="toot-id"> #created-1065</span></h2><div class="pubdate">06 Mar at 12:34:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1065">https://github.com/qt4cg/qtspecs/issues/1065</a></div><details><summary>fn:format-number: further notes</summary><div class="markup"><p>This issue summarizes suggestions for <code>fn:format-number</code> from the <a href="https://qt4cg.org/meeting/minutes/2024/03-05.html">QT4 Meeting 068</a> that have not yet been incorporated into the current draft:</p>
<ol>
<li>The <a href="https://cldr.unicode.org/translation/number-currency-formats/number-and-currency-patterns">Unicode Common Locale Data Repository</a> (CLDR) should be referenced; it has recommendations for all of the languages in Unicode and some variants.</li>
<li>We could consider introducing an options map so that we can just add more things later (such as e.g. an option for using the default decimal format for parsing the picture string, see https://github.com/qt4cg/qtspecs/issues/1048#issuecomment-1978869499).</li>
</ol>
</div></details></div>
<div class="toot" id="closed-919"><h2>Issue #919 closed<span class="toot-id"> #closed-919</span></h2><div class="pubdate">06 Mar at 12:06:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/919">https://github.com/qt4cg/qtspecs/issues/919</a></div><p>Should predicate callbacks use EBV?</p></div>
<div class="toot" id="closed-944"><h2>Issue #944 closed<span class="toot-id"> #closed-944</span></h2><div class="pubdate">06 Mar at 12:04:55 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/944">https://github.com/qt4cg/qtspecs/issues/944</a></div><p>Coercion rules: implicit types</p></div>
<div class="toot" id="closed-1047"><h2>Issue #1047 closed<span class="toot-id"> #closed-1047</span></h2><div class="pubdate">06 Mar at 12:02:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1047">https://github.com/qt4cg/qtspecs/issues/1047</a></div><p>Incorrect note for `fn:some` and `fn:every`</p></div>
<div class="toot" id="closed-1064"><h2>Issue #1064 closed<span class="toot-id"> #closed-1064</span></h2><div class="pubdate">06 Mar at 09:56:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1064">https://github.com/qt4cg/qtspecs/pull/1064</a></div><p>340-editorial fn:format-number</p></div>
<div class="toot" id="created-1064"><h2>Pull request #1064 created<span class="toot-id"> #created-1064</span></h2><div class="pubdate">06 Mar at 09:56:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1064">https://github.com/qt4cg/qtspecs/pull/1064</a></div><details><summary>340-editorial fn:format-number</summary><div class="markup"><p>…an addendum to the editorial change I made yesterday; will be merged in a minute.</p>
</div></details></div>
<div class="toot" id="closed-1054"><h2>Issue #1054 closed<span class="toot-id"> #closed-1054</span></h2><div class="pubdate">06 Mar at 09:45:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1054">https://github.com/qt4cg/qtspecs/issues/1054</a></div><p>Spec fn:message #id using old name fn:log</p></div>
<div class="toot" id="closed-1057"><h2>Issue #1057 closed<span class="toot-id"> #closed-1057</span></h2><div class="pubdate">06 Mar at 09:45:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1057">https://github.com/qt4cg/qtspecs/pull/1057</a></div><p>1054 Spec fn:message #id using old name fn:log</p></div>
<div class="toot" id="created-1063"><h2>Issue #1063 created<span class="toot-id"> #created-1063</span></h2><div class="pubdate">05 Mar at 23:20:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1063">https://github.com/qt4cg/qtspecs/issues/1063</a></div><details><summary>deep-equal() - option to compare functions liberally</summary><div class="markup"><p>We have changed deep-equal() so it no longer automatically treats functions as not equal.</p>
<p>However, it is still in practice infeasible to use deep-equal() for comparison of test results that include function items because it is not in general possible to supply an expected result that compares true to the function item actually returned. Since comparison of test results is an important use case for deep-equal, this is a serious limitation. It affects our own process that checks that output from examples in the spec is correct: the examples for parse-csv, for example, are artificially adjusted to make test comparison feasible by eliminating the function items in the result, which reduces the pedagogical value of the examples.</p>
<p>There should be an option such as <code>strict-function-comparison=true|false</code>. If set to false, then the function properties such as name, arity, and signature are compared, but the function body is ignored and assumed equal.</p>
</div></details></div>
<div class="toot" id="minutes-03-05"><h2>QT4 CG meeting 068 draft minutes<span class="toot-id"> #minutes-03-05</span></h2><div class="pubdate">05 Mar at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/03-05">https://qt4cg.org/meeting/minutes/2024/03-05</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-1053"><h2>Issue #1053 closed<span class="toot-id"> #closed-1053</span></h2><div class="pubdate">05 Mar at 17:19:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1053">https://github.com/qt4cg/qtspecs/pull/1053</a></div><p>1047 Default predicate for some#1 and every#1</p></div>
<div class="toot" id="closed-1046"><h2>Issue #1046 closed<span class="toot-id"> #closed-1046</span></h2><div class="pubdate">05 Mar at 17:16:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1046">https://github.com/qt4cg/qtspecs/pull/1046</a></div><p>1038 take-while predicate no longer uses EBV</p></div>
<div class="toot" id="closed-413"><h2>Issue #413 closed<span class="toot-id"> #closed-413</span></h2><div class="pubdate">05 Mar at 17:14:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/413">https://github.com/qt4cg/qtspecs/issues/413</a></div><p>New function: parse-csv()</p></div>
<div class="toot" id="closed-1017"><h2>Issue #1017 closed<span class="toot-id"> #closed-1017</span></h2><div class="pubdate">05 Mar at 17:13:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1017">https://github.com/qt4cg/qtspecs/issues/1017</a></div><p>Change csv-to-xml() to produce an XHTML table</p></div>
<div class="toot" id="closed-1043"><h2>Issue #1043 closed<span class="toot-id"> #closed-1043</span></h2><div class="pubdate">05 Mar at 17:13:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1043">https://github.com/qt4cg/qtspecs/issues/1043</a></div><p>CSV parsing - "blank" rows</p></div>
<div class="toot" id="closed-1051"><h2>Issue #1051 closed<span class="toot-id"> #closed-1051</span></h2><div class="pubdate">05 Mar at 17:13:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1051">https://github.com/qt4cg/qtspecs/pull/1051</a></div><p>1043 Clarification of CSV edge cases</p></div>
<div class="toot" id="closed-340"><h2>Issue #340 closed<span class="toot-id"> #closed-340</span></h2><div class="pubdate">05 Mar at 17:08:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/340">https://github.com/qt4cg/qtspecs/issues/340</a></div><p>fn:format-number: Specifying decimal format</p></div>
<div class="toot" id="closed-1049"><h2>Issue #1049 closed<span class="toot-id"> #closed-1049</span></h2><div class="pubdate">05 Mar at 17:00:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1049">https://github.com/qt4cg/qtspecs/pull/1049</a></div><p>340-partial fn:format-number: Specifying decimal format</p></div>
<div class="toot" id="closed-1061"><h2>Issue #1061 closed<span class="toot-id"> #closed-1061</span></h2><div class="pubdate">05 Mar at 12:54:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1061">https://github.com/qt4cg/qtspecs/issues/1061</a></div><p>discussion - language pragmas</p></div>
<div class="toot" id="created-1062"><h2>Pull request #1062 created<span class="toot-id"> #created-1062</span></h2><div class="pubdate">05 Mar at 12:05:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1062">https://github.com/qt4cg/qtspecs/pull/1062</a></div><details><summary>150bis - revised proposal for fn:ranks</summary><div class="markup"><p>This proposal is an amended/alternative proposal for the fn:ranks function, taking into account the work done on the original issue #150 and the PR #1027 and the comments raised. Acknowledgements to the original author for the idea and for a lot of good work on examples etc.</p>
<p>It amends the previous proposal as follows:</p>
<p>(a) the signature and the semantics are aligned with fn:sort. This adds some functionality (multiple sort keys, ascending/descending) and also removes some complexity (two different collations for comparing input items and result items)</p>
<p>(b) the style of exposition is changed editorially for consistency with other functions</p>
</div></details></div>
<div class="toot" id="created-1061"><h2>Issue #1061 created<span class="toot-id"> #created-1061</span></h2><div class="pubdate">05 Mar at 10:10:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1061">https://github.com/qt4cg/qtspecs/issues/1061</a></div><details><summary>discussion - language pragmas</summary><div class="markup"><p>The motivation is introducing breaking changes into the language that may have value, but not enough value to justify a breaking change.</p>
<p>Haskell uses language pragmas for this, and actually most (well, a lot) Haskell code does not use the base specification, and quite common constructs (GADTs, multi param type classes) require extensions.</p>
<p>Haskell devs are used to this, it may require some referring to the the top of the file to change the pragmas but its a working solution to introducing optional things that may be breaking changes.</p>
<p>Thoughts?</p>
<p>Benefits</p>
<ul>
<li>allows breaking changes to be introduced</li>
</ul>
<p>Costs</p>
<ul>
<li>developers may have to refer to the language pragma to correctly understand the code</li>
<li>implementation explosion, extensions may not be independent and interact causing an explosion of combinations of extensions (though i think its reasonable for an implementation to just implement combinations that are practical).</li>
</ul>
<p>I'm biased, I want to introduce breaking changes, but am thwarted by the versioning strategy.</p>
</div></details></div>
<div class="toot" id="created-1060"><h2>Issue #1060 created<span class="toot-id"> #created-1060</span></h2><div class="pubdate">04 Mar at 17:57:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1060">https://github.com/qt4cg/qtspecs/issues/1060</a></div><details><summary>Formatting XPath/XQuery</summary><div class="markup"><p>I got reminded today that the specification documents are kind of “wild”, because all code snippets use a different formatting:</p>
<ul>
<li>The indentation is inconsistent (the tendency seems to be 2 spaces, in accordance with the function signatures). Repeatedly, indentations are used that don’t seem to follow any conventions at all.</li>
<li>Sometimes, <code>function</code>, <code>map</code> and <code>array</code> keywords are followed by a space, sometimes not. My preference would be not be too stingy; we have enough space.</li>
<li>Sometimes, the <code>return</code> keyword starts in a new line, sometimes it’s attached to the previous line.</li>
</ul>
<p>This is certainly something we cannot finalize too early, but I think we shouldn’t be too erratic in an official document, even though it’s “just code”.</p>
<p>Related: #1000.</p>
</div></details></div>
<div class="toot" id="created-1059"><h2>Pull request #1059 created<span class="toot-id"> #created-1059</span></h2><div class="pubdate">04 Mar at 15:32:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1059">https://github.com/qt4cg/qtspecs/pull/1059</a></div><details><summary>1019 XQFO: Unknown option parameters</summary><div class="markup"><p>Issue: #1019</p>
</div></details></div>
<div class="toot" id="created-1058"><h2>Pull request #1058 created<span class="toot-id"> #created-1058</span></h2><div class="pubdate">04 Mar at 14:37:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1058">https://github.com/qt4cg/qtspecs/pull/1058</a></div><details><summary>1037 fn:json-to-xml: 'number-parser' option</summary><div class="markup"><p>Issue: #1037</p>
</div></details></div>
<div class="toot" id="created-1057"><h2>Pull request #1057 created<span class="toot-id"> #created-1057</span></h2><div class="pubdate">04 Mar at 14:31:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1057">https://github.com/qt4cg/qtspecs/pull/1057</a></div><details><summary>1054 Spec fn:message #id using old name fn:log</summary><div class="markup"><p>Issue: #1054</p>
</div></details></div>
<div class="toot" id="closed-1056"><h2>Issue #1056 closed<span class="toot-id"> #closed-1056</span></h2><div class="pubdate">04 Mar at 12:30:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1056">https://github.com/qt4cg/qtspecs/issues/1056</a></div><p>Simplifying match templates</p></div>
<div class="toot" id="created-1056"><h2>Issue #1056 created<span class="toot-id"> #created-1056</span></h2><div class="pubdate">01 Mar at 13:53:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1056">https://github.com/qt4cg/qtspecs/issues/1056</a></div><details><summary>Simplifying match templates</summary><div class="markup"><p>I like match templates a lot, I think they are a USP for XSLT, but I find using them quite clumsy e.g.</p>
<ul>
<li>priority rules are quite subtle (I couldn't tell you what they are not, and I tend to make them explicit)</li>
<li>because each match sits in a different template they tend to sort of drift around in the spaghetti of the code</li>
<li>they don't naturally extend to nested local matches....everything exists at the top level.</li>
</ul>
<p>If you compare this with main stream functional match expressions then they are quite syntactically different, and I think the mainstream syntax is probably a bit simpler (and much more familiar)
(I can see this potentially extending to lots of subsequent things but I'll keep it to the headline)</p>
<p>I think something like</p>
<pre><code>&lt;xsl:template mode="foo" as="xs:string"&gt;
    &lt;xsl:match select="Foo"&gt;
        &lt;xsl:sequence select="'this is a foo'"/&gt;
    &lt;/xsl:match&gt;
    &lt;xsl:match select="Bar"&gt;
        &lt;xsl:sequence select="'this is a bar'"/&gt;
    &lt;/xsl:match&gt;
    &lt;xsl:match&gt;
        &lt;xsl:sequence select="'this is something else'"/&gt;
    &lt;/xsl:match&gt;
&lt;/xsl:template&gt;
</code></pre>
<ul>
<li>templates are matched in sequence (as is the norm), no opaque priority rules</li>
<li>if nothing is matched then nothing is returned...I have effectively a catchall match above.</li>
<li>everything is cohesive, the template contains all matches....no secret ones hidden at the bottom of the file.</li>
</ul>
<p>there's lots of holes here,</p>
<ul>
<li>how does this interact with existing match templates?</li>
<li>are the a different syntax for the same thing?</li>
<li>how do they work with includes and imports?</li>
</ul>
<p>my guesses are...they ARE just different syntax for the existing infrastructure...because thats the smallest change.
and then the other questions are answered by how the above syntax maps into "priority" but tbh, as I barely know how the current priority rules work, I can't really give a sensible guess.</p>
<p>tbh, if this is just different syntax then secret matches CAN exist elsewhere in the spaghetti, but at least the programmer does have a construct to not do that, rather than the default contract to lack cohesion from the outset.</p>
</div></details></div>
<div class="toot" id="created-1055"><h2>Issue #1055 created<span class="toot-id"> #created-1055</span></h2><div class="pubdate">01 Mar at 13:20:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1055">https://github.com/qt4cg/qtspecs/issues/1055</a></div><details><summary>xsl:variable/@as - simplifying the language - attempt 2</summary><div class="markup"><p>I've thought about it.</p>
<p>The key issue I had which genuinely caused me years of confusion (I didnt understand it so I ignored it, and dealt with it by typeing random xslt code)....this....</p>
<pre><code>            &lt;xsl:variable name="presentationMediaElement" as="element(urn:presentationMedia)"&gt;
                &lt;presentationMedia/&gt;
            &lt;/xsl:variable&gt;
</code></pre>
<p>if I don't declare the "as" then it does something different and confusing (it assumes its a document element <strong>I think</strong>, though I NEVER want it to do this).</p>
<p>so for stylesheets declared as version "4.0"+, can we make the default interpretation of that its an element?</p>
<p>Does this breaks backwards compatability with v1? tbh, the code is already incompatible because the equivalent 1.0 code requires <code>node-set</code>, its already broken, so I suggest making the fix simple to understand.</p>
<p>why is this so irksome to me?
because for me its <strong>incredibly</strong> confusing</p>
<p>its confusing because (and i didnt express this well the last time), it makes a type declaration have inconsistent behaviours.</p>
<p>In languages with OO (is it reynolds?) type systems this also happens  BUT in an OO type system an expression has a type than can be cast to a <strong>subtype</strong> and a subtype is very special because everything that is true of the supertype (in the constained type logic) is true of the subtype (you can express this in terms of set/class membership in a universe if thats how you think about these things).</p>
<p>but in this case, this isnt the case....the two interpretations are disjoint, this isnt a cast.</p>
<p>So the concrete proposal is uniquely define the semantics of.</p>
<pre><code>             &lt;xsl:variable name="presentationMediaElement"&gt;
                &lt;presentationMedia/&gt;
            &lt;/xsl:variable&gt;
</code></pre>
<p>to be</p>
<pre><code>            &lt;xsl:variable name="presentationMediaElement" as="element(urn:presentationMedia)"&gt;
                &lt;presentationMedia/&gt;
            &lt;/xsl:variable&gt;
</code></pre>
<p>from 4.0 onwards.</p>
<p>(ironically, personally i will probably still put the "as" clause in, but if i were trying to learn the language today I'd understand this on day 1, not day 1000).</p>
<p>P.S.</p>
<p>I have a suspicion I still dont fully understand it, but i'm sure someone will point that out in due course.</p>
</div></details></div>
<div class="toot" id="created-1054"><h2>Issue #1054 created<span class="toot-id"> #created-1054</span></h2><div class="pubdate">01 Mar at 10:50:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1054">https://github.com/qt4cg/qtspecs/issues/1054</a></div><details><summary>Spec fn:message #id using old name fn:log</summary><div class="markup"><ul>
<li>https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-message</li>
<li>https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-log</li>
</ul>
</div></details></div>
<div class="toot" id="closed-1018"><h2>Issue #1018 closed<span class="toot-id"> #closed-1018</span></h2><div class="pubdate">29 Feb at 10:11:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1018">https://github.com/qt4cg/qtspecs/issues/1018</a></div><p>Output of parse-csv()</p></div>
<div class="toot" id="created-1053"><h2>Pull request #1053 created<span class="toot-id"> #created-1053</span></h2><div class="pubdate">29 Feb at 10:06:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1053">https://github.com/qt4cg/qtspecs/pull/1053</a></div><details><summary>1047 Default predicate for some#1 and every#1</summary><div class="markup"><p>Changes the default predicate for <code>fn:some#1</code> and <code>fn:every#1</code> to be <code>fn:boolean#1</code>, which takes the EBV of the items in the input sequence. The previous use of <code>fn:identity#1</code> caused some unexpected behaviour.</p>
</div></details></div>
<div class="toot" id="created-1052"><h2>Issue #1052 created<span class="toot-id"> #created-1052</span></h2><div class="pubdate">29 Feb at 08:41:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1052">https://github.com/qt4cg/qtspecs/issues/1052</a></div><details><summary>parse-csv() - simplify output</summary><div class="markup"><p>Currently parse-csv produces a structure like this:</p>
<pre><code>map {
  "columns": map {
      "names": map{"one":1, "two":2},
      "fields": ("one", "two")
   }
  "rows":  (
     map{
        "fields": ("aaa", "bbb"),
        "field" fn($col){$this?fields[$col]}
    },
   map{
        "fields": ("ccc", "ddd"),
        "field" fn($col){$this?fields[$col]}
    }
 )
}
</code></pre>
<p>There are a number of ways this could be improved.</p>
<ul>
<li>The structure is needlessly different from the return value of maps-to-arrays(). Users will get confused between the two representations, and will find it hard to switch from one to the other. For example, one delivers rows as sequences, the other delivers rows as arrays.</li>
<li>There are too many levels in the structure; the expressions to select within it are unnecessarily complicated, and users will get poor diagnostics when they get it wrong.</li>
<li>In this example (with two columns) for each row there is one map, one sequence, one function, and two strings - five values in all. The output of <code>csv-to-arrays</code> has only three objects (one array and two strings). However hard an optimized implementation tries to reduce the overhead, the space occupied by a million-row parsed CSV is likely to be larger than needed.</li>
<li>The use of sequences rather than arrays means that no JSON-serialization of the structure is possible</li>
</ul>
<p>I propose using a flatter structure, like this pseudo-code sketch:</p>
<pre><code>map {
      "column-index": map{"one":1, "two":2},
      "columns": ["one", "two"]
      "rows": (
         ["aaa", "bbb"],
         ["ccc", "ddd"]
     )
     "get": fn($row, $col){$this?rows[$row]($col)}
     "size": fn(){count($this?rows)}
}
</code></pre>
<p>This doesn't meet all the objections outlined above; for example it represents rows as a sequence of arrays, which is consistent with <code>csv-to-arrays</code>, but not JSON-serializable. But I think it's a considerable improvement.</p>
</div></details></div>
<div class="toot" id="created-1051"><h2>Pull request #1051 created<span class="toot-id"> #created-1051</span></h2><div class="pubdate">28 Feb at 23:58:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1051">https://github.com/qt4cg/qtspecs/pull/1051</a></div><details><summary>1043 Clarification of CSV edge cases</summary><div class="markup"><p>Gives a more precise definition of blank rows and empty fields, and generally adds detail on how edge cases should be handled.</p>
<p>Fix #1043.</p>
</div></details></div>
<div class="toot" id="closed-1038"><h2>Issue #1038 closed<span class="toot-id"> #closed-1038</span></h2><div class="pubdate">28 Feb at 22:23:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1038">https://github.com/qt4cg/qtspecs/issues/1038</a></div><p>Backwards incompatibility caused by use of EBV in callback functions</p></div>
<div class="toot" id="created-1050"><h2>Issue #1050 created<span class="toot-id"> #created-1050</span></h2><div class="pubdate">28 Feb at 16:02:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1050">https://github.com/qt4cg/qtspecs/issues/1050</a></div><details><summary>Potential (low-risk) Ambiguities in XPath EBNF</summary><div class="markup"><p>After demonstrating <code>iXML</code> XPath grammar production at the meeting of 27th Feburary, it seemed worth recording some of the ambiguity issues encountered, if only so others might be aware of possible pitfalls.</p>
<p>Please note that the <a href="https://qt4cg.org/specifications/xquery-40/xpath-40.html#lexical-structure">Lexical Structure</a> notes in the spec <em>do</em> resolve these ambiguities, by extra-grammatical interpretations, most notably the choice of <em>longest conforming match</em>, but for grammar/parsers which don't specify or support this, such as <a href="https://invisiblexml.org/">InvisibleXML</a>, ambiguities might arise, though there may be ameliorating changes to the resulting grammar that will resolve them. <strong>I am not advocating changes to the specification EBNF</strong>  but merely noting where such problems might occur from my implementation experience, and potentially suggesting some workarounds.</p>
<p>Here are a couple of cases:</p>
<h3>TypeName / AtomicOrUnionType</h3>
<p>The rule for <code>ItemType </code>is ~</p>
<blockquote>
<p><code>ItemType ::= ... TypeName| .... | AtomicOrUnionType |  ... </code></p>
</blockquote>
<p>where both <code>TypeName </code>and <code>AtomicOrUnionType</code> resolve solely to the <code>EQName </code>production. The grammar interpretation notes suggests (I think) that it binds to <code>TypeName</code> if such exists in the current static context, which is an extra-grammatical concept, but I may be mistaken.</p>
<h3>StringTemplate</h3>
<p>The productions for StringTemplate are:</p>
<pre><code>[106]   	StringTemplate	             ::=   	"`" (StringTemplateFixedPart | StringTemplateVariablePart)* "`"	
[107]   	StringTemplateFixedPart	     ::=   	((Char - ('{' | '}' | '`')) | "{{" | "}}" | "``")*
[108]   	StringTemplateVariablePart   ::=   	EnclosedExpr 
</code></pre>
<p>where it relies on <em>longest match</em> semantics to avoid ambiguity. (If this was not the case a potential infinity of empty  <code>StringTemplateFixedPart</code> productions could be satisfied, or any sequential partitions of a sequence of characters.)</p>
<p>An alternative (recursive and more cumbersome) formulation, which avoids the ambiguity is (in an iXML grammar for compactness):</p>
<pre><code>               StringTemplate: -"`", StringTemplateContent?, -"`".
       -StringTemplateContent: StringTemplateFixedPart |
                               StringTemplateVariablePart |
                               StringTemplateVariablePart, StringTemplateContent |
                               StringTemplateFixedPart, StringTemplateVariablePart, StringTemplateContent?.
      StringTemplateFixedPart: ("{{"; "}}"; "``"; ~["`{}"])+.
</code></pre>
<p><code>StringTemplateVariablePart</code> remains unchanged. (iXML doesn't support character set subtraction, so <code>~["``{}"]</code> (<em>any character except...</em>) is used for the <code>Char -  ....</code> term.) By allowing a fixed part only to be followed by a variable part, this effectively permits the content either to be empty, or a sequence of parts such that <code>StringTemplateVariablePart</code> terms can be consecutive, but not <code>StringTemplateFixedPart</code> and it seems to work effectively, at least in my iXML parser.</p>
<p>Reactions, corrections, remarks, praise and brickbats welcome.
I'll document any more as I find them.
John</p>
</div></details></div>
<div class="toot" id="created-1049"><h2>Pull request #1049 created<span class="toot-id"> #created-1049</span></h2><div class="pubdate">28 Feb at 13:46:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1049">https://github.com/qt4cg/qtspecs/pull/1049</a></div><details><summary>340-partial fn:format-number: Specifying decimal format</summary><div class="markup"><p>The PR introduces an additional <code>$format</code> argument to <code>fn:format-number</code>, which allows you to override decimal formats with custom properties.</p>
<p>Next, we may need to clarify if the current specification already allows processors to provide custom decimal formats (https://github.com/qt4cg/qtspecs/issues/340#issuecomment-1968856655). It’s not part of this PR.</p>
</div></details></div>
<div class="toot" id="created-1048"><h2>Issue #1048 created<span class="toot-id"> #created-1048</span></h2><div class="pubdate">28 Feb at 11:14:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1048">https://github.com/qt4cg/qtspecs/issues/1048</a></div><details><summary>fn:format-number: relax restrictions on exponent-separator (possibly minus-sign, percent, per-mille)</summary><div class="markup"><p>The current rules for decimal formats are too restrictive (i.e., too much focused on Anglo-Saxon formatting rules). The most prominent case is the Arabic exponent-separator „character“, which consists of two characters: <code>عر</code> (https://www.localeplanet.com/icu/ar/). The exponent separator of other locales is not restricted to a single character either. For example, <code>se-NO</code> uses <code>·10^</code>.</p>
<p>When we include the ICU library in the analysis, we also find <code>minus-sign</code>, <code>percent</code> and <code>per-mille</code> properties that are longer than 1 character. Examples:</p>
<ul>
<li>The <code>minus-sign</code> character for <code>he</code> consists of <code>200e</code> and <code>002d</code> (<code>200e</code> is the Left-to-Right Mark).</li>
<li>The Arabic <code>percent</code> character consists of <code>066a</code> and <code>061c</code> (<code>061c</code> is the “Arabic Letter Mark”).</li>
<li>The <code>per-mille</code> property of <code>en-US-posix</code> is <code>0/00</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="created-1047"><h2>Issue #1047 created<span class="toot-id"> #created-1047</span></h2><div class="pubdate">28 Feb at 10:13:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1047">https://github.com/qt4cg/qtspecs/issues/1047</a></div><details><summary>Incorrect note for `fn:some` and `fn:every`</summary><div class="markup"><p><code>fn:some</code> and <code>fn:every</code> state (non-normatively):</p>
<blockquote>
<p>"If the second argument is omitted or an empty sequence, the first argument must be a sequence of xs:boolean values.".</p>
</blockquote>
<p>I don't think this note is correct. If the default predicate <code>identity#1</code> is used, it is coerced to the required type <code>function(item()) as xs:boolean</code>, so the effective predicate is <code>fn($x as item()) as xs:boolean {identity($x)}</code>. This atomises the result of calling <code>identity($x)</code> and casts the result to <code>xs:boolean</code>. Therefore expressions such as <code>some([true()])</code> and <code>some(&lt;a&gt;true&lt;/a&gt;)</code> return true, not an error.</p>
</div></details></div>
<div class="toot" id="created-1046"><h2>Pull request #1046 created<span class="toot-id"> #created-1046</span></h2><div class="pubdate">28 Feb at 09:55:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1046">https://github.com/qt4cg/qtspecs/pull/1046</a></div><details><summary>1038 take-while predicate no longer uses EBV</summary><div class="markup"><p>See issue #1038, which pointed out compatibility problems with using EBV for callback predicates, as proposed in issue #919.</p>
<p>In specifying <code>fn:take-while</code> we anticipated acceptance of the proposal to use EBV for predicate callbacks; now that we have decided not to make that change, this PR brings <code>take-while</code> into alignment with other functions using a predicate callback.</p>
</div></details></div>
<div class="toot" id="closed-1016"><h2>Issue #1016 closed<span class="toot-id"> #closed-1016</span></h2><div class="pubdate">27 Feb at 17:31:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1016">https://github.com/qt4cg/qtspecs/issues/1016</a></div><p>Editorial comments on fn:parse-csv()</p></div>
<div class="toot" id="closed-1042"><h2>Issue #1042 closed<span class="toot-id"> #closed-1042</span></h2><div class="pubdate">27 Feb at 17:30:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1042">https://github.com/qt4cg/qtspecs/pull/1042</a></div><p>1016 Editorial cleanup - csv-to-arrays</p></div>
<div class="toot" id="closed-236"><h2>Issue #236 closed<span class="toot-id"> #closed-236</span></h2><div class="pubdate">27 Feb at 17:28:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/236">https://github.com/qt4cg/qtspecs/issues/236</a></div><p>map:build: sequence of keys</p></div>
<div class="toot" id="closed-1041"><h2>Issue #1041 closed<span class="toot-id"> #closed-1041</span></h2><div class="pubdate">27 Feb at 17:28:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1041">https://github.com/qt4cg/qtspecs/pull/1041</a></div><p>236 map:build: sequence of keys</p></div>
<div class="toot" id="closed-988"><h2>Issue #988 closed<span class="toot-id"> #closed-988</span></h2><div class="pubdate">27 Feb at 17:22:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/988">https://github.com/qt4cg/qtspecs/pull/988</a></div><p>960 Pinned and labeled values</p></div>
<div class="toot" id="minutes-02-27"><h2>QT4 CG meeting 067 draft minutes<span class="toot-id"> #minutes-02-27</span></h2><div class="pubdate">27 Feb at 17:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/02-27">https://qt4cg.org/meeting/minutes/2024/02-27</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-485"><h2>Issue #485 closed<span class="toot-id"> #closed-485</span></h2><div class="pubdate">27 Feb at 17:19:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/485">https://github.com/qt4cg/qtspecs/issues/485</a></div><p>Predeclared namespaces in XQuery</p></div>
<div class="toot" id="closed-1040"><h2>Issue #1040 closed<span class="toot-id"> #closed-1040</span></h2><div class="pubdate">27 Feb at 17:18:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1040">https://github.com/qt4cg/qtspecs/pull/1040</a></div><p>485 Predeclared namespaces in XQuery: output</p></div>
<div class="toot" id="closed-1029"><h2>Issue #1029 closed<span class="toot-id"> #closed-1029</span></h2><div class="pubdate">27 Feb at 17:14:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1029">https://github.com/qt4cg/qtspecs/issues/1029</a></div><p>Make argument of fn:void optional</p></div>
<div class="toot" id="closed-1032"><h2>Issue #1032 closed<span class="toot-id"> #closed-1032</span></h2><div class="pubdate">27 Feb at 17:14:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1032">https://github.com/qt4cg/qtspecs/pull/1032</a></div><p>1029 Make argument of fn:void optional</p></div>
<div class="toot" id="closed-1033"><h2>Issue #1033 closed<span class="toot-id"> #closed-1033</span></h2><div class="pubdate">27 Feb at 17:09:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1033">https://github.com/qt4cg/qtspecs/pull/1033</a></div><p>QT4CG-066-01 Add note that whitespace and comments in regexen are lexical constructs</p></div>
<div class="toot" id="closed-356"><h2>Issue #356 closed<span class="toot-id"> #closed-356</span></h2><div class="pubdate">27 Feb at 17:08:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/356">https://github.com/qt4cg/qtspecs/issues/356</a></div><p>array:leaves</p></div>
<div class="toot" id="closed-843"><h2>Issue #843 closed<span class="toot-id"> #closed-843</span></h2><div class="pubdate">27 Feb at 17:08:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/843">https://github.com/qt4cg/qtspecs/issues/843</a></div><p>Standard, array &amp; map functions: Equivalencies</p></div>
<div class="toot" id="closed-872"><h2>Issue #872 closed<span class="toot-id"> #closed-872</span></h2><div class="pubdate">27 Feb at 17:08:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/872">https://github.com/qt4cg/qtspecs/issues/872</a></div><p>Symmetry: fn:items-at → fn:get</p></div>
<div class="toot" id="closed-990"><h2>Issue #990 closed<span class="toot-id"> #closed-990</span></h2><div class="pubdate">27 Feb at 17:08:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/990">https://github.com/qt4cg/qtspecs/issues/990</a></div><p>Transitive closure on non-nodes</p></div>
<div class="toot" id="closed-1007"><h2>Issue #1007 closed<span class="toot-id"> #closed-1007</span></h2><div class="pubdate">27 Feb at 17:08:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1007">https://github.com/qt4cg/qtspecs/issues/1007</a></div><p>How to invert a predicate function</p></div>
<div class="toot" id="closed-1030"><h2>Issue #1030 closed<span class="toot-id"> #closed-1030</span></h2><div class="pubdate">27 Feb at 17:07:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1030">https://github.com/qt4cg/qtspecs/issues/1030</a></div><p>allow pattern matches in axis expression</p></div>
<div class="toot" id="closed-1034"><h2>Issue #1034 closed<span class="toot-id"> #closed-1034</span></h2><div class="pubdate">27 Feb at 17:05:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1034">https://github.com/qt4cg/qtspecs/pull/1034</a></div><p>QT4CG-066-xx Add note regarding absence of drop-while / skip-while</p></div>
<div class="toot" id="closed-1024"><h2>Issue #1024 closed<span class="toot-id"> #closed-1024</span></h2><div class="pubdate">27 Feb at 17:00:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1024">https://github.com/qt4cg/qtspecs/issues/1024</a></div><p>Precedence of `otherwise` operator</p></div>
<div class="toot" id="closed-1031"><h2>Issue #1031 closed<span class="toot-id"> #closed-1031</span></h2><div class="pubdate">27 Feb at 17:00:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1031">https://github.com/qt4cg/qtspecs/pull/1031</a></div><p>1024 Change precedence of 'otherwise' operator</p></div>
<div class="toot" id="closed-1003"><h2>Issue #1003 closed<span class="toot-id"> #closed-1003</span></h2><div class="pubdate">27 Feb at 17:00:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1003">https://github.com/qt4cg/qtspecs/pull/1003</a></div><p>919 Use EBV in boolean callbacks</p></div>
<div class="toot" id="created-1045"><h2>Issue #1045 created<span class="toot-id"> #created-1045</span></h2><div class="pubdate">26 Feb at 13:22:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1045">https://github.com/qt4cg/qtspecs/issues/1045</a></div><details><summary>Functions to manage namespace usage</summary><div class="markup"><p>Prior to saving XML generated in XQuery I often tweak the namespace usage.
This makes the XML lighter and clearer for the casual reader and is sometimes mandated by users and systems.
I think providing builtin solutions for these cases would ease these tasks.</p>
<p>Common cases are:</p>
<ol>
<li>
<p>Remove unused prefixes
Example: the function presented at https://stackoverflow.com/questions/23002655/xquery-how-to-remove-unused-namespace-in-xml-node</p>
</li>
<li>
<p>Make a namespace the default wherever it is used.
Example: <code>functx:change-element-ns-deep($nodes,$targetns,"")</code><br>
See  http://www.xqueryfunctions.com/xq/functx_change-element-ns-deep.html</p>
</li>
<li>
<p>Remove the use of all/some namespaces
Example: BaseX https://docs.basex.org/wiki/Utility_Module#util:strip-namespaces</p>
</li>
</ol>
<p>A somewhat related issue https://github.com/qt4cg/qtspecs/issues/266</p>
</div></details></div>
<div class="toot" id="agenda-02-27"><h2>QT4 CG meeting 067 draft agenda<span class="toot-id"> #agenda-02-27</span></h2><div class="pubdate">26 Feb at 11:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/02-27">https://qt4cg.org/meeting/agenda/2024/02-27</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1044"><h2>Issue #1044 created<span class="toot-id"> #created-1044</span></h2><div class="pubdate">26 Feb at 10:50:11 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1044">https://github.com/qt4cg/qtspecs/issues/1044</a></div><details><summary>CSV row delimiter - allowed values</summary><div class="markup"><p>Section 15.4.2.1 says:</p>
<blockquote>
<p>The row delimiter defaults to matching any of CRLF (
), LF (
), or CR (
). Valid values for the row delimiter are a single Unicode character, or one of CRLF, LF, or CR, that has not been marked for use as the column delimiter. Implementations must raise [[err:FOCV0002](] if the row-delimiter option is set to a multi-character string other than CRLF (
)</p>
</blockquote>
<ol>
<li>It's not entirely clear to me what this is saying. Are alternative row delimiters other than newline delimiters allowed (<code>row-delimiter:('|','/')</code>?</li>
<li>The statement in this section doesn't align with the error conditions appearing in the actual function specs, which says: "A dynamic error [[err:FOCV0002] occurs if one or more of the values for field-delimiter or quote-character are specified and are not a single character." - no mention here of the row-delimiter.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1043"><h2>Issue #1043 created<span class="toot-id"> #created-1043</span></h2><div class="pubdate">26 Feb at 08:59:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1043">https://github.com/qt4cg/qtspecs/issues/1043</a></div><details><summary>CSV parsing - "blank" rows</summary><div class="markup"><p>The CSV parsing specification states "A blank row is represented as an empty array.".</p>
<ol>
<li>
<p>It's not clear what "blank" means here. Does it depend on the whitespace-trimming option?</p>
</li>
<li>
<p>It would be more logical to return an array containing a single zero-length string, since any other line containing no field delimiter is considered to contain one field.</p>
</li>
<li>
<p>Alternatively, it might make sense to ignore the row entirely.</p>
</li>
</ol>
</div></details></div>
<div class="toot" id="created-1042"><h2>Pull request #1042 created<span class="toot-id"> #created-1042</span></h2><div class="pubdate">26 Feb at 00:11:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1042">https://github.com/qt4cg/qtspecs/pull/1042</a></div><details><summary>1016 Editorial cleanup - csv-to-arrays</summary><div class="markup"><p>The changes here are almost entirely editorial, reordering material, removing duplication and changing some of the language for consistency with the rest of the spec. There is one substantive change - the function <code>csv-to-simple-rows</code> is renamed <code>csv-to-arrays</code>.</p>
<p>Fix #1016</p>
</div></details></div>
<div class="toot" id="created-1041"><h2>Pull request #1041 created<span class="toot-id"> #created-1041</span></h2><div class="pubdate">23 Feb at 10:47:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1041">https://github.com/qt4cg/qtspecs/pull/1041</a></div><details><summary>236 map:build: sequence of keys</summary><div class="markup"><p>Issue: #236</p>
</div></details></div>
<div class="toot" id="created-1040"><h2>Pull request #1040 created<span class="toot-id"> #created-1040</span></h2><div class="pubdate">23 Feb at 09:23:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1040">https://github.com/qt4cg/qtspecs/pull/1040</a></div><details><summary>485 Predeclared namespaces in XQuery: output</summary><div class="markup"><p>Issue: #485</p>
</div></details></div>
<div class="toot" id="created-1039"><h2>Issue #1039 created<span class="toot-id"> #created-1039</span></h2><div class="pubdate">22 Feb at 09:42:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1039">https://github.com/qt4cg/qtspecs/issues/1039</a></div><details><summary>Allow dynamic collations in XQuery "order by" and "group by"</summary><div class="markup"><p>I propose that in "order by" and "group by" clauses, the keyword "collation" should be followed by an expression rather than by a URILiteral.</p>
<p>The only problem this causes is if the expression depends on variables in the tuple stream, because obviously the collation must be selected for the tuple stream as a whole, not for each individual tuple.</p>
<p>We can solve this problem by amending the rules for the scope of variables bound in FLWOR expressions (§4.15.1 rule 1) so that collation expressions are excluded from the scope; or perhaps (it might be simpler) to make it a static error if the collation expression refers to a variable bound in the containing FLWOR expression.</p>
<p>If the syntax allows a general expression then a simple <code>"quoted-string"</code> will be interpreted as a <code>StringLiteral</code> rather than a <code>URILiteral</code>. As far as I'm aware the two things are syntactically and semantically identical so this isn't a problem.</p>
</div></details></div>
<div class="toot" id="created-1038"><h2>Issue #1038 created<span class="toot-id"> #created-1038</span></h2><div class="pubdate">21 Feb at 21:03:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1038">https://github.com/qt4cg/qtspecs/issues/1038</a></div><details><summary>Backwards incompatibility caused by use of EBV in callback functions</summary><div class="markup"><p>Changing fn:filter and similar functions that existed in 3.1 to use the EBV of the callback function's result has introduced a backwards incompatibility. In 3.1, the function conversion rules were used to convert the callback function's result to <code>xs:boolean</code>. This involves atomization. If the callback returned the untyped node <code>&lt;a&gt;false&lt;/a&gt;</code>, this is atomised as <code>false()</code>, but its EBV is <code>true()</code>.</p>
<p>Revealed by test case fn:filter-006.</p>
<p>I think it's unlikely to happen much in practice, but it's a bit nasty. Perhaps we shouldn't make the change to use EBV for functions that existed in 3.1?</p>
<p>Perhaps we should even consider reverting the change entirely. It's not exactly essential.</p>
</div></details></div>
<div class="toot" id="created-1037"><h2>Issue #1037 created<span class="toot-id"> #created-1037</span></h2><div class="pubdate">21 Feb at 17:22:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1037">https://github.com/qt4cg/qtspecs/issues/1037</a></div><details><summary>fn:json-to-xml: 'number-parser' option</summary><div class="markup"><p>A function supplied via the <code>number-parser</code> option of <code>fn:json-to-xml</code> is now allowed to return zero or <del>more</del> <strong>one</strong> items (see #973). Analogous to the <code>action</code> argument of <code>fn:replace</code>, the result should be converted to a string by invoking <code>fn:string</code> on the result. An example:</p>
<pre><code class="language-xquery">json-to-xml('-1', map { 'number-parser': abs#1 })
→ &lt;fn:number&gt;1&lt;/fn:number&gt;

json-to-xml('1', map { 'number-parser': fn { true#0 } })
→ err:FOTY0013
</code></pre>
<p>No change is required for <code>fn:parse-json</code>.</p>
</div></details></div>
<div class="toot" id="created-1036"><h2>Issue #1036 created<span class="toot-id"> #created-1036</span></h2><div class="pubdate">21 Feb at 13:19:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1036">https://github.com/qt4cg/qtspecs/issues/1036</a></div><details><summary>parse-json: liberal parsing</summary><div class="markup"><p>I noticed that some new test cases (<a href="https://github.com/qt4cg/qt4tests/blob/1859042e97f5d2ce4917bd3eef7beae4e5f64171/fn/parse-json.xml#L960-L973"><code>fn-parse-json-712</code></a>, <code>fn-parse-json-716</code>, possibly others) rely on specific liberal parsing rules.</p>
<p>@michaelhkay Do you think that it could make sense to formalize some of those rules, or should we rather fix the test cases?</p>
</div></details></div>
<div class="toot" id="closed-1005"><h2>Issue #1005 closed<span class="toot-id"> #closed-1005</span></h2><div class="pubdate">21 Feb at 10:29:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1005">https://github.com/qt4cg/qtspecs/issues/1005</a></div><p>regular expressions - whitespace</p></div>
<div class="toot" id="closed-709"><h2>Issue #709 closed<span class="toot-id"> #closed-709</span></h2><div class="pubdate">21 Feb at 10:29:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/709">https://github.com/qt4cg/qtspecs/issues/709</a></div><p>(Un)Checked Evaluation</p></div>
<div class="toot" id="closed-459"><h2>Issue #459 closed<span class="toot-id"> #closed-459</span></h2><div class="pubdate">21 Feb at 10:28:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/459">https://github.com/qt4cg/qtspecs/issues/459</a></div><p>Eager and lazy evaluation</p></div>
<div class="toot" id="closed-135"><h2>Issue #135 closed<span class="toot-id"> #closed-135</span></h2><div class="pubdate">21 Feb at 10:28:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/135">https://github.com/qt4cg/qtspecs/issues/135</a></div><p>Arrays' counterparts for functions on sequences, and vice versa</p></div>
<div class="toot" id="closed-94"><h2>Issue #94 closed<span class="toot-id"> #closed-94</span></h2><div class="pubdate">21 Feb at 10:28:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/94">https://github.com/qt4cg/qtspecs/issues/94</a></div><p>Functions that determine if a given sequence is a subsequence of another sequence</p></div>
<div class="toot" id="closed-43"><h2>Issue #43 closed<span class="toot-id"> #closed-43</span></h2><div class="pubdate">21 Feb at 10:28:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/43">https://github.com/qt4cg/qtspecs/issues/43</a></div><p>Support standard and user-defined composite values using item type definitions</p></div>
<div class="toot" id="closed-1001"><h2>Issue #1001 closed<span class="toot-id"> #closed-1001</span></h2><div class="pubdate">20 Feb at 23:53:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1001">https://github.com/qt4cg/qtspecs/issues/1001</a></div><p>fn:subsequence-where: equivalent `fn:slice` expression</p></div>
<div class="toot" id="closed-1020"><h2>Issue #1020 closed<span class="toot-id"> #closed-1020</span></h2><div class="pubdate">20 Feb at 23:51:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1020">https://github.com/qt4cg/qtspecs/issues/1020</a></div><p>When to apply the coercion rules</p></div>
<div class="toot" id="created-1035"><h2>Issue #1035 created<span class="toot-id"> #created-1035</span></h2><div class="pubdate">20 Feb at 19:04:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1035">https://github.com/qt4cg/qtspecs/issues/1035</a></div><details><summary>Add default values for parameters in constructor functions for records</summary><div class="markup"><p>We have added implicit constructor functions for named record types; we should allow the parameters in these functions to take explicit default values.</p>
<p>For example</p>
<p><code>declare item type my:complex as record(r as xs:double, i as xs:double := 0)</code></p>
<p>At the same time we might consider introducing fixed values, for example</p>
<p><code>declare item type my:rectangle as record(height, width, area ::= function($rect){$rect?height * $rect?width))</code></p>
<p>in which (a) the area function must NOT be supplied as an argument to the constructor function call, and (b) a map in which the area field is different from this fixed value is not a valid instance of the <code>my:rectangle</code> record type.</p>
</div></details></div>
<div class="toot" id="created-1034"><h2>Pull request #1034 created<span class="toot-id"> #created-1034</span></h2><div class="pubdate">20 Feb at 18:56:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1034">https://github.com/qt4cg/qtspecs/pull/1034</a></div><details><summary>QT4CG-066-xx Add note regarding absence of drop-while / skip-while</summary><div class="markup"><p>In response to comments noted in the minutes of meeting 066, and made in writing against PR #1008, add a note justifying the absence of drop-while or skip-while functions.</p>
</div></details></div>
<div class="toot" id="created-1033"><h2>Pull request #1033 created<span class="toot-id"> #created-1033</span></h2><div class="pubdate">20 Feb at 18:44:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1033">https://github.com/qt4cg/qtspecs/pull/1033</a></div><details><summary>QT4CG-066-01 Add note that whitespace and comments in regexen are lexical constructs</summary><div class="markup"><p>Adds a note explaining why whitespace and comments are not explicit in the regex grammar; see action QT4CG-066-01</p>
</div></details></div>
<div class="toot" id="created-1032"><h2>Pull request #1032 created<span class="toot-id"> #created-1032</span></h2><div class="pubdate">20 Feb at 18:25:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1032">https://github.com/qt4cg/qtspecs/pull/1032</a></div><details><summary>1029 Make argument of fn:void optional</summary><div class="markup"><p>Allows the use of <code>fn:void#0</code> when required.</p>
<p>Fix #1029</p>
</div></details></div>
<div class="toot" id="created-1031"><h2>Pull request #1031 created<span class="toot-id"> #created-1031</span></h2><div class="pubdate">20 Feb at 18:07:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1031">https://github.com/qt4cg/qtspecs/pull/1031</a></div><details><summary>1024 Change precedence of 'otherwise' operator</summary><div class="markup"><p>Changes the precedence of the <code>otherwise</code> operator so that <code>@price otherwise @cost * 2</code> now means <code>@price otherwise (@cost * 2)</code> rather than <code>(@price otherwise @cost) * 2</code>.</p>
<p>Fix #1024</p>
</div></details></div>
<div class="toot" id="minutes-02-20"><h2>QT4 CG meeting 066 draft minutes<span class="toot-id"> #minutes-02-20</span></h2><div class="pubdate">20 Feb at 17:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/02-20">https://qt4cg.org/meeting/minutes/2024/02-20</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-999"><h2>Issue #999 closed<span class="toot-id"> #closed-999</span></h2><div class="pubdate">20 Feb at 17:25:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/999">https://github.com/qt4cg/qtspecs/issues/999</a></div><p>regular expression addition - comments</p></div>
<div class="toot" id="closed-1022"><h2>Issue #1022 closed<span class="toot-id"> #closed-1022</span></h2><div class="pubdate">20 Feb at 17:25:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1022">https://github.com/qt4cg/qtspecs/pull/1022</a></div><p>999 Allow comments in regular expressions</p></div>
<div class="toot" id="closed-1028"><h2>Issue #1028 closed<span class="toot-id"> #closed-1028</span></h2><div class="pubdate">20 Feb at 17:22:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1028">https://github.com/qt4cg/qtspecs/pull/1028</a></div><p>960(partial) Recognize alternative representation of JSON null</p></div>
<div class="toot" id="closed-617"><h2>Issue #617 closed<span class="toot-id"> #closed-617</span></h2><div class="pubdate">20 Feb at 17:19:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/617">https://github.com/qt4cg/qtspecs/issues/617</a></div><p>Implicit constructor functions for record types and union types</p></div>
<div class="toot" id="closed-953"><h2>Issue #953 closed<span class="toot-id"> #closed-953</span></h2><div class="pubdate">20 Feb at 17:19:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/953">https://github.com/qt4cg/qtspecs/pull/953</a></div><p>617 Define record constructors</p></div>
<div class="toot" id="closed-1002"><h2>Issue #1002 closed<span class="toot-id"> #closed-1002</span></h2><div class="pubdate">20 Feb at 17:16:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1002">https://github.com/qt4cg/qtspecs/issues/1002</a></div><p>Reinstate subsequence-before</p></div>
<div class="toot" id="closed-1008"><h2>Issue #1008 closed<span class="toot-id"> #closed-1008</span></h2><div class="pubdate">20 Feb at 17:16:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1008">https://github.com/qt4cg/qtspecs/pull/1008</a></div><p>1002 Add fn:take-while function (replacing subsequence-before)</p></div>
<div class="toot" id="closed-655"><h2>Issue #655 closed<span class="toot-id"> #closed-655</span></h2><div class="pubdate">20 Feb at 17:13:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/655">https://github.com/qt4cg/qtspecs/issues/655</a></div><p>fn:sort-with: Comparators</p></div>
<div class="toot" id="closed-795"><h2>Issue #795 closed<span class="toot-id"> #closed-795</span></h2><div class="pubdate">20 Feb at 17:13:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/795">https://github.com/qt4cg/qtspecs/pull/795</a></div><p>655 fn:sort-with</p></div>
<div class="toot" id="closed-1023"><h2>Issue #1023 closed<span class="toot-id"> #closed-1023</span></h2><div class="pubdate">20 Feb at 17:09:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1023">https://github.com/qt4cg/qtspecs/pull/1023</a></div><p>1020 explain consequences of function coercion</p></div>
<div class="toot" id="closed-1025"><h2>Issue #1025 closed<span class="toot-id"> #closed-1025</span></h2><div class="pubdate">20 Feb at 17:04:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1025">https://github.com/qt4cg/qtspecs/pull/1025</a></div><p>1001 Fix incorrect operator precedence in subsequence-where</p></div>
<div class="toot" id="created-1030"><h2>Issue #1030 created<span class="toot-id"> #created-1030</span></h2><div class="pubdate">20 Feb at 14:37:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1030">https://github.com/qt4cg/qtspecs/issues/1030</a></div><details><summary>allow pattern matches in axis expression</summary><div class="markup"><p>There's a danger that this already exists, and that i dont know about it, but i dont think it does.</p>
<p>Consider this SO question.</p>
<p>https://stackoverflow.com/questions/78027093/selecting-preceding-cousins-inclusing-siblings</p>
<p>the questioner is writing this</p>
<p><code>/root/level1/level2[@id='6']/preceding::level2[parent::level1[parent::root]][1]</code></p>
<p>eeek...look at the nasty nested predicates</p>
<p>when he/she wants to write this</p>
<p><code>/root/level1/level2[@id='6']/preceding::(root/level/level2)[1]</code></p>
<p>there is an answer on the question which sort of shows how horrific the problem is in general.</p>
<p>(its a problem that crops up quite a lot for me)</p>
</div></details></div>
<div class="toot" id="created-1029"><h2>Issue #1029 created<span class="toot-id"> #created-1029</span></h2><div class="pubdate">20 Feb at 09:50:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1029">https://github.com/qt4cg/qtspecs/issues/1029</a></div><details><summary>Make argument of fn:void optional</summary><div class="markup"><p>If you want to supply a function that always returns an empty sequence, fn:void#0 would be useful; but currently there is no arity-zero variant.</p>
<p>Example: <code>map:build(...., combine:=fn:void#0)</code> returns a map in which any key that occurs more than once in the input is mapped to an empty sequence.</p>
<p>The first argument of <code>fn:void</code> should default to an empty sequence.</p>
</div></details></div>
<div class="toot" id="agenda-02-20"><h2>QT4 CG meeting 066 draft agenda<span class="toot-id"> #agenda-02-20</span></h2><div class="pubdate">19 Feb at 14:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/02-20">https://qt4cg.org/meeting/agenda/2024/02-20</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1028"><h2>Pull request #1028 created<span class="toot-id"> #created-1028</span></h2><div class="pubdate">19 Feb at 11:34:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1028">https://github.com/qt4cg/qtspecs/pull/1028</a></div><details><summary>960(partial) Recognize alternative representation of JSON null</summary><div class="markup"><p>Defines an option in parse-json and json-doc to define a representation for JSON null, defaulting to <code>()</code> as currently used. Selecting a different value may be useful because it bypasses the problem that the <code>?</code> and <code>??</code> operators flatten the results, causing <code>()</code> to be elided.</p>
<p>Suggests use of the QName <code>fn:null</code> as an alternative representation; and changes the JSON serialization method to recognize this QName as a representation of null.</p>
</div></details></div>
<div class="toot" id="created-1027"><h2>Pull request #1027 created<span class="toot-id"> #created-1027</span></h2><div class="pubdate">17 Feb at 22:21:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1027">https://github.com/qt4cg/qtspecs/pull/1027</a></div><details><summary>150 fn:ranks</summary><div class="markup"><p>As proposed and discussed  here: https://github.com/qt4cg/qtspecs/issues/150</p>
</div></details></div>
<div class="toot" id="created-1026"><h2>Issue #1026 created<span class="toot-id"> #created-1026</span></h2><div class="pubdate">17 Feb at 09:44:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1026">https://github.com/qt4cg/qtspecs/issues/1026</a></div><details><summary>XSLT match patterns on pinned maps and arrays</summary><div class="markup"><p>Given that <code>&lt;xsl:apply-templates select="pin(.)??course?code"/&gt;</code> will select items that are labeled with their position in the containing tree of maps and arrays, it should be possible to match the selected items with a match pattern of the form</p>
<p><code>match="?course?code"</code></p>
<p>that operates in a similar way to patterns such as <code>course/code</code> in XML.</p>
<p>Perhaps the pinning of the map should be done automatically by the <code>xsl:apply-templates</code> instruction.</p>
</div></details></div>
<div class="toot" id="created-1025"><h2>Pull request #1025 created<span class="toot-id"> #created-1025</span></h2><div class="pubdate">13 Feb at 21:25:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1025">https://github.com/qt4cg/qtspecs/pull/1025</a></div><details><summary>1001 Fix incorrect operator precedence in subsequence-where</summary><div class="markup"><p>Fixes the "equivalent expression" to subsequence-where.</p>
<p>Fix issue #1001</p>
</div></details></div>
<div class="toot" id="created-1024"><h2>Issue #1024 created<span class="toot-id"> #created-1024</span></h2><div class="pubdate">13 Feb at 21:10:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1024">https://github.com/qt4cg/qtspecs/issues/1024</a></div><details><summary>Precedence of `otherwise` operator</summary><div class="markup"><p>I made a mistake when specifying subsequence-where, caused by misunderstanding the precedence of the <code>otherwise</code> operator: see issue #1001.</p>
<p>In the expression</p>
<pre><code>let $start := index-where($input, $from)[1] 
              otherwise count($input) + 1
</code></pre>
<p>I failed to realise that <code>otherwise</code> binds more tightly than <code>+</code>.</p>
<p>I'm opening the issue to solicit views as to whether we have got this right.</p>
<p>One might take the view that the closest thing to <code>otherwise</code> in other familiar language is the ternary conditional operator, which has lower precedence than anything else including <code>and</code> and <code>or</code>; but then, its first operand is a boolean expression while it's relatively unlikely that the operands of <code>otherwise</code> will be boolean. I'm therefore thinking that it might be best to put it between 'eq' and '||`, so</p>
<p><code>$a eq $b otherwise $c || $d</code></p>
<p>parses as</p>
<p><code>$a eq ($b otherwise ($c || $d))</code></p>
</div></details></div>
<div class="toot" id="closed-827"><h2>Issue #827 closed<span class="toot-id"> #closed-827</span></h2><div class="pubdate">13 Feb at 20:04:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/827">https://github.com/qt4cg/qtspecs/issues/827</a></div><p>map:empty, map:exists ← array:empty, array:exists</p></div>
<div class="toot" id="closed-779"><h2>Issue #779 closed<span class="toot-id"> #closed-779</span></h2><div class="pubdate">13 Feb at 20:02:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/779">https://github.com/qt4cg/qtspecs/issues/779</a></div><p>Hash/checksum function</p></div>
<div class="toot" id="closed-978"><h2>Issue #978 closed<span class="toot-id"> #closed-978</span></h2><div class="pubdate">13 Feb at 17:21:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/978">https://github.com/qt4cg/qtspecs/pull/978</a></div><p>948 Reflected the comments of the CG on the specification of scan-left and scan-right</p></div>
<div class="toot" id="minutes-02-13"><h2>QT4 CG meeting 065 draft minutes<span class="toot-id"> #minutes-02-13</span></h2><div class="pubdate">13 Feb at 17:20:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/02-13">https://qt4cg.org/meeting/minutes/2024/02-13</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-720"><h2>Issue #720 closed<span class="toot-id"> #closed-720</span></h2><div class="pubdate">13 Feb at 17:18:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/720">https://github.com/qt4cg/qtspecs/issues/720</a></div><p>From Records to Objects</p></div>
<div class="toot" id="closed-985"><h2>Issue #985 closed<span class="toot-id"> #closed-985</span></h2><div class="pubdate">13 Feb at 17:18:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/985">https://github.com/qt4cg/qtspecs/pull/985</a></div><p>720 Add lookup arrow expressions (method invocations)</p></div>
<div class="toot" id="closed-949"><h2>Issue #949 closed<span class="toot-id"> #closed-949</span></h2><div class="pubdate">13 Feb at 17:15:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/949">https://github.com/qt4cg/qtspecs/issues/949</a></div><p>Partial Function Applications: Allow return of function name</p></div>
<div class="toot" id="closed-972"><h2>Issue #972 closed<span class="toot-id"> #closed-972</span></h2><div class="pubdate">13 Feb at 17:15:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/972">https://github.com/qt4cg/qtspecs/pull/972</a></div><p>949 Partial Function Applications: Allow return of function name</p></div>
<div class="toot" id="closed-42"><h2>Issue #42 closed<span class="toot-id"> #closed-42</span></h2><div class="pubdate">13 Feb at 17:13:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/42">https://github.com/qt4cg/qtspecs/issues/42</a></div><p>Relax type incompatibility in order by clause (impl. dep. instead of XPST0004)</p></div>
<div class="toot" id="closed-55"><h2>Issue #55 closed<span class="toot-id"> #closed-55</span></h2><div class="pubdate">13 Feb at 17:13:05 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/55">https://github.com/qt4cg/qtspecs/issues/55</a></div><p>Provide an XML version of the stack trace</p></div>
<div class="toot" id="closed-79"><h2>Issue #79 closed<span class="toot-id"> #closed-79</span></h2><div class="pubdate">13 Feb at 17:12:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/79">https://github.com/qt4cg/qtspecs/issues/79</a></div><p>fn:deep-normalize-space($e as node())</p></div>
<div class="toot" id="closed-989"><h2>Issue #989 closed<span class="toot-id"> #closed-989</span></h2><div class="pubdate">13 Feb at 17:12:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/989">https://github.com/qt4cg/qtspecs/issues/989</a></div><p>character sequence constructor 'a' to 'z'</p></div>
<div class="toot" id="closed-994"><h2>Issue #994 closed<span class="toot-id"> #closed-994</span></h2><div class="pubdate">13 Feb at 17:12:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/994">https://github.com/qt4cg/qtspecs/issues/994</a></div><p>Invoking maps &amp; arrays: allow sequences?</p></div>
<div class="toot" id="closed-1009"><h2>Issue #1009 closed<span class="toot-id"> #closed-1009</span></h2><div class="pubdate">13 Feb at 17:08:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1009">https://github.com/qt4cg/qtspecs/issues/1009</a></div><p>QT4CG-064-03, QT4CG-064-04: Examples, Return type of `fallback`</p></div>
<div class="toot" id="closed-1010"><h2>Issue #1010 closed<span class="toot-id"> #closed-1010</span></h2><div class="pubdate">13 Feb at 17:08:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1010">https://github.com/qt4cg/qtspecs/pull/1010</a></div><p>1009 Examples, Return type of parse-json:fallback</p></div>
<div class="toot" id="closed-916"><h2>Issue #916 closed<span class="toot-id"> #closed-916</span></h2><div class="pubdate">13 Feb at 15:33:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/916">https://github.com/qt4cg/qtspecs/pull/916</a></div><p>720 Allow methods in maps with access to $this</p></div>
<div class="toot" id="created-1023"><h2>Pull request #1023 created<span class="toot-id"> #created-1023</span></h2><div class="pubdate">13 Feb at 12:39:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1023">https://github.com/qt4cg/qtspecs/pull/1023</a></div><details><summary>1020 explain consequences of function coercion</summary><div class="markup"><p>Adds explanatory material to explain my interpretation of the spec and the consequences on backwards compatibility. No change to the spec is proposed. (To review the PR, I suggest reading the change markings in the XQuery spec.)</p>
<p>Fix issue #1020</p>
</div></details></div>
<div class="toot" id="created-1022"><h2>Pull request #1022 created<span class="toot-id"> #created-1022</span></h2><div class="pubdate">13 Feb at 11:51:44 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1022">https://github.com/qt4cg/qtspecs/pull/1022</a></div><details><summary>999 Allow comments in regular expressions</summary><div class="markup"><p>Fix #999</p>
</div></details></div>
<div class="toot" id="created-1021"><h2>Issue #1021 created<span class="toot-id"> #created-1021</span></h2><div class="pubdate">12 Feb at 12:46:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1021">https://github.com/qt4cg/qtspecs/issues/1021</a></div><details><summary>Extend `fn:doc`, `fn:collection` and `fn:uri-collection` with options maps</summary><div class="markup"><p><code>fn:doc</code>, <code>fn:collection</code> and <code>fn:uri-collection</code> currently expect only a single argument, a URI.</p>
<p>There is no way of adding additional parameters to those functions.</p>
<p>Several implementations of XPath have worked around that limitation by</p>
<ol>
<li>passing of parameters via query string as part of the URI:</li>
</ol>
<ul>
<li>see https://www.saxonica.com/documentation10/index.html#!sourcedocs/collections</li>
<li>exist-db's implementation of <code>uri-collection</code> works similarly</li>
</ul>
<ol start="2">
<li>create custom functions in other namespaces to add an options map as a second parameter</li>
</ol>
<ul>
<li><code>saxon:doc</code> in Saxon https://www.saxonica.com/documentation10/index.html#!changes/extensions/9.7-9.8</li>
<li><code>fetch:doc</code> in baseX https://docs.basex.org/wiki/Fetch_Module#fetch:doc</li>
</ul>
<p>While both approaches do work well, they do fall flat in terms of interoperability and discoverability.
A script written for Saxon leveraging <code>saxon:doc</code> will not work on baseX in vice versa even though they offer options with some overlap.
And a developer looking at the language specification will not discover that these options even exist.</p>
<p>I would like to add a second signature to the above functions with an options map as a second argument.</p>
<pre><code class="language-xquery">fn:doc($href as xs:string?) as document-node()?
fn:doc($href as xs:string?, $options as map(xs:string, *)? := ()) as document-node()?
</code></pre>
<p>NOTE: Looking at the other two functions below I believe the first parameter should be defined as <code>$href as xs:string? := ()</code></p>
<pre><code class="language-xquery">fn:collection( $uri as&nbsp;xs:string? :=&nbsp;())&nbsp;as&nbsp;item()*
fn:collection( $uri as&nbsp;xs:string? :=&nbsp;(), $options as map(xs:string, *)? := ())&nbsp;as&nbsp;item()*
</code></pre>
<pre><code class="language-xquery">fn:uri-collection( $uri as&nbsp;xs:string? :=&nbsp;())&nbsp;as&nbsp;xs:anyURI*
fn:uri-collection( $uri as&nbsp;xs:string? :=&nbsp;(), $options as map(xs:string, *)? := ())&nbsp;as&nbsp;xs:anyURI*
</code></pre>
<p>Since a lot of those options depend on the current runtime most of them will be "free" options.
This will also help us get to a specification quickly and circumvent long infighting about some very specific details.</p>
<p>I do see, however, a good chance of specifying a small set of options that would work across implementations.</p>
<h2>Possible standard options</h2>
<h3>For <code>fn:doc</code></h3>
<ul>
<li><code>validation</code>: wether and how to validate the input files against a schema</li>
<li><code>whitespace</code>: (<code>strip-space</code>, <code>stripws</code>) what to do with whitespace in the input document</li>
<li><code>parser</code>: could be used to define a different parser (for html documents)</li>
</ul>
<h3>For <code>collection</code> and <code>uri-collection</code> I see the following:</h3>
<ul>
<li><code>recurse</code>: traverse collection trees down into its subcollections</li>
<li><code>stable</code>: this is already vaguely mentioned in the spec and would benefit from a clearer specification</li>
<li><code>type</code>: (aka <code>media-type</code> or <code>content-type</code>) while the allowed values will be implementation defined the key should be standardised</li>
</ul>
<p>This would bring the above functions to follow a pattern developers are already familiar with (see <code>fn:serialize</code> and others)</p>
<p>Thanks for initial input by @ChristianGruen, Liam Quin and @michaelhkay</p>
</div></details></div>
<div class="toot" id="agenda-02-13"><h2>QT4 CG meeting 065 draft agenda<span class="toot-id"> #agenda-02-13</span></h2><div class="pubdate">12 Feb at 11:45:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/02-13">https://qt4cg.org/meeting/agenda/2024/02-13</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-1020"><h2>Issue #1020 created<span class="toot-id"> #created-1020</span></h2><div class="pubdate">11 Feb at 23:56:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1020">https://github.com/qt4cg/qtspecs/issues/1020</a></div><details><summary>When to apply the coercion rules</summary><div class="markup"><p>The rules for function calling say that the coercion rules are applied to the values supplied as function arguments; they are also applied in other circumstances such as when binding values to variables. The coercion rules are applied (as far as the spec is concerned) whether or not the supplied value already matches the required type.</p>
<p>Saxon has always attempted to optimise this process: if the supplied value is already an instance of the required type, no coercion takes place.</p>
<p>I have discovered at least one case where this assumption is incorrect: the coercion rules are not idempotent in the case where the supplied value matches the required type. This case concerns function coercion, exemplified by the new test case FunctionCall-058: if the expected type of a callback parameter is <code>function(xs:integer) as xs:boolean</code>, and the supplied value for the callback is a function that accepts <code>xs:decimal</code>, then the coercion rules say that a call to the supplied function that supplies an <code>xs:decimal</code> must be rejected as a type error even though the supplied function accepts it.</p>
<p>Note that this means we have introduced a rather subtle backwards incompatibility. In XQuery 3.1, coercion was not applied to variable bindings, so the following would work (the supplied function matches the declared type of the variable):</p>
<pre><code>declare variable $f as function(xs:integer) as xs:boolean 
              := function($x as item()) as xs:boolean {string($x)};
return $f("banana");
</code></pre>
<p>(see new tests VarDecl065/066)</p>
<p>In 4.0 I believe this is supposed to throw a type error, because the supplied function is wrapped in a wrapper function that checks that the supplied argument is an integer.</p>
<p>We have extended the coercion rules considerably in 4.0, and we need to be confident that there are no other similar cases where the coercion rules are no longer idempotent.</p>
</div></details></div>
<div class="toot" id="created-1019"><h2>Issue #1019 created<span class="toot-id"> #created-1019</span></h2><div class="pubdate">11 Feb at 15:23:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1019">https://github.com/qt4cg/qtspecs/issues/1019</a></div><details><summary>XQFO: Unknown option parameters</summary><div class="markup"><p>The current <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#option-parameter-conventions">option parameter conventions</a> are:</p>
<blockquote>
<ol start="4">
<li>It is not an error if the options map contains options with names other than those described in this specification. Implementations MAY attach an ·implementation-defined· meaning to such entries, and MAY define errors that arise if such entries are present with invalid values. Implementations MUST ignore such entries unless they have a specific ·implementation-defined· meaning. Implementations that define additional options in this way SHOULD use values of type <code>xs:QName</code> as the option names, using an appropriate namespace.</li>
</ol>
</blockquote>
<p>The obvious consequence is that wrongly typed or unsupported options are not reported as such:</p>
<pre><code class="language-xquery">serialize($node, map { 'format': 'html' })
</code></pre>
<p>I think we should still allow proprietary options, but raise errors when an option is neither defined in the specification nor supported by the given implementation. On the one hand, this will help users to spot typos (e.g., <code>byte-order-mask</code> or instead of <code>byte-order-mark</code>). On the other hand, options that are supported by one implementation will be rejected, which feels reasonable to me, as options usually change either the result, or the way how the input is treated.</p>
<p>If we believe that this change is too disruptive, we could tolerate entries with <code>xs:QName</code> keys.</p>
</div></details></div>
<div class="toot" id="created-1018"><h2>Issue #1018 created<span class="toot-id"> #created-1018</span></h2><div class="pubdate">11 Feb at 07:01:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1018">https://github.com/qt4cg/qtspecs/issues/1018</a></div><details><summary>Output of parse-csv()</summary><div class="markup"><p>I propose making some simplifications to the output of parse-csv() to make it more amenable to processing.</p>
<ol>
<li>Represent each row as a map, rather than as a structure with a data field and an accessor function. Note that implementations worried about memory usage can devise a custom map implementation optimised for the case where many maps have the same regular structure. (cf recent thread about Javascript "shapes")</li>
<li>The key for a field in this map should be an integer if (i) column-names is set to false, or (ii) the column in question does not have a unique header name; in other cases it should be the name from the header.</li>
<li>Replace the top-level <code>columns</code> record with a simple array of field names. It's easy enough to map names to positions using index-of.</li>
</ol>
<p>I also propose changing the name to <code>csv-to-maps</code> for consistency with <code>csv-to-table</code> and <code>csv-to-arrays</code>.</p>
<p>We should advocate use of csv-to-arrays where data is to be accessed positionally, and csv-to-maps where it is to be accessed by column names, and optimise the design accordingly.</p>
<p>Looking at a use case, the first example (§15.4.7.1) would be unnecessary if as proposed we change csv-to-xml to generate XHTML directly, But if it were needed, it would change from</p>
<pre><code>let $csv := fn:parse-csv(`name,city{$crlf}Bob,Berlin`)
return &lt;table&gt;
   &lt;thead&gt;{
      for $column in $csv?columns?fields
         return &lt;th&gt;{ $column }&lt;/th&gt;
   }&lt;/thead&gt;
   &lt;tbody&gt;{
      for $row in $csv?rows return &lt;tr&gt;
         { for $field in $row?fields return &lt;td&gt;{ $field }&lt;/td&gt; }
      &lt;/tr&gt;
   }&lt;/tbody&gt;
&lt;/table&gt;
</code></pre>
<p>to</p>
<pre><code>let $csv := fn:parse-csv(`name,city{$crlf}Bob,Berlin`)
return &lt;table&gt;
   &lt;thead&gt;{
      for $column in $csv?columns
         return &lt;th&gt;{ $column }&lt;/th&gt;
   }&lt;/thead&gt;
   &lt;tbody&gt;{
      for $row in $csv?rows return &lt;tr&gt;
         { for $column in $csv?columns return &lt;td&gt;{ $row?$column }&lt;/td&gt; }
      &lt;/tr&gt;
   }&lt;/tbody&gt;
&lt;/table&gt;

</code></pre>
</div></details></div>
<div class="toot" id="created-1017"><h2>Issue #1017 created<span class="toot-id"> #created-1017</span></h2><div class="pubdate">11 Feb at 06:20:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1017">https://github.com/qt4cg/qtspecs/issues/1017</a></div><details><summary>Change csv-to-xml() to produce an XHTML table</summary><div class="markup"><p>I propose (a) renaming <code>csv-to-xml</code> as <code>csv-to-table</code>, and (b) changing the output to be an XHTML table. Specifically, instead of outputting</p>
<pre><code>&lt;csv xmlns="http://www.w3.org/2005/xpath-functions"&gt;
   &lt;columns&gt;
      &lt;column&gt;name&lt;/column&gt;
      &lt;column&gt;city&lt;/column&gt;
   &lt;/columns&gt;
   &lt;rows&gt;
      &lt;row&gt;
         &lt;field column="name"&gt;Bob&lt;/field&gt;
         &lt;field column="city"&gt;Berlin&lt;/field&gt;
      &lt;/row&gt;
      &lt;row&gt;
         &lt;field column="name"&gt;Alice&lt;/field&gt;
         &lt;field column="city"&gt;Aachen&lt;/field&gt;
      &lt;/row&gt;
   &lt;/rows&gt;
&lt;/csv&gt;
</code></pre>
<p>it should output:</p>
<pre><code>&lt;table xmlns="http://www.w3.org/1999/xhtml"&gt;
   &lt;thead&gt;
      &lt;tr&gt;
          &lt;th&gt;name&lt;/th&gt;
          &lt;th&gt;city&lt;/th&gt;
      &lt;/tr&gt;
   &lt;/thead&gt;
   &lt;tbody&gt;
      &lt;tr&gt;
         &lt;td title="name"&gt;Bob&lt;/td&gt;
         &lt;td title="city"&gt;Berlin&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
         &lt;td title="name"&gt;Alice&lt;/td&gt;
         &lt;td title="city"&gt;Aachen&lt;/td&gt;
      &lt;/tr&gt;
   &lt;/thead&gt;
&lt;/table&gt;
</code></pre>
<h3>Benefits:</h3>
<p>(a) the data is just as easy to manipulate or transform as the current output
(b) it can be copied directly into HTML transformation output if required
(c) it is familiar to users
(d) we don't have to write, test, and document a schema
(e) there may well be libraries that can perform further transformations on the structure, for example conversion to other table representations, extraction to spreadsheet formats, etc.</p>
</div></details></div>
<div class="toot" id="created-1016"><h2>Issue #1016 created<span class="toot-id"> #created-1016</span></h2><div class="pubdate">10 Feb at 21:02:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1016">https://github.com/qt4cg/qtspecs/issues/1016</a></div><details><summary>Editorial comments on fn:parse-csv()</summary><div class="markup"><p>(a) The spec says:</p>
<blockquote>
<p>The first argument is CSV data, as defined in ..., in the form of a sequence of xs:string values.</p>
</blockquote>
<p>But in fact, the argument is a single (optional) xs:string value, not a sequence.</p>
<p>(b) The spec says:</p>
<blockquote>
<p>If $csv is the empty sequence, implementations must return a parsed-csv-structure-record whose rows entry is the empty sequence.</p>
<p>If $csv is the empty sequence, but column name extraction has been requested, or explicit column names have been supplied, then the parsed-csv-structure-record returned by implementations must have a rows entry whose value is the empty sequence.</p>
</blockquote>
<p>The second paragraph seems to add nothing to the first.</p>
<p>(c) And the phrase "<em>implementations must return XXX</em>" is unidiomatic. The normal form of words is "<em>the function returns XXX</em>".</p>
<p>(d) The grammar of the sentence "Handling of delimiters, and whitespace trimming, are handled using..." is inelegant.</p>
<p>(e) References to the record type names (such as parsed-csv-structure-record) should be hyperlinked.</p>
</div></details></div>
<div class="toot" id="created-1015"><h2>Pull request #1015 created<span class="toot-id"> #created-1015</span></h2><div class="pubdate">09 Feb at 12:52:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1015">https://github.com/qt4cg/qtspecs/pull/1015</a></div><details><summary>1013 [XSLT] Clarify effect of accumulator capture on non-element nodes</summary><div class="markup"><p>Adds a sentence saying that when an accumulator rule with capture="yes" matches a non-element node, the capture attribute has no effect.</p>
<p>Fix #1013</p>
</div></details></div>
<div class="toot" id="created-1014"><h2>Issue #1014 created<span class="toot-id"> #created-1014</span></h2><div class="pubdate">08 Feb at 13:43:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1014">https://github.com/qt4cg/qtspecs/issues/1014</a></div><details><summary>Predicates, sequences of numbers: Feedback</summary><div class="markup"><p>Feedback on #996:</p>
<h3>Successful result: early exit</h3>
<p>If the EBV is computed, and if the first item is a node, the remaining items are ignored:</p>
<pre><code class="language-xquery">'OK'[ &lt;a/&gt;, 1, 'x' ]  →  'OK'
</code></pre>
<p>I would suggest doing the same for predicates that start with a number:</p>
<ul>
<li>If a comparison is successful, an implementation should be allowed to skip the remaining comparisons.</li>
<li>If <code>$seq</code> starts with a number, <code>E[$seq]</code> and <code>E[position() = $seq]</code> will become equivalent:</li>
</ul>
<pre><code class="language-xquery">$seq[1 to 100, 'x']
$seq[position() = (1 to 100, 'x')]
</code></pre>
<p>Obviously, an error still needs to be raised if a comparisons leads to a type error.</p>
<h3>Error Codes</h3>
<p>If we don’t equate <code>E[$seq]</code> and <code>E[position() = $seq]</code>, it would be useful to stick with <code>FORG0006</code> (instead of <code>XPTY0004</code>) [1]:</p>
<ul>
<li>It would be confusing to get <code>FORG0006</code> for <code>E['x', 1]</code> and <code>XPTY0004</code> for <code>E[1, 'x']</code>.</li>
<li>If a processor uses unified implementations for EBV and predicate checks, it leads to additional effort just because the error code differs.</li>
</ul>
<p>If we use different error codes, existing tests need to be revised ([2], maybe others).</p>
<p>[1] https://github.com/qt4cg/qtspecs/pull/996/files#diff-b37a92a9eb3ab9ba48a00de9627a1124466b9c86ecb2b4989d04be3942c597a6R8240
[2] https://github.com/qt4cg/qt4tests/blob/70e52c690a26bbeee0641af14ccb319a2cc98081/prod/Predicate.xml#L1158-L1165</p>
</div></details></div>
<div class="toot" id="closed-1012"><h2>Issue #1012 closed<span class="toot-id"> #closed-1012</span></h2><div class="pubdate">08 Feb at 10:50:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1012">https://github.com/qt4cg/qtspecs/pull/1012</a></div><p>Fix some incorrect examples in the F&amp;O spec</p></div>
<div class="toot" id="created-1013"><h2>Issue #1013 created<span class="toot-id"> #created-1013</span></h2><div class="pubdate">08 Feb at 09:14:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1013">https://github.com/qt4cg/qtspecs/issues/1013</a></div><details><summary>[XSLT] Need to say what happens when a capturing accumulator rule matches a non-element node</summary><div class="markup"><p>The option capture="yes" has been added to <code>xsl:accumulator-rule</code>; its purpose is to indicate that the entire subtree under an element is to be captured during streamed processing of the document, and is made available as an in-memory tree once the element end tag has been processed.</p>
<p>We need to say what happens when such a rule matches a node other than an element. I think it makes sense for the capture="yes" to be ignored, optionally with a warning.</p>
</div></details></div>
<div class="toot" id="created-1012"><h2>Pull request #1012 created<span class="toot-id"> #created-1012</span></h2><div class="pubdate">08 Feb at 00:57:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1012">https://github.com/qt4cg/qtspecs/pull/1012</a></div><details><summary>Fix some incorrect examples in the F&amp;O spec</summary><div class="markup"><p>No issue raised; the errors are revealed by the generated QT4 tests.</p>
</div></details></div>
<div class="toot" id="created-1011"><h2>Issue #1011 created<span class="toot-id"> #created-1011</span></h2><div class="pubdate">07 Feb at 20:52:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1011">https://github.com/qt4cg/qtspecs/issues/1011</a></div><details><summary>fn:transform() improvements</summary><div class="markup"><ol>
<li>The spec talks about how to invoke an XSLT 1.0, 2.0, or 3.0 processor, but not a 4.0 processor.</li>
<li>There is no way of supplying a source document in a way that allows streaming. Saxon has added a <code>source-location</code> parameter for this purpose; this should be in the standard.</li>
<li>If the stylesheet is to read streamed input, then there also needs to be control over whether and how it does schema validation.</li>
<li>When calling from XSLT, the best default for <code>base-output-uri</code> is probably the value of <code>current-output-uri()</code>. The default is currently implementation-defined, but we should recommend this possibility.</li>
<li>The post-process option was added with the aspiration that it would enable secondary result documents (xsl:result-document output) to be written directly (e.g. to filestore) as a side-effect. However, it fails to achieve this. There should probably be an option to request this even though we cannot define its semantics precisely.</li>
</ol>
</div></details></div>
<div class="toot" id="created-1010"><h2>Pull request #1010 created<span class="toot-id"> #created-1010</span></h2><div class="pubdate">07 Feb at 16:09:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1010">https://github.com/qt4cg/qtspecs/pull/1010</a></div><details><summary>1009 Examples, Return type of parse-json:fallback</summary><div class="markup"><p>Issue: #1009</p>
<p>I’ve used this PR to fix some other buggy examples in the XQFO spec.</p>
</div></details></div>
<div class="toot" id="created-1009"><h2>Issue #1009 created<span class="toot-id"> #created-1009</span></h2><div class="pubdate">07 Feb at 13:59:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1009">https://github.com/qt4cg/qtspecs/issues/1009</a></div><details><summary>QT4CG-064-03, QT4CG-064-04: Examples, Return type of `fallback`</summary><div class="markup"><p>Thanks for the attentive inspection of #975.</p>
<p>The type <code>xs:untypedAtomic</code> for the <code>fallback</code> function of <code>fn:parse-json</code> made no sense indeed: JSON escape sequence can never be converted to numbers. The return type will be <code>xs:anyAtomicType</code> instead of <code>item()</code> (the result will be converted to a string).</p>
<p>I’ll revise the rules and add some examples.</p>
</div></details></div>
<div class="toot" id="closed-977"><h2>Issue #977 closed<span class="toot-id"> #closed-977</span></h2><div class="pubdate">07 Feb at 13:09:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/977">https://github.com/qt4cg/qtspecs/pull/977</a></div><p>Ignore this, it's just a test</p></div>
<div class="toot" id="created-1008"><h2>Pull request #1008 created<span class="toot-id"> #created-1008</span></h2><div class="pubdate">07 Feb at 11:12:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1008">https://github.com/qt4cg/qtspecs/pull/1008</a></div><details><summary>1002 Add fn:take-while function (replacing subsequence-before)</summary><div class="markup"><p>Adds function <code>fn:take-while</code>, replacing/reinstating previously proposed <code>items-before()</code> and <code>subsequence-before()</code>.</p>
<p>Fix #1002</p>
</div></details></div>
<div class="toot" id="created-1007"><h2>Issue #1007 created<span class="toot-id"> #created-1007</span></h2><div class="pubdate">07 Feb at 09:45:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1007">https://github.com/qt4cg/qtspecs/issues/1007</a></div><details><summary>How to invert a predicate function</summary><div class="markup"><p>It's nice to be able to write</p>
<p><code>index-where($in, contains(?, 'e'))</code></p>
<p>to select all the items that contain an 'e'.</p>
<p>What should we write in order to select all the items that do not contain an 'e'? All formulations seem a bit clumsy in comparison:</p>
<p><code>index-where($in, fn{not(contains(., 'e'))})</code>
<code>index-where($in, chain((contains(?, 'e'), not#1))</code></p>
<p>Perhaps this is a sufficiently common requirement that it would be helpful to allow</p>
<p><code>index-where($in, inverse(contains(?, 'e')))</code></p>
<p>where <code>inverse($predicate)</code> is defined as <code>fn($it, $pos){not($predicate($it, $pos))}</code></p>
</div></details></div>
<div class="toot" id="created-1006"><h2>Issue #1006 created<span class="toot-id"> #created-1006</span></h2><div class="pubdate">07 Feb at 07:34:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1006">https://github.com/qt4cg/qtspecs/issues/1006</a></div><details><summary>regular expression addition - word boundaries</summary><div class="markup"><p>Could we provide support for the regex character sequence <code>\w</code> for matching word boundaries?</p>
<p>It’s already support by some processors via vendor-specific flags, and would be very helpful even if didn’t over the full Unicode range.</p>
</div></details></div>
<div class="toot" id="created-1005"><h2>Issue #1005 created<span class="toot-id"> #created-1005</span></h2><div class="pubdate">07 Feb at 07:26:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1005">https://github.com/qt4cg/qtspecs/issues/1005</a></div><details><summary>regular expressions - whitespace</summary><div class="markup"><p>There is some confusion about the rationale for defining the multi-character escape for whitespaces in a <a href="https://xmlcom.slack.com/archives/C011NLXE4DU/p1707158555769749">recent discussion</a> on Slack:</p>
<ul>
<li><code>\s</code> is limited to <code>[#x20\t\n\r]</code></li>
<li>In contrast, <code>\w\</code> covers <code>[#x0000-#x10FFFF]-[\p{P}\p{Z}\p{C}]</code>, i.e., considers the full Unicode range</li>
</ul>
<p>Do we know the reason?</p>
<p>I assume it’s both too late and out of scope to change that in our specs, but maybe we can improve the XQFO spec and…</p>
<ul>
<li>mention why <code>\s</code> does not include <code>\p{Zs}</code> or <code>\p{Z}</code></li>
<li>add an example for looking up non-breaking spaces… for example:</li>
</ul>
<pre><code class="language-xquery">matches(
  string-join(('my', 'pleasure'), char(0xA0)),
  '\p{Z}'
)
</code></pre>
</div></details></div>
<div class="toot" id="closed-1004"><h2>Issue #1004 closed<span class="toot-id"> #closed-1004</span></h2><div class="pubdate">07 Feb at 06:56:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1004">https://github.com/qt4cg/qtspecs/pull/1004</a></div><p>fn:char updated as agreed 2024-02-06: drop the form char('#x20')</p></div>
<div class="toot" id="created-1004"><h2>Pull request #1004 created<span class="toot-id"> #created-1004</span></h2><div class="pubdate">07 Feb at 06:43:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1004">https://github.com/qt4cg/qtspecs/pull/1004</a></div><details><summary>fn:char updated as agreed 2024-02-06: drop the form char('#x20')</summary><div class="markup"><p>The forms char('#32`) and char('#x20') are dropped.</p>
</div></details></div>
<div class="toot" id="closed-963"><h2>Issue #963 closed<span class="toot-id"> #closed-963</span></h2><div class="pubdate">07 Feb at 06:41:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/963">https://github.com/qt4cg/qtspecs/issues/963</a></div><p>Errors in forming function items (continued)</p></div>
<div class="toot" id="closed-888"><h2>Issue #888 closed<span class="toot-id"> #closed-888</span></h2><div class="pubdate">07 Feb at 06:41:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/888">https://github.com/qt4cg/qtspecs/issues/888</a></div><p>Reclassify XPDY0002 as a type error</p></div>
<div class="toot" id="closed-992"><h2>Issue #992 closed<span class="toot-id"> #closed-992</span></h2><div class="pubdate">07 Feb at 06:41:56 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/992">https://github.com/qt4cg/qtspecs/pull/992</a></div><p>888, 963: Error handling for unsatisfied context dependencies</p></div>
<div class="toot" id="created-1003"><h2>Pull request #1003 created<span class="toot-id"> #created-1003</span></h2><div class="pubdate">07 Feb at 00:05:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/1003">https://github.com/qt4cg/qtspecs/pull/1003</a></div><details><summary>919 Use EBV in boolean callbacks</summary><div class="markup"><p>Changes functions with a $predicate callback function to use the effective boolean value of the result, mainly to allow things like <code>index-where(*, fn{self::x})</code>.</p>
<p>Fix #919</p>
</div></details></div>
<div class="toot" id="minutes-02-06"><h2>QT4 CG meeting 064 draft minutes<span class="toot-id"> #minutes-02-06</span></h2><div class="pubdate">06 Feb at 18:00:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/02-06">https://qt4cg.org/meeting/minutes/2024/02-06</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-187"><h2>Issue #187 closed<span class="toot-id"> #closed-187</span></h2><div class="pubdate">06 Feb at 17:50:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/187">https://github.com/qt4cg/qtspecs/issues/187</a></div><p>Add a 'while' clause to FLWOR expressions</p></div>
<div class="toot" id="closed-943"><h2>Issue #943 closed<span class="toot-id"> #closed-943</span></h2><div class="pubdate">06 Feb at 17:49:59 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/943">https://github.com/qt4cg/qtspecs/pull/943</a></div><p>187 Add FLWOR expression while clause</p></div>
<div class="toot" id="closed-260"><h2>Issue #260 closed<span class="toot-id"> #closed-260</span></h2><div class="pubdate">06 Feb at 17:46:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/260">https://github.com/qt4cg/qtspecs/issues/260</a></div><p>array:index-of</p></div>
<div class="toot" id="closed-968"><h2>Issue #968 closed<span class="toot-id"> #closed-968</span></h2><div class="pubdate">06 Feb at 17:46:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/968">https://github.com/qt4cg/qtspecs/pull/968</a></div><p>260 array:index-of</p></div>
<div class="toot" id="closed-969"><h2>Issue #969 closed<span class="toot-id"> #closed-969</span></h2><div class="pubdate">06 Feb at 17:43:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/969">https://github.com/qt4cg/qtspecs/pull/969</a></div><p>843-partial Standard, array &amp; map functions: Equivalencies</p></div>
<div class="toot" id="closed-973"><h2>Issue #973 closed<span class="toot-id"> #closed-973</span></h2><div class="pubdate">06 Feb at 17:40:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/973">https://github.com/qt4cg/qtspecs/issues/973</a></div><p>fn:parse-json, fn:json-to-xml: `number-parser`, `fallback`</p></div>
<div class="toot" id="closed-975"><h2>Issue #975 closed<span class="toot-id"> #closed-975</span></h2><div class="pubdate">06 Feb at 17:40:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/975">https://github.com/qt4cg/qtspecs/pull/975</a></div><p>973 fn:parse-json, fn:json-to-xml: number-parser, fallback</p></div>
<div class="toot" id="closed-984"><h2>Issue #984 closed<span class="toot-id"> #closed-984</span></h2><div class="pubdate">06 Feb at 17:37:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/984">https://github.com/qt4cg/qtspecs/pull/984</a></div><p>959-partial Add fn:seconds function</p></div>
<div class="toot" id="closed-993"><h2>Issue #993 closed<span class="toot-id"> #closed-993</span></h2><div class="pubdate">06 Feb at 17:34:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/993">https://github.com/qt4cg/qtspecs/pull/993</a></div><p>989 (partial) Allow char() to take integer argument</p></div>
<div class="toot" id="closed-830"><h2>Issue #830 closed<span class="toot-id"> #closed-830</span></h2><div class="pubdate">06 Feb at 17:31:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/830">https://github.com/qt4cg/qtspecs/issues/830</a></div><p>Revise appendix D.4 of F+O: Illustrative user-written functions</p></div>
<div class="toot" id="closed-997"><h2>Issue #997 closed<span class="toot-id"> #closed-997</span></h2><div class="pubdate">06 Feb at 17:31:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/997">https://github.com/qt4cg/qtspecs/pull/997</a></div><p>830 Drop F+O appendix D.4</p></div>
<div class="toot" id="closed-816"><h2>Issue #816 closed<span class="toot-id"> #closed-816</span></h2><div class="pubdate">06 Feb at 17:28:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/816">https://github.com/qt4cg/qtspecs/issues/816</a></div><p>Predicates: Support for numeric sequences </p></div>
<div class="toot" id="closed-996"><h2>Issue #996 closed<span class="toot-id"> #closed-996</span></h2><div class="pubdate">06 Feb at 17:28:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/996">https://github.com/qt4cg/qtspecs/pull/996</a></div><p>816 Allow a predicate in a filter expression to be a sequence of numbers</p></div>
<div class="toot" id="closed-995"><h2>Issue #995 closed<span class="toot-id"> #closed-995</span></h2><div class="pubdate">06 Feb at 17:25:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/995">https://github.com/qt4cg/qtspecs/pull/995</a></div><p>937 revised in light of CG feedback</p></div>
<div class="toot" id="closed-628"><h2>Issue #628 closed<span class="toot-id"> #closed-628</span></h2><div class="pubdate">06 Feb at 17:22:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/628">https://github.com/qt4cg/qtspecs/issues/628</a></div><p>distinct-values and duplicate-values: order of results</p></div>
<div class="toot" id="closed-987"><h2>Issue #987 closed<span class="toot-id"> #closed-987</span></h2><div class="pubdate">06 Feb at 17:22:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/987">https://github.com/qt4cg/qtspecs/pull/987</a></div><p>628 Define result order for distinct-values and duplicate-values</p></div>
<div class="toot" id="closed-911"><h2>Issue #911 closed<span class="toot-id"> #closed-911</span></h2><div class="pubdate">06 Feb at 17:19:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/911">https://github.com/qt4cg/qtspecs/issues/911</a></div><p>Type "Promotion" in the coercion rules</p></div>
<div class="toot" id="closed-980"><h2>Issue #980 closed<span class="toot-id"> #closed-980</span></h2><div class="pubdate">06 Feb at 17:19:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/980">https://github.com/qt4cg/qtspecs/pull/980</a></div><p>911 Coercion to allow double to decimal etc</p></div>
<div class="toot" id="closed-966"><h2>Issue #966 closed<span class="toot-id"> #closed-966</span></h2><div class="pubdate">06 Feb at 17:14:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/966">https://github.com/qt4cg/qtspecs/issues/966</a></div><p>Rewrite spec of deep lookup operator: edits</p></div>
<div class="toot" id="closed-979"><h2>Issue #979 closed<span class="toot-id"> #closed-979</span></h2><div class="pubdate">06 Feb at 17:14:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/979">https://github.com/qt4cg/qtspecs/pull/979</a></div><p>966 Minor fixes to deep lookup </p></div>
<div class="toot" id="closed-964"><h2>Issue #964 closed<span class="toot-id"> #closed-964</span></h2><div class="pubdate">06 Feb at 17:12:24 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/964">https://github.com/qt4cg/qtspecs/issues/964</a></div><p>fn:has-attributes</p></div>
<div class="toot" id="closed-970"><h2>Issue #970 closed<span class="toot-id"> #closed-970</span></h2><div class="pubdate">06 Feb at 17:11:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/970">https://github.com/qt4cg/qtspecs/issues/970</a></div><p>XQFO: Context item → value</p></div>
<div class="toot" id="closed-971"><h2>Issue #971 closed<span class="toot-id"> #closed-971</span></h2><div class="pubdate">06 Feb at 17:11:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/971">https://github.com/qt4cg/qtspecs/pull/971</a></div><p>970 XQFO: Context item → value</p></div>
<div class="toot" id="created-1002"><h2>Issue #1002 created<span class="toot-id"> #created-1002</span></h2><div class="pubdate">06 Feb at 10:10:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1002">https://github.com/qt4cg/qtspecs/issues/1002</a></div><details><summary>Reinstate subsequence-before</summary><div class="markup"><p>There's a question on StackOverflow today:</p>
<p>https://stackoverflow.com/questions/77944304/</p>
<p>that makes me think dropping <code>subsequence-before</code> might have been a mistake (the replacement, <code>subsequence-where</code>, doesn't allow the end condition to be exclusive).</p>
<p>The question is how to find all the consecutive <code>list</code> elements that follow a given <code>para</code> element. That would be solved with <code>subsequence-before(following-sibling::*, fn{not(self::list)})</code>. Doing it with <code>subsequence-where</code> is much harder - you need to drop the final element in the result if it is not a <code>list</code> element, while also taking into account that the result might be empty.</p>
<p>I would like to propose reinstating subsequence-before; or perhaps inverting the predicate and naming it <code>subsequence-while()</code>, so it becomes <code>subsequence-while(following-sibling::*, fn{self::list})</code> assuming we accept the proposal in issue #919 to allow a callback predicate to use EBV.</p>
</div></details></div>
<div class="toot" id="created-1001"><h2>Issue #1001 created<span class="toot-id"> #created-1001</span></h2><div class="pubdate">05 Feb at 13:32:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1001">https://github.com/qt4cg/qtspecs/issues/1001</a></div><details><summary>fn:subsequence-where: equivalent `fn:slice` expression</summary><div class="markup"><p>I probably should have tagged #940 with »Request Changes«, as I believe the equivalent expression with <code>fn:slice</code> needs to be fixed (or removed if it turns out to be too quirky): https://github.com/qt4cg/qtspecs/pull/940#issuecomment-1919399348.</p>
</div></details></div>
<div class="toot" id="agenda-02-06"><h2>QT4 CG meeting 064 draft agenda<span class="toot-id"> #agenda-02-06</span></h2><div class="pubdate">05 Feb at 12:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/02-06">https://qt4cg.org/meeting/agenda/2024/02-06</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-940"><h2>Issue #940 closed<span class="toot-id"> #closed-940</span></h2><div class="pubdate">05 Feb at 12:19:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/940">https://github.com/qt4cg/qtspecs/pull/940</a></div><p>878 Add subsequence-where function</p></div>
<div class="toot" id="created-1000"><h2>Issue #1000 created<span class="toot-id"> #created-1000</span></h2><div class="pubdate">04 Feb at 08:34:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/1000">https://github.com/qt4cg/qtspecs/issues/1000</a></div><details><summary>XQFO Code in the Rules sections</summary><div class="markup"><p>In #978, it’s being discussed what is the best language for presenting code in the Rules sections of the XQFO specification. Currently, XPath is used for compact equivalencies, for example…</p>
<pre><code class="language-xquery">(: array:size :)
count(array:members($array))

(: fn:remove :)
$input[not(position() = $positions)].
</code></pre>
<p>...while XQuery is used for more complex expressions, including function declarations, or when the XPath representation would be syntactically more complex. Examples:</p>
<pre><code class="language-xquery">(: fn:deep-equal :)
declare function equal-strings(
  $string1   as xs:string,
  $string2   as xs:string, 
  $collation as xs:string,
  $options   as map(*)
) as xs:boolean {
  let $n1 := if ($options?whitespace = "normalize"))
             then normalize-unicode(?, $options?normalization-form) 
             else identity#1
  let $n2 := if ($options?normalize-space)
             then normalize-space#1 
             else identity#1               
  return compare($n1($n2($string1)), $n1($n2($string2)), $collation) eq 0    
}

(: fn:index-where :)
for $item at $pos in $input
where $predicate($item, $pos)
return $pos

(: …flatten, fold-left, while-do, others :)
</code></pre>
<p>Finally, we have many cases in which XPath/XQuery code is omitted, either because the presented feature is basic enough, because the equivalent code would get too complicated, or (e.g., for <code>fn:doc</code>) because it does not provide means to express the feature.</p>
<p>We should strive for consistency and decide which language(s) the majority of us believes is the best choice…</p>
<ol>
<li>XPath &amp; XQuery (what we currently have)</li>
<li>XPath only</li>
<li>XPath, XQuery and XSLT (whatever seems most appropriate)</li>
<li>Other pseudocode</li>
<li>Don’t use pseudocode at all  if it is too complex to be represented with moderately simple XPath code</li>
</ol>
</div></details></div>
<div class="toot" id="created-999"><h2>Issue #999 created<span class="toot-id"> #created-999</span></h2><div class="pubdate">04 Feb at 04:00:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/999">https://github.com/qt4cg/qtspecs/issues/999</a></div><details><summary>regular expression addition - comments</summary><div class="markup"><p>The original Perl regular expression syntax allows comments with the x flag. They use # to introduce comments up to a newline.</p>
<p>Maybe we could support XPath-style comments in regular expressions, such as <code>(:#.......#:)</code> when the x flag is present?</p>
<p>Today i use <code>(?:comment: stuff here )?</code> but this requires that "stuff here" can be compiled into a regular expression!</p>
</div></details></div>
<div class="toot" id="created-998"><h2>Issue #998 created<span class="toot-id"> #created-998</span></h2><div class="pubdate">04 Feb at 03:57:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/998">https://github.com/qt4cg/qtspecs/issues/998</a></div><details><summary>regular expression addition - lookbehind assertions and lookahead assertions</summary><div class="markup"><p>look-ahead assertions are i think the most useful things not found in qt regular expressions, and also look-behind.</p>
<p>This lets you do things like</p>
<pre><code>  replace( ., '
     / ( [^/]+ ) (*positive_lookahead: /)
    ', '...', 'x')
</code></pre>
<p>replacing components between /..../ but not consuming the trailing /, so that
/a/b/c/d/ comes out as /../../../../</p>
<p>Perl uses
(?=pattern), (*pla:pattern), (*positive_lookahead:pattern)
(?!pattern), (*nla:pattern), (*negative_lookahead:pattern)
to match only if the pattern is (or is not) followed by a match to pattern,</p>
<p>and
(?&lt;=pattern), \K, (*plb:pattern), (*popsitive_lookbehind:pattern)
(?&lt;!pattern), (*nlb:pattern), (*negative_lookbehind:pattern)
for zero-width look-behind assertions.</p>
<p>Note, libpcre (and older Perl version) restrict lookbehind assertions to fixed length. You can write
(?&lt;=dog|cat) food
to match " food" preceded by "dog" or "cat", but you cannot write
(?&lt;=dogs?|cats?) barking</p>
<p>\C is also forbidden, as are capturing subgroups. But the facility is still very useful, and reduces the need for repeated substitutions.</p>
<p>I propose adding only the first form in each case, not the newer "*" forms, which are less widely supported.</p>
</div></details></div>
<div class="toot" id="created-997"><h2>Pull request #997 created<span class="toot-id"> #created-997</span></h2><div class="pubdate">03 Feb at 22:29:35 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/997">https://github.com/qt4cg/qtspecs/pull/997</a></div><details><summary>830 Drop F+O appendix D.4</summary><div class="markup"><p>This PR drops the non-normative appendix D.4, which contained illustrative user-written functions. It was a very patchy and disorganised collection of functions which were primarily there because someone had proposed adding a function to the standard library and the WG had turned down the suggestion on the grounds that users could easily write the function themselves. It's not worth the effort of rewriting the appendix to take 4.0 enhancements into account.</p>
<p>Fix #830</p>
</div></details></div>
<div class="toot" id="created-996"><h2>Pull request #996 created<span class="toot-id"> #created-996</span></h2><div class="pubdate">03 Feb at 18:16:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/996">https://github.com/qt4cg/qtspecs/pull/996</a></div><details><summary>816 Allow a predicate in a filter expression to be a sequence of numbers</summary><div class="markup"><p>Fix #816</p>
</div></details></div>
<div class="toot" id="created-995"><h2>Pull request #995 created<span class="toot-id"> #created-995</span></h2><div class="pubdate">03 Feb at 03:34:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/995">https://github.com/qt4cg/qtspecs/pull/995</a></div><details><summary>937 revised in light of CG feedback</summary><div class="markup"><p>This revises #937 (catalyzed by #779) in light CG discussion that approved the PR.</p>
<ul>
<li>Output is now <code>xs:hexBinary?</code></li>
<li>Second parameter <code>$algorithm</code> replaced with an option map. In the specs I avoided <code>fos:values/fos:value</code>, because this would disallow for case/space normalization, and it would effectively disallow any implement-defined algorithms not on the list of three algorithms, and trigger the dynamic error described in rule 6 in the <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#option-parameter-conventions">option parameter conventions</a>.</li>
<li>Options map has only one option. It doesn't make sense to provide an option changing the kind of output.</li>
<li>I think this is the first example of an options map where the <code>fos:meaning</code> has rich text (paragraphs, unordered lists). It builds and renders fine locally.</li>
<li>Extra note on the output format.</li>
<li>Examples are expressed as chained functions, to illustrate how to get the customary string values.</li>
</ul>
</div></details></div>
<div class="toot" id="created-994"><h2>Issue #994 created<span class="toot-id"> #created-994</span></h2><div class="pubdate">02 Feb at 20:12:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/994">https://github.com/qt4cg/qtspecs/issues/994</a></div><details><summary>Invoking maps &amp; arrays: allow sequences?</summary><div class="markup"><p>Can’t we support integer sequences as arguments in dynamic function calls on maps and arrays?</p>
<p>The following query is already valid…</p>
<pre><code class="language-xquery">[ 3, 4, 5 ] ? (2, 1)
</code></pre>
<p>…but the number of users who are able to decode this syntax is very limited. It would be easier to allow:</p>
<pre><code class="language-xquery">[ 3, 4, 5 ](2, 1)
</code></pre>
<p>I would expect the results to be returned in the supplied order (<code>4</code> and <code>3</code>).</p>
</div></details></div>
<div class="toot" id="created-993"><h2>Pull request #993 created<span class="toot-id"> #created-993</span></h2><div class="pubdate">02 Feb at 18:39:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/993">https://github.com/qt4cg/qtspecs/pull/993</a></div><details><summary>989 (partial) Allow char() to take integer argument</summary><div class="markup"><p>Addresses the use case in issue #989. (But leave the issue open for now).</p>
<p>Discussion point: should we drop the options <code>char("#32")</code> and <code>char("#x20")</code> as they now seem redundant?</p>
</div></details></div>
<div class="toot" id="created-992"><h2>Pull request #992 created<span class="toot-id"> #created-992</span></h2><div class="pubdate">02 Feb at 18:17:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/992">https://github.com/qt4cg/qtspecs/pull/992</a></div><details><summary>888, 963: Error handling for unsatisfied context dependencies</summary><div class="markup"><p>Fix #963 by providing more detail on the expected error handling for partial function application.</p>
<p>Fix #888 by making XPDY0002 a type error rather than a dynamic error.</p>
</div></details></div>
<div class="toot" id="created-991"><h2>Issue #991 created<span class="toot-id"> #created-991</span></h2><div class="pubdate">02 Feb at 17:52:23 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/991">https://github.com/qt4cg/qtspecs/issues/991</a></div><details><summary>Invisible-xml - missing details</summary><div class="markup"><p>The spec for invisible-xml doesn't say whether the parsing function returns an element node or a document node.</p>
<p>It should also say, for completeness, that the parsing function is "nondeterministic with respect to node identity" - that is, if you parse the same input twice, its undefined whether you get the same node twice, or different nodes.</p>
</div></details></div>
<div class="toot" id="created-990"><h2>Issue #990 created<span class="toot-id"> #created-990</span></h2><div class="pubdate">02 Feb at 10:20:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/990">https://github.com/qt4cg/qtspecs/issues/990</a></div><details><summary>Transitive closure on non-nodes</summary><div class="markup"><p>In PR #988 I inadvertently used the transitive-closure function to process non-nodes; that's not supported by the current specification of the function.</p>
<p>The only difficulty in extending it is how to define a suitable identity comparator so we know when to terminate. Probably this should be done using a callback, defaulting to <code>op('is')</code>. In the use case of PR #988, the comparator could be supplied as <code>false#0</code> - the step function is acyclic, so we can treat all items reached as distinct.</p>
</div></details></div>
<div class="toot" id="created-989"><h2>Issue #989 created<span class="toot-id"> #created-989</span></h2><div class="pubdate">01 Feb at 12:19:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/989">https://github.com/qt4cg/qtspecs/issues/989</a></div><details><summary>character sequence constructor 'a' to 'z'</summary><div class="markup"><p>Although you can write 'a' to 'z' as</p>
<pre><code class="language-xpath">   (string-to-codepoints('a') to string-to-codepoints('z') ! codepoints-to-string()
</code></pre>
<p>i’m not sure this is easily discoverable.</p>
<p>Note, 'a' to 'z' is obviously dependent on the current collation - if you're using EBCDIC may the dogs help you. I’m assuming, however, any two Unicode characters could appear in the string literals, and it’d be an error to have more than one character in either string.</p>
<p>This means 'ċ' to 'ŗ’ would be an error, not equivalent to 'c' to 'r' (taking the first character of each string), since those are not precomposed forms.</p>
<p>Mostly, i tend to write this because of other languages - e.g. Perl has 'a' .. 'ÿ' or whatever, as does Ruby.</p>
<p>ICU in Python has UnicodeSet('[[:Ll:]&amp;[:Latin:]]') which is powerful but grokhard (&amp; here is intersect i think).</p>
<p>Although 'a' to 'z' is probably what i've seen &amp; used most often, 'a' to 'f' and '0' to '9' are also obvious candidates.</p>
</div></details></div>
<div class="toot" id="created-988"><h2>Pull request #988 created<span class="toot-id"> #created-988</span></h2><div class="pubdate">01 Feb at 11:59:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/988">https://github.com/qt4cg/qtspecs/pull/988</a></div><details><summary>960 Pinned and labeled values</summary><div class="markup"><p>This PR introduces the concepts of pinned and labelled values and the way in which they can be used to obtain additional information about the results of a deep lookup or map/array navigation operation. The changes at this stage are confined to a new section in the data model spec introducing the concept of labeled items, and a new section in the XPath language spec showing how these are used when navigating maps and arrays. This is a first step; if the WG approves of the general approach, there will be a lot more detail to add in due course.</p>
<p>The PR addresses a number of open issues:</p>
<p>Issue #960 - flattening of results from $map??KS
Issue #711 - using annotations for navigation of JSON trees
Issue #596 - pinned values: transforming trees
Issue #350 - CompPath (composite objects path) expressions
Issue #334 - Transient properties: selection and update in maps and arrays
Issue #262 - navigation in deep-structured arrays
Issue #108 - template match using values of tunnel parameters</p>
<p>It does not claim to resolve them all, but I believe it provides the groundwork for doing so.</p>
</div></details></div>
<div class="toot" id="created-987"><h2>Pull request #987 created<span class="toot-id"> #created-987</span></h2><div class="pubdate">31 Jan at 22:45:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/987">https://github.com/qt4cg/qtspecs/pull/987</a></div><details><summary>628 Define result order for distinct-values and duplicate-values</summary><div class="markup"><p>Fix #628</p>
</div></details></div>
<div class="toot" id="created-986"><h2>Issue #986 created<span class="toot-id"> #created-986</span></h2><div class="pubdate">31 Jan at 17:07:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/986">https://github.com/qt4cg/qtspecs/issues/986</a></div><details><summary>Numeric Comparisons</summary><div class="markup"><p>We've been trying to change the semantics of numeric comparison without breaking existing applications. As a result, the current status quo is very messy. Let's review where we are.</p>
<p>The eq/lt operators, given mixed operand types, convert decimal operands to double and compare as double. No change from 3.1. This comparison is not transitive in edge cases. The <code>=</code> and <code>&lt;</code> operators are defined in terms of <code>eq</code> and <code>lt</code>.</p>
<p>Map key comparisons compare as "infinite precision decimal". No change from 3.1. This comparison is now exposed as fn:atomic-equal().</p>
<p>deep-equal() refers to atomic-equal(), which is a change in behaviour from 3.1.</p>
<p>distinct-values() refers to deep-equal(), which is a change in behaviour - deliberate, because it needs to be transitive.</p>
<p>index-of() refers to eq. No change from 3.1.</p>
<p>compare() has been newly introduced; like atomic-equal() it uses infinite precision decimal for comparison.</p>
<p>sort() uses compare(). This is a change from 3.1; again needed because transitivity is important.</p>
<p>min() and max() use compare(). This is a change from 3.1.</p>
<p>The new highest() and lowest() functions use sort().</p>
<p>XSLT for-each-group refers to distinct-values().</p>
<p>XSLT xsl:sort currently refers to numeric-compare() and will presumably change to use compare().</p>
<p>XSLT xsl:merge refers to xsl:sort</p>
<p>XQuery "group by" refers to deep-equal()</p>
<p>XQuery "order by" refers to compare()</p>
<p>So:</p>
<ul>
<li>Nearly everything now uses decimal comparison where the operands are of mixed type</li>
<li>There are many different ways that we say this - it's often indirect. There are only two comparison methods, but you have to follow a chain of references to work out which one applies.</li>
<li>The two exceptions that still do comparison the 3.1 way (converting both operands to xs:double) are (a) the eq/lt/=/&lt; operators, and (b) the index-of and array:index-of functions.</li>
</ul>
<p>There are definitely things that now break. For example I was working on tests yesterday with assertions in the form deep-equal(nodes/number(.), (8.2, 5.4, 6.5)) - that is, comparing doubles to decimals. The nodes actually contain the strings "8.2", "5.4", "6.5". The test was failing because converting the string "8.2" to a double and then converting the double to a decimal does not produce the decimal value 8.2.</p>
<p>This mixed bag really doesn't seem acceptable. What options do we have?</p>
<ol>
<li>Be bold: make everything uniformly use transitive comparisons, and accept that some user code will break.</li>
<li>Be timid: use transitive comparisons only where it really matters (distinct-values, grouping, sorting) and use promotion to double everywhere else.</li>
<li>Compromise: introduce a compatibility mode, or a context option that allows users to control the behaviour, or another set of comparison operators.</li>
</ol>
<p>Any other ideas?</p>
</div></details></div>
<div class="toot" id="created-985"><h2>Pull request #985 created<span class="toot-id"> #created-985</span></h2><div class="pubdate">31 Jan at 12:29:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/985">https://github.com/qt4cg/qtspecs/pull/985</a></div><details><summary>720 Add lookup arrow expressions (method invocations)</summary><div class="markup"><p>Fix #720.</p>
<p>Replaces #916.</p>
</div></details></div>
<div class="toot" id="closed-948"><h2>Issue #948 closed<span class="toot-id"> #closed-948</span></h2><div class="pubdate">31 Jan at 10:10:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/948">https://github.com/qt4cg/qtspecs/issues/948</a></div><p>fn:scan-left and fn:scan-right - produce accumulation of results</p></div>
<div class="toot" id="created-984"><h2>Pull request #984 created<span class="toot-id"> #created-984</span></h2><div class="pubdate">31 Jan at 10:00:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/984">https://github.com/qt4cg/qtspecs/pull/984</a></div><details><summary>959-partial Add fn:seconds function</summary><div class="markup"><p>Issue: #959</p>
</div></details></div>
<div class="toot" id="created-983"><h2>Issue #983 created<span class="toot-id"> #created-983</span></h2><div class="pubdate">31 Jan at 09:30:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/983">https://github.com/qt4cg/qtspecs/issues/983</a></div><details><summary>fn:reduce (or fn:fold without initial value)</summary><div class="markup"><p>Various languages (Kotlin, F#, Haskell, Rust, Scala, others) offer two functions for what we summarize as folds: one that accepts an initial value and another one that consumes the first item of the input as initial value. The first function is usually called <code>fold</code>, the latter is called <code>reduce</code>, but some languages (like JavaScript) pack the functionality into a single function.</p>
<p>We have the same options:</p>
<ol>
<li>We could tweak <code>fn:fold-left</code> and <code>fn:fold-right</code> in a way that the <code>zero</code> argument is ignored if it’s not explicitly supplied:</li>
</ol>
<pre><code class="language-xquery">fold-left(1 to 5, action := op('*'))
</code></pre>
<p>However, the behavior would then differ from <code>fold-left(1 to 5, (), action := op('*'))</code>, which is something we tried to avoid in more recent functions (there are functions like <code>fn:name</code>, though, that behave similarly: <code>fn:name(())</code> and <code>fn:name()</code> does something different).</p>
<ol start="2">
<li>We could also introduce a separate function <code>fn:reduce</code> (or 2 variants, resp. 4 if we include arrays):</li>
</ol>
<pre><code class="language-xquery">fn:reduce(
  $input   as item()*,
  $action  as function(item()*, item()) as item()*
) as item()*
</code></pre>
<p>This would allow us to do  <code>reduce(1 to 5, op('*'))</code>, and for some people, a reduce function will be more familiar than a fold.</p>
<p>On Wikipedia, there’s a good summary on <a href="https://en.wikipedia.org/wiki/Fold_(higher-order_function)#In_various_languages">folds in various languages</a>.</p>
</div></details></div>
<div class="toot" id="created-982"><h2>Issue #982 created<span class="toot-id"> #created-982</span></h2><div class="pubdate">31 Jan at 08:57:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/982">https://github.com/qt4cg/qtspecs/issues/982</a></div><details><summary>Add position argument to scan-left and scan-right</summary><div class="markup"><p>We have added an optional position argument to nearly all callback functions that are invoked once for each item in a sequence. This argument is omitted from the new scan-left and scan-right functions. It should be added for consistency.</p>
<p>One of the proposed use cases for scan-left and scan-right is for debugging calls on fold-left and fold-right. This use case requires that the callback functions in the two cases are compatible.</p>
<p>Background note: the optional position argument is modelled on Javascript, where it is permitted in all the common higher-order functions such as <code>filter</code>, <code>forEach</code>, <code>reduce</code> and <code>reduceRight</code> (which are the Javascript equivalent of fold-left and fold-right). Javascript doesn't appear to offer an equivalent of <code>scan-left</code> and <code>scan-right</code>.</p>
</div></details></div>
<div class="toot" id="created-981"><h2>Issue #981 created<span class="toot-id"> #created-981</span></h2><div class="pubdate">31 Jan at 00:34:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/981">https://github.com/qt4cg/qtspecs/issues/981</a></div><details><summary>Identify optional arguments in callback functions</summary><div class="markup"><p>It was pointed out today that is not obvious, looking at a function signature like</p>
<pre><code>fn:filter(
  $input as&nbsp;item()*, | &nbsp;
  $predicate as&nbsp;function(item(), xs:integer) as xs:boolean | &nbsp;
)&nbsp;as&nbsp;item()*
</code></pre>
<p>that the second argument of the <code>$predicate</code> function is optional.</p>
<p>At least in the documentation, it would be useful to capture this in some way. Being "optional" here means that it makes sense, semantically, to supply an arity-1 function, in which case the caller will not supply the second argument.</p>
<p>Perhaps it would also be useful to go beyond documentation, and attach some syntax and semantics to it. Specifically, if the signature of the callback function indicates that the first N arguments are required, then supplying a function item of arity less than N will result in a type error.</p>
</div></details></div>
<div class="toot" id="created-980"><h2>Pull request #980 created<span class="toot-id"> #created-980</span></h2><div class="pubdate">30 Jan at 23:59:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/980">https://github.com/qt4cg/qtspecs/pull/980</a></div><details><summary>911 Coercion to allow double to decimal etc</summary><div class="markup"><p>Fix #911 The coercion rules are changed to allow implicit casts among numeric types, for example a double can be supplied where the required type is decimal. (The term "promotion" is now used only for operators, where the two operands must be converted to a common type.)</p>
</div></details></div>
<div class="toot" id="created-979"><h2>Pull request #979 created<span class="toot-id"> #created-979</span></h2><div class="pubdate">30 Jan at 23:11:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/979">https://github.com/qt4cg/qtspecs/pull/979</a></div><details><summary>966 Minor fixes to deep lookup </summary><div class="markup"><p>Fix #966</p>
<p>Apply suggestions in Christian Grün's comments on PR #927.</p>
</div></details></div>
<div class="toot" id="created-978"><h2>Pull request #978 created<span class="toot-id"> #created-978</span></h2><div class="pubdate">30 Jan at 21:14:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/978">https://github.com/qt4cg/qtspecs/pull/978</a></div><details><summary>948 Reflected the comments of the CG on the specification of scan-left and scan-right</summary><div class="markup"><p>Reflected the comments of the CG on the specification of scan-left and scan-right</p>
</div></details></div>
<div class="toot" id="created-977"><h2>Pull request #977 created<span class="toot-id"> #created-977</span></h2><div class="pubdate">30 Jan at 17:42:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/977">https://github.com/qt4cg/qtspecs/pull/977</a></div><details><summary>Ignore this, it's just a test</summary><div class="markup"><p>I'm trying to work out why sometimes PR succeeds when it contains markup errors...</p>
</div></details></div>
<div class="toot" id="closed-976"><h2>Issue #976 closed<span class="toot-id"> #closed-976</span></h2><div class="pubdate">30 Jan at 17:32:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/976">https://github.com/qt4cg/qtspecs/pull/976</a></div><p>Fix markup errors with fos:notes</p></div>
<div class="toot" id="created-976"><h2>Pull request #976 created<span class="toot-id"> #created-976</span></h2><div class="pubdate">30 Jan at 17:32:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/976">https://github.com/qt4cg/qtspecs/pull/976</a></div><p>Fix markup errors with fos:notes</p></div>
<div class="toot" id="minutes-01-30"><h2>QT4 CG meeting 063 draft minutes<span class="toot-id"> #minutes-01-30</span></h2><div class="pubdate">30 Jan at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/01-30">https://qt4cg.org/meeting/minutes/2024/01-30</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-957"><h2>Issue #957 closed<span class="toot-id"> #closed-957</span></h2><div class="pubdate">30 Jan at 17:00:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/957">https://github.com/qt4cg/qtspecs/pull/957</a></div><p>948 Added fn:scan-left and fn:scan-right</p></div>
<div class="toot" id="closed-965"><h2>Issue #965 closed<span class="toot-id"> #closed-965</span></h2><div class="pubdate">30 Jan at 16:59:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/965">https://github.com/qt4cg/qtspecs/pull/965</a></div><p>XQFO: minor edits and bug fixes</p></div>
<div class="toot" id="created-975"><h2>Pull request #975 created<span class="toot-id"> #created-975</span></h2><div class="pubdate">29 Jan at 16:32:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/975">https://github.com/qt4cg/qtspecs/pull/975</a></div><details><summary>973 fn:parse-json, fn:json-to-xml: number-parser, fallback</summary><div class="markup"><p>Issue: #973.</p>
<p>In addition, I fixed the description for the <code>fallback</code> option <code>fn:parse-json</code>, as it seemed incomplete to me:</p>
<blockquote>
<p>The function is called when the JSON input contains a special character (as defined under the escape option) that is valid according to the JSON grammar, whether the special character is represented in the input directly or as an escape sequence.</p>
</blockquote>
</div></details></div>
<div class="toot" id="closed-974"><h2>Issue #974 closed<span class="toot-id"> #closed-974</span></h2><div class="pubdate">29 Jan at 12:32:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/974">https://github.com/qt4cg/qtspecs/issues/974</a></div><p>Rules for context-dependent function references in XSLT (e.g. regex-group#1)</p></div>
<div class="toot" id="agenda-01-30"><h2>QT4 CG meeting 063 draft agenda<span class="toot-id"> #agenda-01-30</span></h2><div class="pubdate">29 Jan at 12:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/01-30">https://qt4cg.org/meeting/agenda/2024/01-30</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-974"><h2>Issue #974 created<span class="toot-id"> #created-974</span></h2><div class="pubdate">29 Jan at 12:25:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/974">https://github.com/qt4cg/qtspecs/issues/974</a></div><details><summary>Rules for context-dependent function references in XSLT (e.g. regex-group#1)</summary><div class="markup"><p>I'm not sure where we are on this one.</p>
<p>Does regex-group#1 capture the "current matching substrings" component of the dynamic context?</p>
<p>XSLT 4.0 test case analyze-string-101 suggests that it does, and that this represents a change from 3.0 -- there are separate versions of the test with different expected results for the two cases.</p>
<p>But §5.4 of the XSLT 4.0 spec still ends with the sentence:</p>
<p><code>This rule does not extend to the XSLT extensions to the dynamic context defined in this section. If a dynamic function call is made that depends on the XSLT part of the dynamic context (for example, regex-group#1(2)), then the relevant components of the context are cleared as described in the table above.</code></p>
<p>I suspect this sentence should have been deleted, but need to track down the history.</p>
</div></details></div>
<div class="toot" id="created-973"><h2>Issue #973 created<span class="toot-id"> #created-973</span></h2><div class="pubdate">29 Jan at 12:24:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/973">https://github.com/qt4cg/qtspecs/issues/973</a></div><details><summary>fn:parse-json, fn:json-to-xml: `number-parser`, `fallback`</summary><div class="markup"><ol>
<li>See #33: <code>number-parser</code> option needs to be added to <code>fn:json-to-xml</code>.</li>
<li>Similar to <code>fn:replace</code>, I would suggest using <code>function(xs:untypedAtomic) as item()?)</code> as signature for both the <code>fallback</code> and the <code>number-parser</code> option, and (for <code>fallback</code>) to invoke <code>fn:string#1</code> on the result. This way, explicit casts in the code get obsolete. Queries like the following one…</li>
</ol>
<pre><code class="language-xquery">parse-json(
  '-123',
  map { 'number-parser': fn($n) { $n =&gt; number() =&gt; abs() }
)
</code></pre>
<p>…can then be simplified to <code>parse-json('-123', abs#1)</code>.</p>
</div></details></div>
<div class="toot" id="created-972"><h2>Pull request #972 created<span class="toot-id"> #created-972</span></h2><div class="pubdate">29 Jan at 11:28:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/972">https://github.com/qt4cg/qtspecs/pull/972</a></div><details><summary>949 Partial Function Applications: Allow return of function name</summary><div class="markup"><p>Issue: #949. The major change is the rule for the <code>name</code> property of partial function applications for static function calls.</p>
<p>In addition, I have unified the presentation of the different function item expressions.</p>
<p>Affects test cases like <code>xqhof40</code> (which need to be fixed with or without this PR).</p>
</div></details></div>
<div class="toot" id="created-971"><h2>Pull request #971 created<span class="toot-id"> #created-971</span></h2><div class="pubdate">29 Jan at 10:20:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/971">https://github.com/qt4cg/qtspecs/pull/971</a></div><details><summary>970 XQFO: Context item → value</summary><div class="markup"><p>Issue: #970</p>
</div></details></div>
<div class="toot" id="created-970"><h2>Issue #970 created<span class="toot-id"> #created-970</span></h2><div class="pubdate">28 Jan at 10:38:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/970">https://github.com/qt4cg/qtspecs/issues/970</a></div><details><summary>XQFO: Context item → value</summary><div class="markup"><p>Resulting from #129 (related: #755): Many rules in the XQFO spec still refer to the context item, which is currently defined as follows:</p>
<blockquote>
<p>When the context value is a single item, it can also be referred to as the context item; when it is a single node, it can also be referred to as the context node.</p>
</blockquote>
<p>We need to make clear what’s going to happen if the context value is not a single item:</p>
<ul>
<li>In many cases, this can simply be done by replacing “context item” with “context value”.</li>
<li>In some cases (e.g. for <code>fn:string#0</code>), we should specify that an error is raised (usually <code>XPTY0004</code>) if the input is not a single item.</li>
</ul>
</div></details></div>
<div class="toot" id="closed-878"><h2>Issue #878 closed<span class="toot-id"> #closed-878</span></h2><div class="pubdate">25 Jan at 08:42:28 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/878">https://github.com/qt4cg/qtspecs/issues/878</a></div><p>Proposed extension to subsequence</p></div>
<div class="toot" id="created-969"><h2>Pull request #969 created<span class="toot-id"> #created-969</span></h2><div class="pubdate">24 Jan at 18:19:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/969">https://github.com/qt4cg/qtspecs/pull/969</a></div><details><summary>843-partial Standard, array &amp; map functions: Equivalencies</summary><div class="markup"><p>Issue: #843</p>
<p>Maybe we should keep the issue open after merging this PR.</p>
</div></details></div>
<div class="toot" id="created-968"><h2>Pull request #968 created<span class="toot-id"> #created-968</span></h2><div class="pubdate">24 Jan at 17:57:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/968">https://github.com/qt4cg/qtspecs/pull/968</a></div><details><summary>260 array:index-of</summary><div class="markup"><p>Issue: #260</p>
</div></details></div>
<div class="toot" id="created-967"><h2>Issue #967 created<span class="toot-id"> #created-967</span></h2><div class="pubdate">24 Jan at 13:22:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/967">https://github.com/qt4cg/qtspecs/issues/967</a></div><details><summary>XPath Appendix I: Comparisons</summary><div class="markup"><p>Adopted from https://github.com/qt4cg/qtspecs/issues/260#issuecomment-1908033129</p>
<blockquote>
<p>It would be useful if all functions that perform comparison included a cross-reference to the new XPath Appendix I; and I note that appendix doesn't seem to mention index-of.</p>
</blockquote>
<p>@michaelhkay I’ve taken the liberty of assigning this to you, as I wasn’t sure what this is about.</p>
</div></details></div>
<div class="toot" id="closed-874"><h2>Issue #874 closed<span class="toot-id"> #closed-874</span></h2><div class="pubdate">24 Jan at 09:51:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/874">https://github.com/qt4cg/qtspecs/pull/874</a></div><p>878 Proposed extension to subsequence</p></div>
<div class="toot" id="created-966"><h2>Issue #966 created<span class="toot-id"> #created-966</span></h2><div class="pubdate">23 Jan at 20:23:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/966">https://github.com/qt4cg/qtspecs/issues/966</a></div><details><summary>Rewrite spec of deep lookup operator: edits</summary><div class="markup"><p>@michaelhkay I've created a little new issue to keep track of the 3 minor suggestions that I made in the PR that we merged today: https://github.com/qt4cg/qtspecs/pull/927</p>
</div></details></div>
<div class="toot" id="created-965"><h2>Pull request #965 created<span class="toot-id"> #created-965</span></h2><div class="pubdate">23 Jan at 18:20:57 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/965">https://github.com/qt4cg/qtspecs/pull/965</a></div><p>XQFO: minor edits and bug fixes</p></div>
<div class="toot" id="closed-818"><h2>Issue #818 closed<span class="toot-id"> #closed-818</span></h2><div class="pubdate">23 Jan at 17:52:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/818">https://github.com/qt4cg/qtspecs/issues/818</a></div><p>Foxpath integration</p></div>
<div class="toot" id="closed-693"><h2>Issue #693 closed<span class="toot-id"> #closed-693</span></h2><div class="pubdate">23 Jan at 17:52:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/693">https://github.com/qt4cg/qtspecs/issues/693</a></div><p>QT4 Tests without counterpart in the specs</p></div>
<div class="toot" id="closed-639"><h2>Issue #639 closed<span class="toot-id"> #closed-639</span></h2><div class="pubdate">23 Jan at 17:52:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/639">https://github.com/qt4cg/qtspecs/issues/639</a></div><p>fn:void: Naming, Arguments</p></div>
<div class="toot" id="closed-937"><h2>Issue #937 closed<span class="toot-id"> #closed-937</span></h2><div class="pubdate">23 Jan at 17:50:18 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/937">https://github.com/qt4cg/qtspecs/pull/937</a></div><p>779 hash function</p></div>
<div class="toot" id="closed-946"><h2>Issue #946 closed<span class="toot-id"> #closed-946</span></h2><div class="pubdate">23 Jan at 17:46:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/946">https://github.com/qt4cg/qtspecs/issues/946</a></div><p>fn:iterate-while → fn:while-do, fn:do-until</p></div>
<div class="toot" id="closed-962"><h2>Issue #962 closed<span class="toot-id"> #closed-962</span></h2><div class="pubdate">23 Jan at 17:46:26 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/962">https://github.com/qt4cg/qtspecs/pull/962</a></div><p>946 fn:iterate-while → fn:while-do, fn:do-until</p></div>
<div class="toot" id="closed-951"><h2>Issue #951 closed<span class="toot-id"> #closed-951</span></h2><div class="pubdate">23 Jan at 17:42:00 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/951">https://github.com/qt4cg/qtspecs/issues/951</a></div><p>Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-with-id</p></div>
<div class="toot" id="closed-958"><h2>Issue #958 closed<span class="toot-id"> #closed-958</span></h2><div class="pubdate">23 Jan at 17:41:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/958">https://github.com/qt4cg/qtspecs/pull/958</a></div><p>951 Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-id</p></div>
<div class="toot" id="closed-945"><h2>Issue #945 closed<span class="toot-id"> #closed-945</span></h2><div class="pubdate">23 Jan at 17:38:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/945">https://github.com/qt4cg/qtspecs/issues/945</a></div><p>Module import: apparent contradiction</p></div>
<div class="toot" id="closed-952"><h2>Issue #952 closed<span class="toot-id"> #closed-952</span></h2><div class="pubdate">23 Jan at 17:38:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/952">https://github.com/qt4cg/qtspecs/pull/952</a></div><p>945 module import contradiction</p></div>
<div class="toot" id="closed-950"><h2>Issue #950 closed<span class="toot-id"> #closed-950</span></h2><div class="pubdate">23 Jan at 17:34:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/950">https://github.com/qt4cg/qtspecs/pull/950</a></div><p>Minor edits (examples, rules)</p></div>
<div class="toot" id="closed-939"><h2>Issue #939 closed<span class="toot-id"> #closed-939</span></h2><div class="pubdate">23 Jan at 17:31:38 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/939">https://github.com/qt4cg/qtspecs/issues/939</a></div><p>Remove fn:numeric-compare</p></div>
<div class="toot" id="closed-941"><h2>Issue #941 closed<span class="toot-id"> #closed-941</span></h2><div class="pubdate">23 Jan at 17:31:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/941">https://github.com/qt4cg/qtspecs/pull/941</a></div><p>939 Remove fn:numeric-compare</p></div>
<div class="toot" id="closed-936"><h2>Issue #936 closed<span class="toot-id"> #closed-936</span></h2><div class="pubdate">23 Jan at 17:28:30 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/936">https://github.com/qt4cg/qtspecs/pull/936</a></div><p>877 revised rules for op:binary-less-than</p></div>
<div class="toot" id="closed-861"><h2>Issue #861 closed<span class="toot-id"> #closed-861</span></h2><div class="pubdate">23 Jan at 17:25:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/861">https://github.com/qt4cg/qtspecs/issues/861</a></div><p>Precise meaning of $E??KS</p></div>
<div class="toot" id="closed-927"><h2>Issue #927 closed<span class="toot-id"> #closed-927</span></h2><div class="pubdate">23 Jan at 17:25:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/927">https://github.com/qt4cg/qtspecs/pull/927</a></div><p>861 Rewrite spec of deep lookup operator</p></div>
<div class="toot" id="minutes-01-23"><h2>QT4 CG meeting 062 draft minutes<span class="toot-id"> #minutes-01-23</span></h2><div class="pubdate">23 Jan at 17:15:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/01-23">https://qt4cg.org/meeting/minutes/2024/01-23</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="created-964"><h2>Issue #964 created<span class="toot-id"> #created-964</span></h2><div class="pubdate">23 Jan at 12:30:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/964">https://github.com/qt4cg/qtspecs/issues/964</a></div><details><summary>fn:has-attributes</summary><div class="markup"><p>Trivial (motivated by a user request):</p>
<p>As there is an <code>fn:has-children</code> function, it seems surprising that there is no <code>fn:has-attributes</code> function.</p>
<p>I would suggest…</p>
<ul>
<li>adding this function to the spec, or</li>
<li>indicating in a note (for <code>fn:has-children</code>) why this function is missing.</li>
</ul>
</div></details></div>
<div class="toot" id="created-963"><h2>Issue #963 created<span class="toot-id"> #created-963</span></h2><div class="pubdate">23 Jan at 08:29:29 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/963">https://github.com/qt4cg/qtspecs/issues/963</a></div><details><summary>Errors in forming function items (continued)</summary><div class="markup"><p>In #894, the following rule was added to the definition of <strong>Named Function References</strong>:</p>
<blockquote>
<p>An error is raised if the identified function depends on components of the static or dynamic context that are not present, or that have unsuitable values. […] <code>DC0001</code> is raised for the call <code>fn:id#1</code> if the context item is not a node in a tree that is rooted at a document node.</p>
</blockquote>
<p>We should be consistent and add this rule to <strong>Partial Function Applications</strong> and <strong>Inline Function Expressions</strong> as well. Perhaps such rules could be defined just once for all affected function item constructors in the parent section?</p>
<p>Also, the error code doesn’t seem to be properly defined in the spec, it shows <code>[ERROR errorref DC0001 NOT FOUND]</code> (maybe that’s intentional at this editing stage.)</p>
</div></details></div>
<div class="toot" id="agenda-01-23"><h2>QT4 CG meeting 062 draft agenda<span class="toot-id"> #agenda-01-23</span></h2><div class="pubdate">22 Jan at 14:30:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/01-23">https://qt4cg.org/meeting/agenda/2024/01-23</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="created-962"><h2>Pull request #962 created<span class="toot-id"> #created-962</span></h2><div class="pubdate">20 Jan at 14:24:51 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/962">https://github.com/qt4cg/qtspecs/pull/962</a></div><details><summary>946 fn:iterate-while → fn:while-do, fn:do-until</summary><div class="markup"><p>My first thought was to name the second function <code>fn:do-while</code>, but <code>fn:do-until</code> with an inversed predicate seemed more appropriate to me.</p>
<p>Issue: #946</p>
</div></details></div>
<div class="toot" id="created-961"><h2>Issue #961 created<span class="toot-id"> #created-961</span></h2><div class="pubdate">20 Jan at 10:11:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/961">https://github.com/qt4cg/qtspecs/issues/961</a></div><details><summary>Simulating Objects: Performance</summary><div class="markup"><p>Related to #953, #917 and #916, I wonder whether we are aware enough of the essential differences when we think of objects in a functional language:</p>
<ul>
<li>Mutable objects are extremely efficient, as an update is a simple main-memory value change.</li>
<li>Immutable data structures need to be fully copied if a single value changes. As a result, the update of a map with, let’s say, 1 string and 50 functions would be a new map with 1 string and 50 functions. Even with efficient immutable map implementations that we have, I doubt that it makes sense to create full copies with 1+50 entries, of which only 1 string will be different.</li>
<li>Imagine a FLWOR expression that creates 1000 of such maps, with possibly 1 value that’s different in each instance. We don’t need 1000 copies of 50 functions; the memory consumption would be much smaller if we only stored relevant values.</li>
</ul>
<p>This thread is not about premature optimization; I just want to be sure we think about the obstacles when using maps for objects. Maybe the solutions are already on the horizon; maybe we could tackle some of the concerns with the definition of default values…</p>
<pre><code class="language-xquery">declare record person(
  name   as xs:string,
  title  := (),
  full   := fn { string-join((?title, ?name), ' ') }
);
</code></pre>
<p>…and maps with type annotations. If we don’t materialize defaults, the embedded annotation would indeed need to effect functions like <code>map:get</code>, as questioned by Michael in https://github.com/qt4cg/qtspecs/pull/953#issuecomment-1896078605.</p>
</div></details></div>
<div class="toot" id="created-960"><h2>Issue #960 created<span class="toot-id"> #created-960</span></h2><div class="pubdate">19 Jan at 16:24:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/960">https://github.com/qt4cg/qtspecs/issues/960</a></div><details><summary>Should ??KS flatten the results</summary><div class="markup"><p>Currently the result of <code>??KS</code> (like <code>?KS</code>) is flattened. So if you do <code>??dimensions</code> and the value of each <code>dimensions</code> entry is a sequence of zero or more numbers, the result munges them all together into a single sequence (dropping any empty values in the process).</p>
<p>Should we change this, for example to return a sequence of arrays, or an array of sequences?</p>
<p>This makes life a bit more difficult in the simple case where all the values are singletons -- and notably, when constructing a path such as <code>??A??B??C</code> -- but it makes it possible to handle the more general case where they aren't all singletons.</p>
</div></details></div>
<div class="toot" id="created-959"><h2>Issue #959 created<span class="toot-id"> #created-959</span></h2><div class="pubdate">18 Jan at 17:06:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/959">https://github.com/qt4cg/qtspecs/issues/959</a></div><details><summary>Milliseconds ↔ xs:dayTimeDuration, Unix time ↔ xs:dateTime</summary><div class="markup"><p>We should extend the constructor functions to convert integers (millisecond, and the Unix time, starting from <code>1970-01-01T00:00:00Z</code>) to <code>xs:dayTimeDuration</code> and <code>xs:dateTime</code> instances…</p>
<pre><code class="language-xquery">xs:dateTime(12345),
xs:dayTimeDuration(12345)
</code></pre>
<p>…and it should be possible to convert the values back to integers.</p>
<p>Related: https://docs.basex.org/wiki/Conversion_Module#Dates_and_Durations</p>
</div></details></div>
<div class="toot" id="created-958"><h2>Pull request #958 created<span class="toot-id"> #created-958</span></h2><div class="pubdate">18 Jan at 13:39:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/958">https://github.com/qt4cg/qtspecs/pull/958</a></div><details><summary>951 Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-id</summary><div class="markup"><p>Editorial (#951): Reverts the changes made in #901 for 4 context-dependent functions.</p>
</div></details></div>
<div class="toot" id="created-957"><h2>Pull request #957 created<span class="toot-id"> #created-957</span></h2><div class="pubdate">18 Jan at 01:31:27 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/957">https://github.com/qt4cg/qtspecs/pull/957</a></div><details><summary>948 Added fn:scan-left and fn:scan-right</summary><div class="markup"><p>As discussed at https://github.com/qt4cg/qtspecs/issues/948</p>
</div></details></div>
<div class="toot" id="created-956"><h2>Pull request #956 created<span class="toot-id"> #created-956</span></h2><div class="pubdate">17 Jan at 17:41:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/956">https://github.com/qt4cg/qtspecs/pull/956</a></div><details><summary>850-partial Editorial improvements to parse-html()</summary><div class="markup"><p>Related to issue #850, but doesn't close it entirely.</p>
</div></details></div>
<div class="toot" id="created-955"><h2>Issue #955 created<span class="toot-id"> #created-955</span></h2><div class="pubdate">17 Jan at 12:00:36 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/955">https://github.com/qt4cg/qtspecs/issues/955</a></div><details><summary>Options parameters as record types</summary><div class="markup"><p>In the new parse-html() function, the content of the options parameter is described using a record type. This differs from other functions, that describe the type as map(*), and have a statement that "the option parameter conventions apply".</p>
<p>Ideally we should use record types for all options parameters. However we need to check carefully that this does not affect edge-case compatibility, for example implicit conversions or the acceptability of extensions. If we can't do that then we should bring parse-html() into line with other functions such as parse-json().</p>
</div></details></div>
<div class="toot" id="created-954"><h2>Issue #954 created<span class="toot-id"> #created-954</span></h2><div class="pubdate">17 Jan at 00:45:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/954">https://github.com/qt4cg/qtspecs/issues/954</a></div><details><summary>Establish a default value for the XSLT fixed-namespaces attribute</summary><div class="markup"><p>The newly-defined <a href="https://qt4cg.org/specifications/xslt-40/Overview.html#fixed-namespaces"><strong>fixed-namespaces</strong> attribute</a> on the <em><code>xsl:stylesheet</code></em> element is a huge positive step towards improving programmer's productivity by removing the need to provide up to 9 namespace declarations in every stylesheet module, thus reducing unnecessary cluttering, simplifying and slimming the code and increasing its readability.</p>
<p>It seems like an accidental omission that the current text doesn't specify a default value for this attribute. If there is a well-chosen default value, this would even further decrease the requirements for the programmer to engage in such a non-problem-solving activity as entering memorized strings, and would prevent errors such as either not providing the correct values for the namespace-uris or forgetting to specify this new attribute.</p>
<p>One obvious candidate for a default value of the <strong>fixed-namespaces</strong> attribute is <code>#standard</code>, which means that without having to press even a single additional key, the XSLT programmer gets all standard namespaces automatically bound to the well-known prefixes:</p>
<p><code>xsl</code> <code>xml</code> <code>xs</code> <code>xsi</code> <code>fn</code>  <code>math</code> <code>map</code> <code>array</code> <code>err</code></p>
<h3>Proposal:</h3>
<p>Please, augment the current text by specifying that the default value for the <strong>fixed-namespaces</strong> attribute is <code>#standard</code></p>
</div></details></div>
<div class="toot" id="created-953"><h2>Pull request #953 created<span class="toot-id"> #created-953</span></h2><div class="pubdate">16 Jan at 23:10:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/953">https://github.com/qt4cg/qtspecs/pull/953</a></div><details><summary>617 Define record constructors</summary><div class="markup"><p>Fix #617</p>
<p>Note that this is a first step. Noticeably we can't yet use these constructor functions to create records that have methods. It's nevertheless a big step forward.</p>
</div></details></div>
<div class="toot" id="created-952"><h2>Pull request #952 created<span class="toot-id"> #created-952</span></h2><div class="pubdate">16 Jan at 18:52:58 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/952">https://github.com/qt4cg/qtspecs/pull/952</a></div><details><summary>945 module import contradiction</summary><div class="markup"><p>Soem editorial clarifications regarding XQuery module import and schema import.</p>
<p>Fix #945</p>
</div></details></div>
<div class="toot" id="closed-928"><h2>Issue #928 closed<span class="toot-id"> #closed-928</span></h2><div class="pubdate">16 Jan at 17:33:04 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/928">https://github.com/qt4cg/qtspecs/pull/928</a></div><p>Minor edits through ch. 15</p></div>
<div class="toot" id="closed-947"><h2>Issue #947 closed<span class="toot-id"> #closed-947</span></h2><div class="pubdate">16 Jan at 17:30:10 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/947">https://github.com/qt4cg/qtspecs/pull/947</a></div><p>Reorganise F+O chapter 15 [editorial]</p></div>
<div class="toot" id="closed-530"><h2>Issue #530 closed<span class="toot-id"> #closed-530</span></h2><div class="pubdate">16 Jan at 17:26:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/530">https://github.com/qt4cg/qtspecs/issues/530</a></div><p>Escaping of forward slash in JSON output method</p></div>
<div class="toot" id="closed-942"><h2>Issue #942 closed<span class="toot-id"> #closed-942</span></h2><div class="pubdate">16 Jan at 17:26:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/942">https://github.com/qt4cg/qtspecs/pull/942</a></div><p>530 Fix typo, escape-solidus not escape-uri-attributes</p></div>
<div class="toot" id="closed-880"><h2>Issue #880 closed<span class="toot-id"> #closed-880</span></h2><div class="pubdate">16 Jan at 17:26:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/880">https://github.com/qt4cg/qtspecs/pull/880</a></div><p>872 Symmetry: fn:items-at → fn:get</p></div>
<div class="toot" id="minutes-01-16"><h2>QT4 CG meeting 061 draft minutes<span class="toot-id"> #minutes-01-16</span></h2><div class="pubdate">16 Jan at 17:25:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/minutes/2024/01-16">https://qt4cg.org/meeting/minutes/2024/01-16</a></div><p>Draft minutes published.</p></div>
<div class="toot" id="closed-930"><h2>Issue #930 closed<span class="toot-id"> #closed-930</span></h2><div class="pubdate">16 Jan at 17:23:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/930">https://github.com/qt4cg/qtspecs/issues/930</a></div><p>Obsolete comment under fn:deep-equal()</p></div>
<div class="toot" id="closed-933"><h2>Issue #933 closed<span class="toot-id"> #closed-933</span></h2><div class="pubdate">16 Jan at 17:23:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/933">https://github.com/qt4cg/qtspecs/pull/933</a></div><p>930 drop obsolete note about comments and PIs</p></div>
<div class="toot" id="closed-932"><h2>Issue #932 closed<span class="toot-id"> #closed-932</span></h2><div class="pubdate">16 Jan at 17:20:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/932">https://github.com/qt4cg/qtspecs/pull/932</a></div><p>931 Add rules for duration precision</p></div>
<div class="toot" id="closed-931"><h2>Issue #931 closed<span class="toot-id"> #closed-931</span></h2><div class="pubdate">16 Jan at 17:20:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/931">https://github.com/qt4cg/qtspecs/issues/931</a></div><p>Precision of duration arithmetic</p></div>
<div class="toot" id="closed-737"><h2>Issue #737 closed<span class="toot-id"> #closed-737</span></h2><div class="pubdate">16 Jan at 17:17:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/737">https://github.com/qt4cg/qtspecs/pull/737</a></div><p>295: Boost the capability of recursive record types</p></div>
<div class="toot" id="created-951"><h2>Issue #951 created<span class="toot-id"> #created-951</span></h2><div class="pubdate">16 Jan at 13:58:32 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/951">https://github.com/qt4cg/qtspecs/issues/951</a></div><details><summary>Parameters with default values: fn:lang, fn:id, fn:idref, fn:element-with-id</summary><div class="markup"><p>Since #895, absent optional arguments and empty sequences in built-in functions are treated identically. Exceptions are functions that already had different rules for such cases (e.g., <code>fn:node(())</code> always returns an empty sequence, no matter what the context is).</p>
<p>I noticed we should also exclude <code>fn:lang</code>, <code>fn:id</code>, <code>fn:idref</code>, and <code>fn:element-with-id</code>: Otherwise, a compiler won’t be able to statically assess if a function call is dependent on the context.</p>
</div></details></div>
<div class="toot" id="created-950"><h2>Pull request #950 created<span class="toot-id"> #created-950</span></h2><div class="pubdate">16 Jan at 11:53:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/950">https://github.com/qt4cg/qtspecs/pull/950</a></div><details><summary>Minor edits (examples, rules)</summary><div class="markup"><ul>
<li>Examples were fixed.</li>
<li>The equivalent expression for <code>map:values</code> was changed to <code>$map?*</code>.</li>
</ul>
</div></details></div>
<div class="toot" id="created-949"><h2>Issue #949 created<span class="toot-id"> #created-949</span></h2><div class="pubdate">16 Jan at 11:21:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/949">https://github.com/qt4cg/qtspecs/issues/949</a></div><details><summary>Partial Function Applications: Allow return of function name</summary><div class="markup"><p>Without wanting to revive #889, an important observation I picked up is that named function references and “partially applied functions without applications” can be considered identical. That is, there should be no reason to distinguish between <code>count#1</code> and <code>count(?)</code>.</p>
<p>Currently, however, partially applied functions are currently defined to lose the reference to the original function and its arity (and some Qt4 tests ensure that this is the case: https://github.com/qt4cg/qt4tests/blob/8649941e0e695ff8fb4cb27c52e99590cc88126f/misc/HigherOrderFunctions.xml#L1933).</p>
<p>From a user perspective, I see no reason why the two cases should be treated differently, and I would argue that we should either treat them identically or (at least) allow implementations to treat them identically, i.e., allowing an implementation to return <code>count</code> for <code>function-name(count(?))</code>.</p>
</div></details></div>
<div class="toot" id="created-948"><h2>Issue #948 created<span class="toot-id"> #created-948</span></h2><div class="pubdate">15 Jan at 18:59:21 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/948">https://github.com/qt4cg/qtspecs/issues/948</a></div><details><summary>fn:scan-left and fn:scan-right - produce accumulation of results</summary><div class="markup"><h1>fn:scan-left and fn:scan-right - produce accumulation of results</h1>
<p>In XPath 4.0 so far we still don't have a convenient way to express the functionality of producing a series of accumulated (accrued) results when applying a folding function over a collection (sequence, array, ...) of items. The general use-case for this is the task to produce a sequence of running totals when applying an operation over a sequence of data points: <strong>produce the partial sums of loan payments</strong> over fixed periods, <strong>produce the compounded amounts  of a deposit</strong> with fixed interest rate over years, ..., etc.</p>
<p>Two functions (shamelessly borrowed from Haskell):</p>
<ul>
<li><strong>fn:scan-left</strong></li>
<li><strong>fn:scan-right</strong></li>
</ul>
<hr>
<h2>fn:scan-left</h2>
<p>This function has a similar signature to that of <strong><em><code>fn:fold-left</code></em></strong> and produces the same final result, however it produces the complete (ordered) sequence of all partial results from every new value the accumulator gets during the evaluation of <strong><em><code>fn:fold-left</code></em></strong>.</p>
<h3>Signature</h3>
<pre><code class="language-xq">fn:scan-left($input	as item()*,	
             $zero	as item()*,	
             $action	as function(item()*, item()) as item()*	
) as array(*)*
</code></pre>
<h3>Properties</h3>
<p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-deterministic">·deterministic·</a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-context-independent">·context-independent·</a>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-focus-independent">·focus-independent·</a>.</p>
<h3>Rules</h3>
<p>The function is equivalent to the following implementation in XPath(return clause added for completeness):</p>
<pre><code class="language-xq">let $scan-left-inner := function($seq as item()*, 
                                 $zero as item(), 
                                 $fun as function(item()*, item()) as item()*,
                                 $self as function(*)
                               ) as array(*)*                               
{
  let $result := [$zero]
   return
     if(empty($seq)) then $result
       else
         (
           $result, $self(tail($seq), $fun($zero, head($seq)), $fun, $self)  
         )
},

$scan-left := function($seq as item()*, 
                       $zero as item(), 
                       $fun as function(item()*, item()) as item()*
                     ) as array(*)*  
{
  $scan-left-inner($seq, $zero, $fun, $scan-left-inner)
}  

  return
    $scan-left(1 to 10, 0, op('+'))
</code></pre>
<h3>Examples:</h3>
<pre><code class="language-xq"> $scan-left(1 to 10, 0, op('+'))
</code></pre>
<p>produces:</p>
<pre><code class="language-xq">[0]
[1]
[3]
[6]
[10]
[15]
[21]
[28]
[36]
[45]
[55]
</code></pre>
<p><img src="https://github.com/qt4cg/qtspecs/assets/10605892/603c0584-31bb-431f-b928-875058111128" alt="image"></p>
<h2>fn:scan-right</h2>
<p>This function has a similar signature to that of <strong><em><code>fn:fold-right</code></em></strong> and produces the same final result, however it produces the complete (ordered) sequence of all partial results from every new value the accumulator gets during the evaluation of <strong><em><code>fn:fold-right</code></em></strong>.</p>
<h3>Signature</h3>
<pre><code class="language-xq">fn:scan-right($input	as item()*,	
              $zero	as item()*,	
              $action	as function(item()*, item()) as item()*	
) as array(*)*
</code></pre>
<h3>Properties</h3>
<p>This function is <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-deterministic">·deterministic·</a>, <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-context-independent">·context-independent·</a>, and <a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#dt-focus-independent">·focus-independent·</a>.</p>
<h3>Rules</h3>
<p>The function is equivalent to the following implementation in XPath(return clause added for completeness):</p>
<pre><code class="language-xq">let  $scan-right-inner := function($seq as item()*,
                                   $zero as item()*,
                                   $f as function(item(), item()*) as item()*,                          
                                   $self as function(*)
                                  ) as array(*)*
{
    if(empty($seq)) then [$zero]
      else
        let $rightResult := $self(tail($seq), $zero, $f, $self)
         return
            ([$f(head($seq), head($rightResult))], $rightResult)
},

$scan-right := function($seq as item()*,
                        $zero as item()*,
                        $f as function(item(), item()*) as item()*
                       ) as array(*)*
{
  $scan-right-inner($seq, $zero, $f, $scan-right-inner)
}   

return
  $scan-right(1 to 10, 0, op('+'))  
</code></pre>
<h3>Examples:</h3>
<pre><code class="language-xq"> $scan-right(1 to 10, 0, op('+'))
</code></pre>
<p>produces:</p>
<pre><code class="language-xq">[55]
[54]
[52]
[49]
[45]
[40]
[34]
[27]
[19]
[10]
[0]
</code></pre>
<p><img src="https://github.com/qt4cg/qtspecs/assets/10605892/68f5010d-133d-4bcf-8096-609a3d26697f" alt="image"></p>
</div></details></div>
<div class="toot" id="agenda-01-16"><h2>QT4 CG meeting 061 draft agenda<span class="toot-id"> #agenda-01-16</span></h2><div class="pubdate">15 Jan at 14:40:00 GMT</div><div class="link">Link: <a href="https://qt4cg.org/meeting/agenda/2024/01-16">https://qt4cg.org/meeting/agenda/2024/01-16</a></div><p>Draft agenda published.</p></div>
<div class="toot" id="closed-899"><h2>Issue #899 closed<span class="toot-id"> #closed-899</span></h2><div class="pubdate">15 Jan at 15:21:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/899">https://github.com/qt4cg/qtspecs/issues/899</a></div><p>Simplifying the language - types have behaviour.</p></div>
<div class="toot" id="created-947"><h2>Pull request #947 created<span class="toot-id"> #created-947</span></h2><div class="pubdate">15 Jan at 10:39:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/947">https://github.com/qt4cg/qtspecs/pull/947</a></div><details><summary>Reorganise F+O chapter 15 [editorial]</summary><div class="markup"><p>This PR reorganizes the subsections of F+O chapter 15 (the XML/HTML/JSON/CSV/IXML chapter). There is no change to content apart from a couple of introductory sentences. I'm planning to do some fine-grained work on the content in due course, but to make that easier to review it seems best to do the top-level reorganisation first. I'm therefore hoping that this PR will go through quickly "on the nod" so I can use it as a baseline for the detail changes.</p>
</div></details></div>
<div class="toot" id="created-946"><h2>Issue #946 created<span class="toot-id"> #created-946</span></h2><div class="pubdate">12 Jan at 16:10:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/946">https://github.com/qt4cg/qtspecs/issues/946</a></div><details><summary>fn:iterate-while → fn:while-do, fn:do-until</summary><div class="markup"><p>First feedback shows that <code>fn:iterate-while</code> is helpful, but the name needs to be improved: It implies that the first iteration occurs before the invocation of the test… Which could sometimes be helpful, too.</p>
<p>I suggest renaming the function to <code>fn:while-do</code> (“do” is commonly used when while loops are specified), and adding <code>fn:do-until</code>.</p>
</div></details></div>
<div class="toot" id="created-945"><h2>Issue #945 created<span class="toot-id"> #created-945</span></h2><div class="pubdate">12 Jan at 15:41:25 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/945">https://github.com/qt4cg/qtspecs/issues/945</a></div><details><summary>Module import: apparent contradiction</summary><div class="markup"><p>XQuery 5.12 paragraph 2 says:</p>
<blockquote>
<p>If a module A imports module B, the static context of module A will contain the [in-scope schema definitions]... of module B.</p>
</blockquote>
<p>Paragraph 10 says:</p>
<blockquote>
<p>A [module import] imports only functions, variable declarations, and item type declaratons; it does not import other objects from the imported modules, such as [in-scope schema definitions] or [statically known namespaces].</p>
</blockquote>
<p>They can't both be right, surely?</p>
</div></details></div>
<div class="toot" id="created-944"><h2>Issue #944 created<span class="toot-id"> #created-944</span></h2><div class="pubdate">12 Jan at 11:18:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/944">https://github.com/qt4cg/qtspecs/issues/944</a></div><details><summary>Coercion rules: implicit types</summary><div class="markup"><p>Since 2.0, the coercion rules (formerly function conversion rules) have allowed implicit conversion from decimal to double, decimal to float, and float to double on function calls; other conversions such as double to decimal or float to decimal are not allowed. This has never made very much sense because in some implementations, decimal to float is a lossy conversion whereas float to decimal is not.</p>
<p>One option would be to allow conversion from any numeric type to any other.</p>
<p>The main caveat here is that I don't think it makes sense to allow a double such as 1.5e0 to be supplied where the required type is xs:integer. We have introduced new conversions that make it possible to supply a decimal where an integer is expected, but only if the decimal is in the value space of integer.</p>
<p>A possible formulation would be:</p>
<p>If the required type is a numeric type (that is, xs:decimal, xs:double, xs:float, or any type derived from these), and if the supplied value is a numeric value, then the supplied value is cast to the required primitive type, and if the result is in the value space of the actual required type it is then relabelled as an instance of the actual required type (if not, the conversion fails).</p>
<p>This means that supplying 1.0e0 for an argument expecting xs:integer (or xs:positiveInteger, etc) would work (it would cast to xs:decimal and then relabel as xs:integer), but supplying 1.1e0 would fail.</p>
</div></details></div>
<div class="toot" id="created-943"><h2>Pull request #943 created<span class="toot-id"> #created-943</span></h2><div class="pubdate">11 Jan at 10:28:42 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/943">https://github.com/qt4cg/qtspecs/pull/943</a></div><details><summary>187 Add FLWOR expression while clause</summary><div class="markup"><p>Fix #187</p>
</div></details></div>
<div class="toot" id="created-942"><h2>Pull request #942 created<span class="toot-id"> #created-942</span></h2><div class="pubdate">10 Jan at 16:42:17 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/942">https://github.com/qt4cg/qtspecs/pull/942</a></div><details><summary>530 Fix typo, escape-solidus not escape-uri-attributes</summary><div class="markup"><p>Fix #530.</p>
<p>On half a dozen occasions, <code>escape-uri-attributes</code> is used where <code>escape-solidus</code> is clearly intended.</p>
</div></details></div>
<div class="toot" id="closed-886"><h2>Issue #886 closed<span class="toot-id"> #closed-886</span></h2><div class="pubdate">10 Jan at 14:28:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/886">https://github.com/qt4cg/qtspecs/issues/886</a></div><p>Binary map keys</p></div>
<div class="toot" id="created-941"><h2>Pull request #941 created<span class="toot-id"> #created-941</span></h2><div class="pubdate">10 Jan at 12:20:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/941">https://github.com/qt4cg/qtspecs/pull/941</a></div><details><summary>939 Remove fn:numeric-compare</summary><div class="markup"><p>Issue: #939</p>
</div></details></div>
<div class="toot" id="created-940"><h2>Pull request #940 created<span class="toot-id"> #created-940</span></h2><div class="pubdate">10 Jan at 12:05:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/940">https://github.com/qt4cg/qtspecs/pull/940</a></div><details><summary>878 Add subsequence-where function</summary><div class="markup"><p>Supersedes PR #874</p>
<p>Following discussion of PR #874 which proposed an extended subsequence() function with options to define the start and end position by predicates, this new PR proposes instead a subsequence-where() function that allows the start and end position to be defined by predicates, leaving the existing subsequence() function unchanged.</p>
<p>The items-before/after/starting-where/ending-where quartet are dropped.</p>
<p>The new function is inclusive at both ends. To start at the item after the one that matches the start condition, apply tail() to the result. To finish before the item that matches the end condition, apply trunk() to the result.</p>
</div></details></div>
<div class="toot" id="closed-893"><h2>Issue #893 closed<span class="toot-id"> #closed-893</span></h2><div class="pubdate">10 Jan at 11:55:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/893">https://github.com/qt4cg/qtspecs/issues/893</a></div><p>fn:compare: Support for arbitrary atomic types</p></div>
<div class="toot" id="closed-918"><h2>Issue #918 closed<span class="toot-id"> #closed-918</span></h2><div class="pubdate">10 Jan at 09:19:54 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/918">https://github.com/qt4cg/qtspecs/pull/918</a></div><p>Minor cx through chap. 14</p></div>
<div class="toot" id="created-939"><h2>Issue #939 created<span class="toot-id"> #created-939</span></h2><div class="pubdate">10 Jan at 09:12:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/939">https://github.com/qt4cg/qtspecs/issues/939</a></div><details><summary>Remove fn:numeric-compare</summary><div class="markup"><p>Related action: <a href="https://qt4cg.org/meeting/minutes/2024/01-09.html">QT4CG-060-04</a></p>
<p>@michaelhkay I proposed to merge <code>fn:numeric-compare</code> into <code>fn:compare</code> in #866; your response was:</p>
<blockquote>
<p>Folding fn:numeric-compare into fn:compare is more feasible, but you've then got one function that does two different jobs; there's no type safety to ensure that the arguments have compatible types, and you need ad-hoc rules to say which combinations of arguments are valid and which aren't. The merit of two separate functions is that each is a total function over the domain implied by its signature.</p>
</blockquote>
<p>Do you think the concerns are still relevant, or should we tackle this?</p>
</div></details></div>
<div class="toot" id="created-938"><h2>Issue #938 created<span class="toot-id"> #created-938</span></h2><div class="pubdate">10 Jan at 04:30:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/938">https://github.com/qt4cg/qtspecs/issues/938</a></div><details><summary>Canonical serialization</summary><div class="markup"><p>This issue picks up suggestions from #779 regarding canonical serialization, and solicits from the community group input on if such a function is desirable, and what such a function might look like.</p>
<p>In the context of #779, the idea was that two XML documents with different physical representations, but semantically equivalent, could be serialized to a canonical form, with a hash value applied to each confirming identity. Of course, with canonical operation, a simple string comparison would be sufficient, absent any hashing.</p>
<p>XML Signature was suggested as one approach, with some hesitation. I would like to suggest, instead, that we look to implement <a href="https://www.w3.org/TR/xml-c14n/">Canonical XML Version 1.1</a> (herein <strong>CX1.1</strong>), perhaps with map options that calibrate how CX1.1 is implemented. I have no experience using CX1.1, so user input is welcome.</p>
<p>Another point of discussion is whether this merits a new function, e.g., <code>fn:canonical-serialize</code>, or should be built upon <code>fn:serialize</code>. A problem with the latter option, is that such an approach makes no sense without the <code>method</code> option specified as <code>xml</code>. Another approach would be to go deeper, into the serialization spec, and expand the <code>xml</code> method to ensure a canonical option.</p>
<p>I believe that this function would be extremely useful. When preparing test suites, output could be saved as secondary documents as canonical XML, and any subsequent regression tests could adjust comparanda to canonical XML, and very precise node-wise comparisons could be made.</p>
<p>I look forward to everyone's input.</p>
</div></details></div>
<div class="toot" id="created-937"><h2>Pull request #937 created<span class="toot-id"> #created-937</span></h2><div class="pubdate">10 Jan at 04:03:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/937">https://github.com/qt4cg/qtspecs/pull/937</a></div><details><summary>779 hash function</summary><div class="markup"><p>First draft of hash function, proposed in #779.</p>
<p>Error message left as to-do item; guidance from editors appreciated.</p>
<p>I opted to leave out wrapper/cryptographic functionality, such as salting, and to demonstrate via example how it could be done by a developer on their own. In my opinion what we need here is a simple atomic function that can be incorporated into other molecular functions.</p>
<p>I may tinker with the prose description up to CG discussion, so comments are welcome.</p>
</div></details></div>
<div class="toot" id="created-936"><h2>Pull request #936 created<span class="toot-id"> #created-936</span></h2><div class="pubdate">10 Jan at 02:30:08 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/936">https://github.com/qt4cg/qtspecs/pull/936</a></div><details><summary>877 revised rules for op:binary-less-than</summary><div class="markup"><p>Rule 3 for <code>op:binary-less-than</code> was a bit of a mess (see #877), and needed to be expressed as a recursive operation.</p>
<p>My proposed revision depends of phraseology drawn from <code>fn:decode-from-uri</code>, <code>fn:deep-equal</code>, and 5.3.2 Unicode Codepoint Collation (here slightly adjusted from unordered to ordered list).</p>
</div></details></div>
<div class="toot" id="closed-876"><h2>Issue #876 closed<span class="toot-id"> #closed-876</span></h2><div class="pubdate">10 Jan at 01:24:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/876">https://github.com/qt4cg/qtspecs/issues/876</a></div><p>Placement of fn:in-scope-namespaces(), fn:in-scope-prefixes(), fn:namespace-uri-for-prefix()</p></div>
<div class="toot" id="closed-909"><h2>Issue #909 closed<span class="toot-id"> #closed-909</span></h2><div class="pubdate">09 Jan at 17:54:43 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/909">https://github.com/qt4cg/qtspecs/pull/909</a></div><p>893 fn:compare: Support for arbitrary atomic types</p></div>
<div class="toot" id="closed-860"><h2>Issue #860 closed<span class="toot-id"> #closed-860</span></h2><div class="pubdate">09 Jan at 17:51:34 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/860">https://github.com/qt4cg/qtspecs/issues/860</a></div><p>Unary Lookup when the context value is a sequence</p></div>
<div class="toot" id="closed-926"><h2>Issue #926 closed<span class="toot-id"> #closed-926</span></h2><div class="pubdate">09 Jan at 17:51:33 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/926">https://github.com/qt4cg/qtspecs/pull/926</a></div><p>860 Editorial rearrangement of spec for shallow lookup</p></div>
<div class="toot" id="closed-780"><h2>Issue #780 closed<span class="toot-id"> #closed-780</span></h2><div class="pubdate">09 Jan at 17:42:48 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/780">https://github.com/qt4cg/qtspecs/issues/780</a></div><p>format-number() etc incompatibility</p></div>
<div class="toot" id="closed-925"><h2>Issue #925 closed<span class="toot-id"> #closed-925</span></h2><div class="pubdate">09 Jan at 17:42:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/925">https://github.com/qt4cg/qtspecs/pull/925</a></div><p>780 Document incompatibility in format-number etc</p></div>
<div class="toot" id="closed-935"><h2>Issue #935 closed<span class="toot-id"> #closed-935</span></h2><div class="pubdate">09 Jan at 17:41:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/935">https://github.com/qt4cg/qtspecs/pull/935</a></div><p>Fix the fo test catalog</p></div>
<div class="toot" id="created-935"><h2>Pull request #935 created<span class="toot-id"> #created-935</span></h2><div class="pubdate">09 Jan at 17:41:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/935">https://github.com/qt4cg/qtspecs/pull/935</a></div><details><summary>Fix the fo test catalog</summary><div class="markup"><p>A duplicate name was introduced.</p>
</div></details></div>
<div class="toot" id="closed-648"><h2>Issue #648 closed<span class="toot-id"> #closed-648</span></h2><div class="pubdate">09 Jan at 17:36:20 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/648">https://github.com/qt4cg/qtspecs/issues/648</a></div><p>Schema for FN namespace should block extension and substitution</p></div>
<div class="toot" id="closed-924"><h2>Issue #924 closed<span class="toot-id"> #closed-924</span></h2><div class="pubdate">09 Jan at 17:36:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/924">https://github.com/qt4cg/qtspecs/pull/924</a></div><p>648 Disallow user modifications to schema for FN namespace</p></div>
<div class="toot" id="closed-913"><h2>Issue #913 closed<span class="toot-id"> #closed-913</span></h2><div class="pubdate">09 Jan at 17:30:07 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/913">https://github.com/qt4cg/qtspecs/issues/913</a></div><p>XQFO: under/unused variable apparatus</p></div>
<div class="toot" id="closed-923"><h2>Issue #923 closed<span class="toot-id"> #closed-923</span></h2><div class="pubdate">09 Jan at 17:30:06 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/923">https://github.com/qt4cg/qtspecs/pull/923</a></div><p>913-new-examples-for-local-name-etc</p></div>
<div class="toot" id="closed-915"><h2>Issue #915 closed<span class="toot-id"> #closed-915</span></h2><div class="pubdate">09 Jan at 17:27:14 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/915">https://github.com/qt4cg/qtspecs/issues/915</a></div><p>[Editorial] Incorrect terminology: function implementation is now function body</p></div>
<div class="toot" id="closed-922"><h2>Issue #922 closed<span class="toot-id"> #closed-922</span></h2><div class="pubdate">09 Jan at 17:27:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/922">https://github.com/qt4cg/qtspecs/pull/922</a></div><p>915 function body terminology</p></div>
<div class="toot" id="closed-914"><h2>Issue #914 closed<span class="toot-id"> #closed-914</span></h2><div class="pubdate">09 Jan at 17:23:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/914">https://github.com/qt4cg/qtspecs/pull/914</a></div><p>XQFO minor edits</p></div>
<div class="toot" id="closed-912"><h2>Issue #912 closed<span class="toot-id"> #closed-912</span></h2><div class="pubdate">09 Jan at 17:20:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/912">https://github.com/qt4cg/qtspecs/pull/912</a></div><p>XQFO: Minor edits</p></div>
<div class="toot" id="closed-906"><h2>Issue #906 closed<span class="toot-id"> #closed-906</span></h2><div class="pubdate">09 Jan at 17:17:39 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/906">https://github.com/qt4cg/qtspecs/issues/906</a></div><p>fn:deep-equal: unordered → ordered</p></div>
<div class="toot" id="closed-907"><h2>Issue #907 closed<span class="toot-id"> #closed-907</span></h2><div class="pubdate">09 Jan at 17:17:37 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/907">https://github.com/qt4cg/qtspecs/pull/907</a></div><p>906 fn:deep-equal: unordered → ordered</p></div>
<div class="toot" id="closed-898"><h2>Issue #898 closed<span class="toot-id"> #closed-898</span></h2><div class="pubdate">09 Jan at 17:14:02 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/898">https://github.com/qt4cg/qtspecs/issues/898</a></div><p>Drop the requirement for document-uri() uniqueness</p></div>
<div class="toot" id="closed-905"><h2>Issue #905 closed<span class="toot-id"> #closed-905</span></h2><div class="pubdate">09 Jan at 17:14:01 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/905">https://github.com/qt4cg/qtspecs/pull/905</a></div><p>898 - relax the constraints on document-uri</p></div>
<div class="toot" id="closed-821"><h2>Issue #821 closed<span class="toot-id"> #closed-821</span></h2><div class="pubdate">09 Jan at 17:11:13 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/821">https://github.com/qt4cg/qtspecs/issues/821</a></div><p>Annotations: Make default namespace explicit</p></div>
<div class="toot" id="closed-904"><h2>Issue #904 closed<span class="toot-id"> #closed-904</span></h2><div class="pubdate">09 Jan at 17:11:12 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/904">https://github.com/qt4cg/qtspecs/pull/904</a></div><p>821 Annotations: Make default namespace explicit</p></div>
<div class="toot" id="closed-895"><h2>Issue #895 closed<span class="toot-id"> #closed-895</span></h2><div class="pubdate">09 Jan at 17:07:46 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/895">https://github.com/qt4cg/qtspecs/issues/895</a></div><p>Parameters with default values: allow empty sequences</p></div>
<div class="toot" id="closed-901"><h2>Issue #901 closed<span class="toot-id"> #closed-901</span></h2><div class="pubdate">09 Jan at 17:07:45 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/901">https://github.com/qt4cg/qtspecs/pull/901</a></div><p>895 Parameters with default values: allow empty sequences</p></div>
<div class="toot" id="created-934"><h2>Issue #934 created<span class="toot-id"> #created-934</span></h2><div class="pubdate">08 Jan at 18:00:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/934">https://github.com/qt4cg/qtspecs/issues/934</a></div><details><summary>String comparison in deep-equal</summary><div class="markup"><p>The code showing how strings should be compared in deep-equal has gone awry, it doesn't match the prose. In equal-strings(), the lines</p>
<pre><code>let $n1 := if ($options?whitespace = "normalize"))
             then normalize-unicode(?, $options?normalization-form) 
             else identity#1
  let $n2 := if ($options?normalize-space)
             then normalize-space#1 
             else identity#1      
</code></pre>
<p>should read:</p>
<pre><code>let $n1 := if ($options?whitespace = 'normalize')
             then normalize-space#1 
             else identity#1    
let $n2 := if ($options?normalization-form))
             then normalize-unicode(?, $options?normalization-form) 
             else identity#1
  
</code></pre>
<p>Actually, the whole thing can now be expressed more concisely using fn:chain:</p>
<pre><code>declare function equal-strings(
  $string1   as xs:string,
  $string2   as xs:string, 
  $collation as xs:string,
  $options   as map(*)
) as xs:boolean {
  let $norm := fn:chain(?,
                        (normalize-unicode(?, $options?normalization-form)[$options?whitespace = "normalize"],
                         normalize-space#1[$options?normalize-space]))          
  return compare($norm($string1), $norm($string2), $collation) eq 0    
}
</code></pre>
</div></details></div>
<div class="toot" id="created-933"><h2>Pull request #933 created<span class="toot-id"> #created-933</span></h2><div class="pubdate">08 Jan at 12:49:52 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/933">https://github.com/qt4cg/qtspecs/pull/933</a></div><details><summary>930 drop obsolete note about comments and PIs</summary><div class="markup"><p>Fix #930</p>
<p>The note is obsolete because adjacent text nodes are now combined after stripping comments and PIs.</p>
</div></details></div>
<div class="toot" id="created-932"><h2>Pull request #932 created<span class="toot-id"> #created-932</span></h2><div class="pubdate">08 Jan at 12:42:19 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/932">https://github.com/qt4cg/qtspecs/pull/932</a></div><details><summary>931 Add rules for duration precision</summary><div class="markup"><p>Fix #931</p>
<p>Adds rules for the precision of durations and operations on durations, analogous to the existing rules for dates/times.</p>
</div></details></div>
<div class="toot" id="created-931"><h2>Issue #931 created<span class="toot-id"> #created-931</span></h2><div class="pubdate">07 Jan at 10:21:40 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/931">https://github.com/qt4cg/qtspecs/issues/931</a></div><details><summary>Precision of duration arithmetic</summary><div class="markup"><p>We specify that dates/times are manipulated at least to millisecond precision, but we have no similar statement for durations.</p>
<p>See https://stackoverflow.com/questions/77752844</p>
<p>michael.hor257k points out:</p>
<blockquote>
<p>The 2.0 specification states: "The result is obtained by casting $arg to an xs:dayTimeDuration ... and then computing the seconds component as described in 10.3.2.3 Canonical representation." And then: "The canonical representation of xs:dayTimeDuration restricts ... the value of the seconds component to xs:decimal valued from 0.0 to 59.999... ", with reference to XML Schema Part 2: Datatypes which mandates "a minimum fractional second precision of milliseconds or three decimal digits". None of this appears in the 3.0 spec, though the examples still show a decimal digit being extracted. –</p>
</blockquote>
</div></details></div>
<div class="toot" id="closed-929"><h2>Issue #929 closed<span class="toot-id"> #closed-929</span></h2><div class="pubdate">07 Jan at 10:19:16 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/929">https://github.com/qt4cg/qtspecs/issues/929</a></div><p>map:values() - Would it be better to return an array?</p></div>
<div class="toot" id="created-930"><h2>Issue #930 created<span class="toot-id"> #created-930</span></h2><div class="pubdate">06 Jan at 17:13:22 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/930">https://github.com/qt4cg/qtspecs/issues/930</a></div><details><summary>Obsolete comment under fn:deep-equal()</summary><div class="markup"><p>The notes for fn:deep-equal() include the paragraph:</p>
<blockquote>
<p>By default, the contents of comments and processing instructions are significant only if these nodes appear directly as items in the two sequences being compared. The content of a comment or processing instruction that appears as a descendant of an item in one of the sequences being compared does not affect the result. However, the presence of a comment or processing instruction, if it causes a text node to be split into two text nodes, may affect the result.</p>
</blockquote>
<p>This is no longer true: we fixed it so that adjacent text nodes are merged after stripping comments and PIs.</p>
</div></details></div>
<div class="toot" id="created-929"><h2>Issue #929 created<span class="toot-id"> #created-929</span></h2><div class="pubdate">06 Jan at 08:34:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/929">https://github.com/qt4cg/qtspecs/issues/929</a></div><details><summary>map:values() - Would it be better to return an array?</summary><div class="markup"><p>The new function <code>map:values()</code> returns the values present in a map, flattened into a sequence.</p>
<p>This loses information if the values are not all singletons.</p>
<p>Would it be better to return an array?</p>
<p>That is, to return <code>array:build(map:pairs($map), fn{?value}))</code></p>
</div></details></div>
<div class="toot" id="created-928"><h2>Pull request #928 created<span class="toot-id"> #created-928</span></h2><div class="pubdate">06 Jan at 02:47:50 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/928">https://github.com/qt4cg/qtspecs/pull/928</a></div><details><summary>Minor edits through ch. 15</summary><div class="markup"><p>Light edits here for consistency, clarity. I didn't touch the CSV prose much, knowing it is subject to major revisions.</p>
</div></details></div>
<div class="toot" id="created-927"><h2>Pull request #927 created<span class="toot-id"> #created-927</span></h2><div class="pubdate">04 Jan at 18:14:09 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/927">https://github.com/qt4cg/qtspecs/pull/927</a></div><details><summary>861 Rewrite spec of deep lookup operator</summary><div class="markup"><p>Fix #861</p>
<p>This is a complete rewrite of the spec for deep-lookup, hopefully clarifying some edge cases and fixing bugs, but not intended to introduce any major changes.</p>
</div></details></div>
<div class="toot" id="created-926"><h2>Pull request #926 created<span class="toot-id"> #created-926</span></h2><div class="pubdate">04 Jan at 12:55:03 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/926">https://github.com/qt4cg/qtspecs/pull/926</a></div><details><summary>860 Editorial rearrangement of spec for shallow lookup</summary><div class="markup"><p>Rearranges the spec for lookup expressions so that unary lookup is now defined in terms of postfix lookup, not the other way around; this simplifies the rules when the context value is not a singleton, or when the key specifier expression is context-dependent.</p>
<p>Fix #860</p>
</div></details></div>
<div class="toot" id="created-925"><h2>Pull request #925 created<span class="toot-id"> #created-925</span></h2><div class="pubdate">03 Jan at 23:39:31 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/925">https://github.com/qt4cg/qtspecs/pull/925</a></div><details><summary>780 Document incompatibility in format-number etc</summary><div class="markup"><p>Fix #780</p>
<p>Changes the XSLT and F+O specs to document a minor incompatibility arising from the change to functions such as <code>format-number()</code> to accept an argument of type <code>union(xs:string, xs:QName)</code> rather than <code>xs:string</code>.</p>
<p>In addition, in XSLT, all such functions now accept <code>union(xs:string, xs:QName)</code> rather than <code>union(xs:QName, xs:string)</code>. This is primarily to make them all consistent.</p>
</div></details></div>
<div class="toot" id="created-924"><h2>Pull request #924 created<span class="toot-id"> #created-924</span></h2><div class="pubdate">03 Jan at 19:59:15 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/924">https://github.com/qt4cg/qtspecs/pull/924</a></div><details><summary>648 Disallow user modifications to schema for FN namespace</summary><div class="markup"><p>Fix #648</p>
</div></details></div>
<div class="toot" id="closed-889"><h2>Issue #889 closed<span class="toot-id"> #closed-889</span></h2><div class="pubdate">03 Jan at 19:34:49 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/issues/889">https://github.com/qt4cg/qtspecs/issues/889</a></div><p>Rename "Named Function Reference"</p></div>
<div class="toot" id="created-923"><h2>Pull request #923 created<span class="toot-id"> #created-923</span></h2><div class="pubdate">02 Jan at 23:02:41 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/923">https://github.com/qt4cg/qtspecs/pull/923</a></div><details><summary>913-new-examples-for-local-name-etc</summary><div class="markup"><p>I have created new (executable) examples for functions name, local-name, namespace-uri, node-name, count, number.</p>
<p>There are of course many other functions that would benefit from the same treatment.</p>
<p>Fix #913</p>
</div></details></div>
<div class="toot" id="created-922"><h2>Pull request #922 created<span class="toot-id"> #created-922</span></h2><div class="pubdate">01 Jan at 21:23:47 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/922">https://github.com/qt4cg/qtspecs/pull/922</a></div><details><summary>915 function body terminology</summary><div class="markup"><p>Fix #915</p>
</div></details></div>
<div class="toot" id="created-921"><h2>Pull request #921 created<span class="toot-id"> #created-921</span></h2><div class="pubdate">01 Jan at 20:14:53 GMT</div><div class="link">Link: <a href="https://github.com/qt4cg/qtspecs/pull/921">https://github.com/qt4cg/qtspecs/pull/921</a></div><details><summary>920 Allow xsl:break and xsl:next-iteration within branch of xsl:switch</summary><div class="markup"><p>Allow xsl:break and xsl:next-iteration within branch of xsl:switch</p>
<p>Fix #920</p>
</div></details></div></div></article></main></body></html>