<item>
   <title>Issue #1246 created</title>
   <pubDate>2024-05-29T13:18:09Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1246</link>
   <guid>https://qt4cg.org/@qt4cg/2024/#created-1246</guid>
   <description>&lt;div&gt;&lt;p&gt;fn:json-to-xml: `number-parser` option&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;With #973, the &lt;code&gt;number-parser&lt;/code&gt; option was added to &lt;code&gt;fn:json-to-xml&lt;/code&gt;. It has been reported back to us that the current definition introduces a backward incompatibility:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;json-to-xml('1234567')
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;…now returns:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;&amp;lt;number xmlns="http://www.w3.org/2005/xpath-functions"&amp;gt;1.234567E6&amp;lt;/number&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Before, we got:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xquery"&gt;&amp;lt;number xmlns="http://www.w3.org/2005/xpath-functions"&amp;gt;1234567&amp;lt;/number&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I’m convinced that the &lt;code&gt;number-parser&lt;/code&gt; option is am important addition for &lt;code&gt;fn:json-to-xml&lt;/code&gt; – I’ve already seen its application in practice – but I think we’ll need to change the default, which currently &lt;code&gt;xs:double#1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;It seems sufficient to me to change &lt;code&gt;xs:double#1&lt;/code&gt; to &lt;code&gt;identity#1&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;As a side note, &lt;a href="https://www.w3.org/TR/xpath-functions-31/#json-to-xml-mapping"&gt;17.4.2 XML Representation of JSON&lt;/a&gt; still states that:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The &lt;a href="https://qt4cg.org/specifications/xpath-functions-40/Overview.html#func-json-to-xml"&gt;fn:json-to-xml&lt;/a&gt; function creates an element whose string value is lexically the same as the JSON representation of the number.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;…which means that the semantics of &lt;code&gt;number-parser&lt;/code&gt; have not been incorporated in this section yet (my fault).&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
