<item>
   <title>Issue #1381 created</title>
   <pubDate>2024-08-12T15:09:26Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1381</link>
   <guid>https://qt4cg.org/@qt4cg/2024/#created-1381</guid>
   <description>&lt;div&gt;&lt;p&gt;fn:parse-uri: Observations (cont.)&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;The rules for &lt;code&gt;fn:parse-uri&lt;/code&gt; say:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If the fragment is the empty string, it is discarded and the fragment is the empty sequence.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;However, the result of &lt;a href="https://github.com/qt4cg/qt4tests/blob/4659dfdcc92ac57c9a7f482a1ec9f3f509020f52/fn/parse-uri.xml#L746-L762"&gt;fn-parse-uri-043&lt;/a&gt; contains an empty fragment string:&lt;/p&gt;
&lt;pre&gt;&lt;code class="language-xml"&gt;&amp;lt;test-case name="fn-parse-uri-043"&amp;gt;
    &amp;lt;description&amp;gt;Parses a URI ending in "#"&amp;lt;/description&amp;gt;
    &amp;lt;created by="Michael Kay" on="2023-10-27"/&amp;gt;
    &amp;lt;test&amp;gt;fn:parse-uri("https://qt4cg.org/specifications/xpath-functions-40/Overview.html#")&amp;lt;/test&amp;gt;
    &amp;lt;result&amp;gt;
      &amp;lt;assert-deep-eq&amp;gt;map {
        "authority": "qt4cg.org",
        "fragment": "",
        "host": "qt4cg.org",
        "path": "/specifications/xpath-functions-40/Overview.html",
        "path-segments": ("", "specifications", "xpath-functions-40", "Overview.html"),
        "scheme": "https",
        "hierarchical": true(),
        "uri": "https://qt4cg.org/specifications/xpath-functions-40/Overview.html#"
        }&amp;lt;/assert-deep-eq&amp;gt;
    &amp;lt;/result&amp;gt;
  &amp;lt;/test-case&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I assume the tests should be updated?&lt;/p&gt;
&lt;p&gt;With regard to the spec, I would suggest adding the normalization rule to query parameters:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;If the &lt;em&gt;query&lt;/em&gt; is the empty string, it is discarded and the &lt;em&gt;query&lt;/em&gt; is the empty sequence.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
