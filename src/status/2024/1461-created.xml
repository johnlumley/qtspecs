<item>
   <title>Issue #1461 created</title>
   <pubDate>2024-09-24T16:34:30Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/issues/1461</link>
   <guid>https://qt4cg.org/@qt4cg/2024/#created-1461</guid>
   <description>&lt;div&gt;&lt;p&gt;### Errors in `misc/BuiltinKeywords`&lt;/p&gt;&lt;div class="markup"&gt;&lt;pre&gt;&lt;code&gt;          ### Errors in `misc/BuiltinKeywords`
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Test cases &lt;code&gt;Keywords-fn-parse-html-1&lt;/code&gt; and &lt;code&gt;Keywords-fn-build-uri-1&lt;/code&gt; contain invalid function signatures, caused I think by a bug in &lt;code&gt;generate-keyword-test-set.xsl&lt;/code&gt;. Both seem to omit the &lt;code&gt;SequenceType&lt;/code&gt; of one of the arguments:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; fn:parse-html(html := ?, options := ?) instance of 
    function((xs:string | xs:hexBinary | xs:base64Binary)?, ) as document-node(element(*:html))?
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;fn:build-uri(parts := ?, options := ?) instance of function(, map(*)?) as xs:string
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Examining &lt;code&gt;generate-keyword-test-set.xsl&lt;/code&gt; shows:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;xsl:for-each select="arg"&amp;gt;
      &amp;lt;xsl:if test="position() != 1"&amp;gt;, &amp;lt;/xsl:if&amp;gt;
      &amp;lt;xsl:text&amp;gt;{@type}&amp;lt;/xsl:text&amp;gt;
&amp;lt;/xsl:for-each&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;but for these two function definitions, type information is indirected via a &lt;code&gt;@type-ref&lt;/code&gt; attribute:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;fos:proto name="parse-html" return-type="document-node(element(*:html))?"&amp;gt;
        &amp;lt;fos:arg name="html" type="(xs:string | xs:hexBinary | xs:base64Binary)?"/&amp;gt;
        &amp;lt;fos:arg name="options" type-ref="parse-html-options"
                     default="{
                                 &amp;amp;quot;method&amp;amp;quot;: &amp;amp;quot;html&amp;amp;quot;,
                                 &amp;amp;quot;html-version&amp;amp;quot;: &amp;amp;quot;5&amp;amp;quot;
                              }"/&amp;gt;
 &amp;lt;/fos:proto&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;fos:proto name="build-uri" return-type="xs:string"&amp;gt;
            &amp;lt;fos:arg name="parts" type-ref="uri-structure-record"
               example='{
               "scheme": "https",
               "host": "qt4cg.org",
               "port": (),
               "path": "/specifications/index.html"
               }'/&amp;gt;
            &amp;lt;fos:arg name="options" type="map(*)?" default="{}"/&amp;gt;
&amp;lt;/fos:proto&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;Originally posted by @johnlumley in https://github.com/qt4cg/qtspecs/issues/1451#issuecomment-2358082401&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
