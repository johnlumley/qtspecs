<item>
   <title>Pull request #1331 created</title>
   <pubDate>2024-07-19T15:42:18Z</pubDate>
   <link>https://github.com/qt4cg/qtspecs/pull/1331</link>
   <guid>https://qt4cg.org/@qt4cg/2024/#created-1331</guid>
   <description>&lt;div&gt;&lt;p&gt;1324 Introduce markup for executable specs&lt;/p&gt;&lt;div class="markup"&gt;&lt;p&gt;This PR does the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Makes schema changes for the function catalog to allow an executable specification of a function to be marked up as such.&lt;/li&gt;
&lt;li&gt;Uses this markup initially for functions in the array namespace.&lt;/li&gt;
&lt;li&gt;Makes stylesheet changes to render this markup in the published spec.&lt;/li&gt;
&lt;li&gt;Commits an XSLT stylesheet (not yet integrated into the build system) that runs against the function catalog to produce an XQuery module whose effect is to declare functions based on the "executable specifications" and run the published executable examples against these functions, checking that they produce the expected result. The "success" output of this query (which runs with no source document) is an XML document containing an empty element &lt;code&gt;&amp;lt;result/&amp;gt;&lt;/code&gt;. (If it has content, this will relate to tests that failed).&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;To get this to work, I had to tweak a couple of functions (array:sort and array:get) where Saxon has not yet implemented the required functionality. Although the test query is using the implementations from the spec, not those from Saxon, these implementations make calls on other functions where the Saxon implementation is used. For example array:fold-left calls fn:fold-left and this currently uses the Saxon implementation of fn:fold-left.&lt;/p&gt;
&lt;p&gt;The query binds a dummy namespace to the &lt;code&gt;array&lt;/code&gt; prefix to avoid problems with reserved namespaces. There are a couple of "core" functions that have no executable specification -- notably array:of-members() -- and the generated query contains an implementation of these that maps the function in the dummy array namespace to the function in the true array namespace.&lt;/p&gt;
&lt;p&gt;This is phase 1. Most of the machinery is in place. It now needs to be applied to executable specifications of functions in other namespaces.&lt;/p&gt;
&lt;p&gt;The stylesheet has no Saxon dependencies, but it does include a couple of template rules to exclude specific functions/tests that Saxon does not currently implement. The stylesheet could be made portable across implementations by moving these exception cases to an overriding stylesheet module.&lt;/p&gt;
&lt;p&gt;I did find a few examples of supposedly executable code that needed fixing; hopefully these will show up in the diff version.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description>
</item>
